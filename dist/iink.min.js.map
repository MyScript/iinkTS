{"version":3,"file":"iink.min.js","sources":["../node_modules/tslib/tslib.es6.js","../src/grabber/PointerEventGrabber.ts","../src/renderer/canvas/symbols/ShapeSymbolCanvasRenderer.ts","../src/renderer/canvas/symbols/TextSymbolCanvasRenderer.ts","../src/renderer/canvas/CanvasRenderer.ts","../src/renderer/canvas/symbols/StrokeSymbolCanvasRenderer.ts","../src/renderer/QuadraticUtils.ts","../src/renderer/canvas/stroker/QuadraticCanvasStroker.ts","../src/behaviors/RestBehaviors.ts","../src/behaviors/BehaviorsManager.ts","../src/configuration/DefaultConfiguration.ts","../src/configuration/Configuration.ts","../node_modules/style-inject/dist/style-inject.es.js","../src/model/Stroke.ts","../src/model/Model.ts","../src/style/DefaultPenStyle.ts","../src/style/DefaultTheme.ts","../src/style/StyleManager.ts","../src/Editor.ts","../src/helpers.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","import { IGrabber } from '../@types/grabber/Grabber'\nimport { TGrabberConfiguration } from '../@types/configuration/GrabberConfiguration'\nimport { TPoint } from '../@types/renderer/Point'\n\nexport class PointerEventGrabber implements IGrabber\n{\n  private configuration!: TGrabberConfiguration\n\n  private domElement!: HTMLElement\n\n  private activePointerId?: number\n\n  private prevent = (e: Event) => e.preventDefault()\n\n  onPointerDown!: (evt: PointerEvent, point: TPoint) => void\n  onPointerMove!: (evt: PointerEvent, point: TPoint) => void\n  onPointerUp!: (evt: PointerEvent, point: TPoint) => void\n\n  constructor(configuration: TGrabberConfiguration)\n  {\n    this.setConfiguration(configuration)\n  }\n\n  private roundFloat(oneFloat: number, requestedFloatPrecision: number): number\n  {\n    if (requestedFloatPrecision >= 0) {\n      const floatPrecision: number = Math.pow(10, requestedFloatPrecision)\n      return Math.round(oneFloat / floatPrecision) * floatPrecision\n    }\n    return oneFloat\n  }\n\n  private extractPoint(event: MouseEvent | TouchEvent): TPoint\n  {\n    let clientX: number, clientY: number\n    if ('changedTouches' in event) {\n      ({ clientX, clientY } = event.changedTouches[0])\n    } else {\n      ({ clientX, clientY } = event)\n    }\n    const rect: DOMRect = this.domElement.getBoundingClientRect()\n    return {\n      x: this.roundFloat(clientX - rect.left - this.domElement.clientLeft, this.configuration.xyFloatPrecision),\n      y: this.roundFloat(clientY - rect.top - this.domElement.clientTop, this.configuration.xyFloatPrecision),\n      t: this.roundFloat(Date.now(), this.configuration.timestampFloatPrecision),\n      p: (event as PointerEvent).pressure,\n\n    }\n  }\n\n  private pointerDownHandler = (evt: PointerEvent) =>\n  {\n    // exit if not a left click or multi-touch\n    if (evt.button !== 0 || evt.buttons !== 1) {\n      return\n    }\n\n    this.activePointerId = evt.pointerId\n\n    if (this.onPointerDown) {\n      const point = this.extractPoint(evt)\n      this.onPointerDown(evt, point)\n    }\n  }\n\n  private pointerMoveHandler = (evt: PointerEvent) =>\n  {\n    if (this.activePointerId != undefined && this.activePointerId === evt.pointerId) {\n      if (this.onPointerMove) {\n        const point = this.extractPoint(evt)\n        this.onPointerMove(evt, point)\n      }\n    }\n  }\n\n  private pointerUpHandler = (evt: PointerEvent) =>\n  {\n    if (this.activePointerId != undefined && this.activePointerId === evt.pointerId) {\n      this.activePointerId = undefined\n      evt.stopPropagation()\n      if (this.onPointerUp) {\n        const point = this.extractPoint(evt)\n        this.onPointerUp(evt, point)\n      }\n    }\n  }\n\n  setConfiguration(configuration: TGrabberConfiguration)\n  {\n    this.configuration = configuration\n  }\n\n  attach(domElement: HTMLElement)\n  {\n    if (this.domElement) {\n      this.detach()\n    }\n    this.domElement = domElement\n    this.domElement.addEventListener('pointerdown', this.pointerDownHandler, this.configuration.listenerOptions)\n\n    this.domElement.addEventListener('pointermove', this.pointerMoveHandler, this.configuration.listenerOptions)\n\n    this.domElement.addEventListener('pointerup', this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement.addEventListener('pointerout', this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement.addEventListener('pointerleave', this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement.addEventListener('pointercancel', this.pointerUpHandler, this.configuration.listenerOptions)\n\n    this.domElement.addEventListener('touchmove', this.prevent)\n\n    // FIXME investigate why this is needed for iOS devices\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    document.documentElement.addEventListener('pointerdown', () => { })\n  }\n\n  detach()\n  {\n    this.domElement.removeEventListener('pointerdown', this.pointerDownHandler, this.configuration.listenerOptions)\n\n    this.domElement.removeEventListener('pointermove', this.pointerMoveHandler, this.configuration.listenerOptions)\n\n    this.domElement.removeEventListener('pointerup', this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement.removeEventListener('pointerout', this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement.removeEventListener('pointerleave', this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement.removeEventListener('pointercancel', this.pointerUpHandler, this.configuration.listenerOptions)\n\n    this.domElement.removeEventListener('touchmove', this.prevent)\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    document.documentElement.removeEventListener('pointerdown', () => { })\n  }\n}","\nimport { TPartialXYPoint } from \"../../../@types/renderer/Point\"\nimport { TSymbol, TShapeEllipseSymbol, TShapeLineSymbol, TShapeSymbol, TShapeTableSymbol, TLineSymbol, TShapeRecognizedSymbol } from \"../../../@types/renderer/Symbol\"\n\nexport const ShapeSymbols = {\n  table: 'table',\n  shape: 'shape',\n  recognizedShape: 'recognizedShape',\n  ellipse: 'ellipse',\n  line: 'line'\n}\n\nfunction phi(angle: number): number\n{\n  let returnedAngle = ((angle + Math.PI) % (Math.PI * 2)) - Math.PI\n  if (returnedAngle < -Math.PI) {\n    returnedAngle += Math.PI * 2\n  }\n  return returnedAngle\n}\n\nfunction drawEllipseArc(context2D: CanvasRenderingContext2D, shapeEllipse: TShapeEllipseSymbol): TPartialXYPoint[]\n{\n  const { centerPoint, maxRadius, minRadius, orientation, startAngle, sweepAngle } = shapeEllipse\n  const angleStep = 0.02 // angle delta between interpolated\n\n  let z1 = Math.cos(orientation)\n  let z3 = Math.sin(orientation)\n  let z2 = z1\n  let z4 = z3\n  z1 *= maxRadius\n  z2 *= minRadius\n  z3 *= maxRadius\n  z4 *= minRadius\n\n  const n = Math.floor(Math.abs(sweepAngle) / angleStep)\n\n  const boundariesPoints = []\n\n  context2D.save()\n  try {\n    context2D.beginPath()\n\n    for (let i = 0; i <= n; i++) {\n      const angle = startAngle + ((i / n) * sweepAngle) // points on the arc, in radian\n      const alpha = Math.atan2(Math.sin(angle) / minRadius, Math.cos(angle) / maxRadius)\n\n      const cosAlpha = Math.cos(alpha)\n      const sinAlpha = Math.sin(alpha)\n\n      // current point\n      const x = (centerPoint.x + (z1 * cosAlpha)) - (z4 * sinAlpha)\n      const y = (centerPoint.y + (z2 * sinAlpha)) + (z3 * cosAlpha)\n      if (i === 0) {\n        context2D.moveTo(x, y)\n      } else {\n        context2D.lineTo(x, y)\n      }\n\n      if (i === 0 || i === n) {\n        boundariesPoints.push({ x, y })\n      }\n    }\n\n    context2D.stroke()\n  } finally {\n    context2D.restore()\n  }\n\n  return boundariesPoints\n}\n\nfunction drawArrowHead(context2D: CanvasRenderingContext2D, headPoint: TPartialXYPoint, angle: number, length: number)\n{\n  const alpha = phi(angle + (Math.PI * (7 / 8)))\n  const beta = phi(angle - (Math.PI * (7 / 8)))\n  context2D.save()\n  try {\n    context2D.fillStyle = context2D.strokeStyle\n\n    context2D.moveTo(headPoint.x, headPoint.y)\n    context2D.beginPath()\n    context2D.lineTo(headPoint.x + (length * Math.cos(alpha)), headPoint.y + (length * Math.sin(alpha)))\n    context2D.lineTo(headPoint.x + (length * Math.cos(beta)), headPoint.y + (length * Math.sin(beta)))\n    context2D.lineTo(headPoint.x, headPoint.y)\n    context2D.fill()\n  } finally {\n    context2D.restore()\n  }\n}\n\nfunction drawShapeEllipse(context2D: CanvasRenderingContext2D, shapeEllipse: TShapeEllipseSymbol)\n{\n  const points = drawEllipseArc(context2D, shapeEllipse)\n\n  if (shapeEllipse?.beginDecoration === 'ARROW_HEAD') {\n    drawArrowHead(context2D, points[0], shapeEllipse.beginTangentAngle, 12.0)\n  }\n  if (shapeEllipse?.endDecoration === 'ARROW_HEAD') {\n    drawArrowHead(context2D, points[1], shapeEllipse.endTangentAngle, 12.0)\n  }\n}\n\n/**\n * Draw a line\n * @param {Object} context2D Current rendering context2D\n * @param {{x: Number, y: Number}} p1 Origin point\n * @param {{x: Number, y: Number}} p2 Destination point\n */\nexport function drawLine(context2D: CanvasRenderingContext2D, p1: TPartialXYPoint, p2: TPartialXYPoint)\n{\n  context2D.save()\n  try {\n    context2D.beginPath()\n    context2D.moveTo(p1.x, p1.y)\n    context2D.lineTo(p2.x, p2.y)\n    context2D.stroke()\n  } finally {\n    context2D.restore()\n  }\n}\n\nfunction drawShapeLine(context2D: CanvasRenderingContext2D, shapeLine: TShapeLineSymbol)\n{\n  drawLine(context2D, shapeLine.firstPoint, shapeLine.lastPoint)\n  if (shapeLine.beginDecoration === 'ARROW_HEAD') {\n    drawArrowHead(context2D, shapeLine.firstPoint, shapeLine.beginTangentAngle, 12.0)\n  }\n  if (shapeLine.endDecoration === 'ARROW_HEAD') {\n    drawArrowHead(context2D, shapeLine.lastPoint, shapeLine.endTangentAngle, 12.0)\n  }\n}\n\n/**\n * Draw a shape symbol\n * @param {Object} context2D Current rendering context2D\n * @param {Object} symbol Symbol to draw\n */\nexport function drawShapeSymbol(context2D: CanvasRenderingContext2D, symbol: TSymbol)\n{\n  context2D.save()\n  try {\n    context2D.lineWidth = symbol.width\n    context2D.strokeStyle = symbol.color\n\n    if (symbol.elementType) {\n      switch (symbol.elementType) {\n        case ShapeSymbols.shape:\n          // eslint-disable-next-line no-case-declarations\n          const shapeSymbol = symbol as TShapeSymbol\n          drawShapeSymbol(context2D, shapeSymbol.candidates[shapeSymbol.selectedCandidateIndex])\n          break\n        case ShapeSymbols.table:\n          // eslint-disable-next-line no-case-declarations\n          const tableSymbols = symbol as TShapeTableSymbol\n          tableSymbols.lines.forEach(line => drawShapeSymbol(context2D, line))\n          break\n        case ShapeSymbols.line:\n          // eslint-disable-next-line no-case-declarations\n          const lineSymbol = symbol as TLineSymbol\n          drawLine(context2D, lineSymbol.data.p1, lineSymbol.data.p2)\n          break\n        default:\n          // logger.error(`${ symbol.elementType } not implemented`)\n          break\n      }\n    } else {\n      switch (symbol.type) {\n        case ShapeSymbols.ellipse:\n          drawShapeEllipse(context2D, symbol as TShapeEllipseSymbol)\n          break\n        case ShapeSymbols.line:\n          drawShapeLine(context2D, symbol as TShapeLineSymbol)\n          break\n        case ShapeSymbols.recognizedShape:\n          // eslint-disable-next-line no-case-declarations\n          const recognizedSymbols = symbol as TShapeRecognizedSymbol\n          recognizedSymbols.primitives.forEach(primitive => drawShapeSymbol(context2D, primitive))\n          break\n        default:\n          // logger.error(`${ symbol.type } not implemented`)\n          break\n      }\n    }\n  } finally {\n    context2D.restore()\n  }\n}\n","import { TPartialXYPoint } from '../../../@types/renderer/Point'\nimport { drawLine } from './ShapeSymbolCanvasRenderer'\nimport { TSymbol, TTextUnderlineDataSymbol, TTextUnderlineSymbol, TUnderLineSymbol } from '../../../@types/renderer/Symbol'\n\nexport const TextSymbols = {\n  inputCharacter: 'inputCharacter',\n  char: 'char',\n  string: 'string',\n  textLine: 'textLine'\n}\n\nfunction drawUnderline(context2D: CanvasRenderingContext2D, underline: TUnderLineSymbol, label: string, data: TTextUnderlineDataSymbol)\n{\n  const delta = data.width / label.length\n  const p1: TPartialXYPoint = {\n    x: data.topLeftPoint.x + (underline.data.firstCharacter * delta),\n    y: data.topLeftPoint.y + data.height\n  }\n  const p2: TPartialXYPoint = {\n    x: data.topLeftPoint.x + (underline.data.lastCharacter * delta),\n    y: data.topLeftPoint.y + data.height\n  }\n  drawLine(context2D, p1, p2)\n}\n\nfunction drawText(context2D: CanvasRenderingContext2D, label: string, data: TTextUnderlineDataSymbol)\n{\n  context2D.save()\n  try {\n    context2D.font = `${ data.textHeight }px serif`\n    context2D.textAlign = (data.justificationType === 'CENTER') ? 'center' : 'left'\n    context2D.textBaseline = 'bottom'\n    context2D.fillStyle = context2D.strokeStyle\n    context2D.fillText(label, data.topLeftPoint.x, (data.topLeftPoint.y + data.height))\n  } finally {\n    context2D.restore()\n  }\n}\n\nfunction drawTextLine(context2D: CanvasRenderingContext2D, textLine: TTextUnderlineSymbol)\n{\n  drawText(context2D, textLine.label, textLine.data)\n  textLine.underlineList.forEach((underline) =>\n  {\n    drawUnderline(context2D, underline, textLine.label, textLine.data)\n  })\n}\n\n/**\n * Draw a text symbol\n * @param {Object} context Current rendering context\n * @param {Object} symbol Symbol to draw\n */\nexport function drawTextSymbol(context2D: CanvasRenderingContext2D, symbol: TSymbol)\n{\n  context2D.save()\n  try {\n    context2D.lineWidth = symbol.width\n    context2D.strokeStyle = symbol.color\n    const type: string = symbol.elementType || symbol.type\n\n    switch (type) {\n      case TextSymbols.textLine:\n        drawTextLine(context2D, symbol as TTextUnderlineSymbol)\n        break\n      default:\n        // logger.error(`${symbol.elementType} not implemented`)\n        break\n    }\n\n  } finally {\n    context2D.restore()\n  }\n}\n","import { TStroke, IStroker } from \"../../@types/stroker/Stroker\"\nimport { TRenderingConfiguration } from \"../../@types/configuration/RenderingConfiguration\"\nimport { IModel } from \"../../@types/model/Model\"\nimport { IRenderer, TRendererContext } from \"../../@types/renderer/Renderer\"\nimport { TSymbol } from \"../../@types/renderer/Symbol\"\n\nimport { drawShapeSymbol, ShapeSymbols } from \"./symbols/ShapeSymbolCanvasRenderer\"\nimport { drawStroke } from \"./symbols/StrokeSymbolCanvasRenderer\"\nimport { drawTextSymbol, TextSymbols } from \"./symbols/TextSymbolCanvasRenderer\"\n\nexport class CanvasRenderer implements IRenderer\n{\n  config: TRenderingConfiguration\n  context!: TRendererContext\n\n  constructor(config: TRenderingConfiguration) {\n    this.config = config\n  }\n\n  private createCanvas(element: HTMLElement, type: string): HTMLCanvasElement\n  {\n    const canvas: HTMLCanvasElement = document.createElement('canvas')\n    canvas.classList.add(type)\n    canvas.classList.add('ms-canvas')\n    element.appendChild(canvas)\n    return canvas\n  }\n\n  private resizeContent(): void\n  {\n    const elements: HTMLCanvasElement[] = [this.context.renderingCanvas, this.context.capturingCanvas]\n    elements.forEach((canvas) =>\n    {\n      const domElement = canvas.parentNode as HTMLElement\n      const width = Math.max(this.context?.minWidth, domElement.clientWidth)\n      const height = Math.max(this.context?.minHeight, domElement.clientHeight)\n      canvas.width = width * window.devicePixelRatio\n      canvas.height = height * window.devicePixelRatio\n      canvas.style.width = `${ width }px`\n      canvas.style.height = `${ height }px`\n      canvas.getContext('2d')?.scale(1, 1)\n    })\n  }\n\n  private drawSymbol(context2D: CanvasRenderingContext2D, symbol: TSymbol, stroker: IStroker)\n  {\n    const type = symbol.elementType || symbol.type\n    if (type === 'stroke') {\n      drawStroke(context2D, symbol as TStroke, stroker)\n    } else if (Object.keys(TextSymbols).includes(type)) {\n      drawTextSymbol(context2D, symbol)\n    } else if (Object.keys(ShapeSymbols).includes(type)) {\n      drawShapeSymbol(context2D, symbol)\n    }\n  }\n\n  init(element: HTMLElement): void\n  {\n    const renderingCanvas: HTMLCanvasElement = this.createCanvas(element, 'ms-rendering-canvas')\n    const capturingCanvas: HTMLCanvasElement = this.createCanvas(element, 'ms-capture-canvas')\n\n    this.context = {\n      minHeight: this.config.minHeight || 0,\n      minWidth: this.config.minWidth || 0,\n      renderingCanvas,\n      renderingCanvasContext: renderingCanvas.getContext('2d') as CanvasRenderingContext2D,\n      capturingCanvas,\n      capturingCanvasContext: capturingCanvas.getContext('2d') as CanvasRenderingContext2D\n    }\n\n    this.resizeContent()\n  }\n\n  drawModel(model: IModel, stroker: IStroker): void\n  {\n    this.context.renderingCanvasContext?.clearRect(0, 0, this.context.renderingCanvas.width, this.context.renderingCanvas.height)\n    const symbols = [...model.defaultSymbols]\n    if (model.recognizedSymbols) {\n      symbols.push(...model.recognizedSymbols)\n      symbols.push(...model.extractPendingStrokes())\n    } else {\n      symbols.push(...model.rawStrokes)\n    }\n    symbols.forEach(symbol => this.drawSymbol(this.context.renderingCanvasContext, symbol, stroker))\n    this.context.capturingCanvasContext.clearRect(0, 0, this.context.capturingCanvas.width, this.context.capturingCanvas.height)\n  }\n\n  drawCurrentStroke(model: IModel, stroker: IStroker): void\n  {\n    // Render the current stroke\n    const stroke: TStroke | undefined = model.currentStroke\n    this.context.capturingCanvasContext.clearRect(0, 0, this.context.capturingCanvas.width, this.context.capturingCanvas.height)\n    if (stroker && stroke && stroke?.pointerType !== 'eraser') {\n      stroker.drawStroke(this.context.capturingCanvasContext, stroke)\n    }\n  }\n\n  resize(model: IModel, stroker: IStroker): void\n  {\n    this.resizeContent()\n    this.drawModel(model, stroker)\n  }\n\n  destroy(element: HTMLElement)\n  {\n    element.removeChild(this.context.renderingCanvas)\n    element.removeChild(this.context.capturingCanvas)\n    // this.context = undefined\n  }\n}","import { TStroke, IStroker } from \"../../../@types/stroker/Stroker\"\n\nexport function drawStroke (context2D: CanvasRenderingContext2D, stroke: TStroke, stroker: IStroker) {\n  if (stroker && stroke && stroke.pointerType !== 'eraser') {\n    stroker.drawStroke(context2D, stroke)\n  }\n}","import { TPartialXYPoint, TPoint } from \"../@types/renderer/Point\"\n\nexport function computeLinksPoints(point: TPoint, angle: number, width: number): TPartialXYPoint[]\n{\n  const radius = point.p * width\n  return [\n    {\n      x: (point.x - (Math.sin(angle) * radius)),\n      y: (point.y + (Math.cos(angle) * radius))\n    },\n    {\n      x: (point.x + (Math.sin(angle) * radius)),\n      y: (point.y - (Math.cos(angle) * radius))\n    }\n  ]\n}\n\nexport function computeMiddlePoint(point1: TPoint, point2: TPoint): TPoint\n{\n  return {\n    x: ((point2.x + point1.x) / 2),\n    y: ((point2.y + point1.y) / 2),\n    p: ((point2.p + point1.p) / 2),\n    t: ((point2.t + point1.t) / 2)\n  }\n}\n\nexport function computeAxeAngle(begin: TPoint, end: TPoint): number\n{\n  return Math.atan2(end.y - begin.y, end.x - begin.x)\n}\n","import { TPoint } from \"../../../@types/renderer/Point\"\nimport { TStroke, IStroker } from \"../../../@types/stroker/Stroker\"\nimport { computeAxeAngle, computeLinksPoints, computeMiddlePoint } from \"../../QuadraticUtils\"\n\nexport class QuadraticCanvasStroker implements IStroker\n{\n\n  private renderArc(context2d: CanvasRenderingContext2D, center: TPoint, radius: number)\n  {\n    context2d.arc(center.x, center.y, radius, 0, Math.PI * 2, true)\n  }\n\n  private renderLine(context2d: CanvasRenderingContext2D, begin: TPoint, end: TPoint, width: number)\n  {\n    const linkPoints1 = computeLinksPoints(begin, computeAxeAngle(begin, end), width)\n    const linkPoints2 = computeLinksPoints(end, computeAxeAngle(begin, end), width)\n\n    context2d.moveTo(linkPoints1[0].x, linkPoints1[0].y)\n    context2d.lineTo(linkPoints2[0].x, linkPoints2[0].y)\n    context2d.lineTo(linkPoints2[1].x, linkPoints2[1].y)\n    context2d.lineTo(linkPoints1[1].x, linkPoints1[1].y)\n  }\n\n  private renderFinal(context2d: CanvasRenderingContext2D, begin: TPoint, end: TPoint, width: number)\n  {\n    const ARCSPLIT = 6\n    const angle = computeAxeAngle(begin, end)\n    const linkPoints = computeLinksPoints(end, angle, width)\n    context2d.moveTo(linkPoints[0].x, linkPoints[0].y)\n    for (let i = 1; i <= ARCSPLIT; i++) {\n      const newAngle = angle - ((i * Math.PI) / ARCSPLIT)\n      context2d.lineTo(end.x - ((end.p * width) * Math.sin(newAngle)), end.y + (end.p * width * Math.cos(newAngle)))\n    }\n  }\n\n  private renderQuadratic(context2d: CanvasRenderingContext2D, begin: TPoint, end: TPoint, ctrl: TPoint, width: number)\n  {\n    const linkPoints1 = computeLinksPoints(begin, computeAxeAngle(begin, ctrl), width)\n    const linkPoints2 = computeLinksPoints(end, computeAxeAngle(ctrl, end), width)\n    const linkPoints3 = computeLinksPoints(ctrl, computeAxeAngle(begin, end), width)\n\n    context2d.moveTo(linkPoints1[0].x, linkPoints1[0].y)\n    context2d.quadraticCurveTo(linkPoints3[0].x, linkPoints3[0].y, linkPoints2[0].x, linkPoints2[0].y)\n    context2d.lineTo(linkPoints2[1].x, linkPoints2[1].y)\n    context2d.quadraticCurveTo(linkPoints3[1].x, linkPoints3[1].y, linkPoints1[1].x, linkPoints1[1].y)\n  }\n\n  private getPointByIndex(stroke: TStroke, index: number): TPoint {\n    const point: TPoint = {\n      x: stroke.x[index] || 0,\n      y: stroke.y[index] || 0,\n      t: stroke.t[index] || 0,\n      p: stroke.p[index] || 0,\n    }\n    return point\n  }\n\n  drawStroke(context2d: CanvasRenderingContext2D, stroke: TStroke)\n  {\n    const length = stroke.x.length\n    const width = stroke.width > 0 ? stroke.width : context2d.lineWidth\n    const color = stroke.color ? stroke.color : context2d.strokeStyle\n    const firstPoint = this.getPointByIndex(stroke, 0) as TPoint\n    const nbquadratics = length - 2\n\n    context2d.save()\n    try {\n      context2d.beginPath()\n      if (length < 3) {\n        this.renderArc(context2d, firstPoint, width * 0.6)\n      } else {\n        this.renderArc(context2d, firstPoint, width * firstPoint.p)\n        const secondPoint: TPoint = computeMiddlePoint(firstPoint, this.getPointByIndex(stroke, 1))\n        this.renderLine(context2d, firstPoint, secondPoint, width)\n\n        // Possibility to try this (the start looks better when the ink is large)\n        // var first = computeMiddlePoint(stroke[0], stroke[1]);\n        // context2d.arc(first.x, first.y, width * first.p, 0, Math.PI * 2, true);\n\n        for (let i = 0; i < nbquadratics; i++) {\n          const begin: TPoint = computeMiddlePoint(this.getPointByIndex(stroke, i), this.getPointByIndex(stroke, i + 1))\n          const end: TPoint = computeMiddlePoint(this.getPointByIndex(stroke, i + 1), this.getPointByIndex(stroke, i + 2))\n          const ctrl: TPoint = this.getPointByIndex(stroke, i + 1)\n          this.renderQuadratic(context2d, begin, end, ctrl, width)\n        }\n        const beginLine: TPoint = computeMiddlePoint(this.getPointByIndex(stroke, length - 2), this.getPointByIndex(stroke, length - 1))\n        const endLine: TPoint = this.getPointByIndex(stroke, length - 1)\n        this.renderLine(context2d, beginLine, endLine, width)\n\n        const beginFinal: TPoint = this.getPointByIndex(stroke, length - 2)\n        const endFinal: TPoint = this.getPointByIndex(stroke, length - 1)\n        this.renderFinal(context2d, beginFinal, endFinal, width)\n      }\n      context2d.closePath()\n      if (color !== undefined) {\n        context2d.fillStyle = color\n        context2d.fill()\n      }\n      context2d.save()\n    }\n    finally {\n      context2d.restore()\n    }\n  }\n}","import { IBehaviors } from \"../@types/Behaviors\"\nimport { IGrabber } from \"../@types/grabber/Grabber\"\nimport { IStroker } from \"../@types/stroker/Stroker\"\nimport { TConfiguration } from \"../@types/Configuration\"\nimport { IRenderer } from \"../@types/renderer/Renderer\"\n\nimport { PointerEventGrabber } from '../grabber/PointerEventGrabber'\nimport { CanvasRenderer } from \"../renderer/canvas/CanvasRenderer\"\nimport { QuadraticCanvasStroker } from \"../renderer/canvas/stroker/QuadraticCanvasStroker\"\n\nexport class RestBehaviors implements IBehaviors\n{\n  eventHelper!: any\n  grabber: IGrabber\n  stroker: IStroker\n  renderer: IRenderer\n  recognizer!: any\n\n  constructor(configuration: TConfiguration)\n  {\n    this.grabber = new PointerEventGrabber(configuration.grabber)\n    this.stroker = new QuadraticCanvasStroker()\n    this.renderer = new CanvasRenderer(configuration.rendering)\n  }\n\n  init(domElement: HTMLElement): Promise<boolean | Error>\n  {\n    this.grabber.attach(domElement)\n    this.renderer.init(domElement)\n    return Promise.resolve(true)\n  }\n\n}\n","import { IBehaviors } from \"../@types/Behaviors\"\nimport { TConfiguration } from \"../@types/Configuration\"\nimport { RestBehaviors } from \"./RestBehaviors\"\n\nexport class BehaviorsManager\n{\n  behaviors!: IBehaviors\n\n  constructor(configuration: TConfiguration, behaviors?: IBehaviors)\n  {\n    this.overrideDefaultBehaviors(configuration, behaviors)\n  }\n\n  overrideDefaultBehaviors(configuration: TConfiguration, behaviors?: IBehaviors)\n  {\n    const defaultBehaviors: IBehaviors = new RestBehaviors(configuration)\n    // if (configuration.server.protocol === 'REST') {\n    //   defaultBehaviors = new RestBehaviors(configuration)\n    // } else {\n    //   defaultBehaviors = new WSBehaviors(configuration)\n    // }\n\n    this.behaviors = Object.assign(defaultBehaviors, behaviors)\n  }\n\n  init(domElement: HTMLElement): Promise<boolean | Error>\n  {\n    return this.behaviors.init(domElement)\n  }\n\n}","import { TConfiguration } from '../@types/Configuration'\nimport { TGrabberConfiguration } from \"../@types/configuration/GrabberConfiguration\"\nimport { TRenderingConfiguration } from '../@types/configuration/RenderingConfiguration'\nimport { TServerConfiguration } from '../@types/configuration/ServerConfiguration'\nimport { TRecognitionConfiguration } from '../@types/configuration/RecognitionConfiguration'\nimport { TTriggerConfiguration } from '../@types/configuration/TriggerConfiguration'\nimport { TEventConfiguration } from '../@types/configuration/EventConfiguration'\n\nconst DefaultServerConfiguration: TServerConfiguration = {\n  protocol: 'WEBSOCKET',\n  scheme: 'https',\n  host: 'cloud.myscript.com',\n  applicationKey: '',\n  hmacKey: '',\n  useWindowLocation: false,\n  websocket: {\n    pingEnabled: true,\n    pingDelay: 30000,\n    maxPingLostCount: 10,\n    autoReconnect: true,\n    maxRetryCount: 2,\n    fileChunkSize: 300000\n  }\n}\n\nconst DefaultRecognitionConfiguration: TRecognitionConfiguration = {\n  type: 'TEXT',\n  alwaysConnected: true,\n  replaceMimeTypes: false,\n  lang: 'en_US',\n  gesture: {\n    enable: true\n  },\n  export: {\n    'image-resolution': 300,\n    jiix: {\n      'bounding-box': false,\n      strokes: false,\n      text: {\n        chars: false,\n        words: true\n      }\n    },\n  },\n  renderer: {\n    debug: {\n      'draw-text-boxes': false,\n      'draw-image-boxes': false\n    }\n  },\n  math: {\n    mimeTypes: ['application/x-latex'], // 'application/mathml+xml', 'application/vnd.myscript.jiix',\n    solver: {\n      enable: true,\n      'fractional-part-digits': 3,\n      'decimal-separator': '.',\n      'rounding-mode': 'half up',\n      'angle-unit': 'deg'\n    },\n    margin: {\n      bottom: 10,\n      left: 15,\n      right: 15,\n      top: 10\n    },\n    eraser: {\n      'erase-precisely': false\n    },\n    'undo-redo': {\n      mode: 'stroke'\n    }\n  },\n  text: {\n    guides: {\n      enable: true\n    },\n    mimeTypes: ['text/plain'], // 'application/vnd.myscript.jiix'\n    margin: {\n      top: 20,\n      left: 10,\n      right: 10,\n      bottom: 10\n    },\n    eraser: {\n      'erase-precisely': false\n    }\n  },\n  diagram: {\n    mimeTypes: ['application/vnd.myscript.jiix'], // 'application/vnd.openxmlformats-officedocument.presentationml.presentation'\n    eraser: {\n      'erase-precisely': false\n    }\n  },\n  rawContent: {\n    mimeTypes: ['application/vnd.myscript.jiix'],\n    recognition: {\n      text: true,\n      shape: false\n    },\n    eraser: {\n      'erase-precisely': false\n    }\n  }\n}\n\nconst DefaultGrabberConfiguration: TGrabberConfiguration = {\n  listenerOptions: {\n    capture: false,\n    passive: true\n  },\n  xyFloatPrecision: 0,\n  timestampFloatPrecision: 0\n}\n\nconst DefaultRenderingConfiguration: TRenderingConfiguration = {\n  minHeight: 100,\n  minWidth: 100,\n  smartGuide: {\n    enable: false,\n    fadeOut: {\n      enable: false,\n      duration: 10000\n    }\n  }\n}\n\nconst DefaultTriggerConfiguration: TTriggerConfiguration = {\n  exportContent: 'QUIET_PERIOD',\n  exportContentDelay: 1000,\n  resizeTriggerDelay: 10\n}\n\nconst DefaultEventsConfiguration: TEventConfiguration = {\n  processDelay: 10\n}\n\nexport const DefaultConfiguration: TConfiguration = {\n  server: DefaultServerConfiguration,\n  recognition: DefaultRecognitionConfiguration,\n  grabber: DefaultGrabberConfiguration,\n  rendering: DefaultRenderingConfiguration,\n  triggers: DefaultTriggerConfiguration,\n  events: DefaultEventsConfiguration,\n} as const\n","\nimport { TConfiguration, TConfigurationClient } from '../@types/Configuration'\nimport { TEventConfiguration } from '../@types/configuration/EventConfiguration'\nimport { TGrabberConfiguration } from '../@types/configuration/GrabberConfiguration'\nimport { TRecognitionConfiguration } from '../@types/configuration/RecognitionConfiguration'\nimport { TRenderingConfiguration } from '../@types/configuration/RenderingConfiguration'\nimport { TServerConfiguration } from '../@types/configuration/ServerConfiguration'\nimport { TTriggerConfiguration } from '../@types/configuration/TriggerConfiguration'\nimport { DefaultConfiguration } from './DefaultConfiguration'\n\nexport class Configuration implements TConfiguration\n{\n  events: TEventConfiguration\n  grabber: TGrabberConfiguration\n  recognition: TRecognitionConfiguration\n  rendering: TRenderingConfiguration\n  server: TServerConfiguration\n  triggers: TTriggerConfiguration\n\n  constructor(configuration?: TConfigurationClient)\n  {\n    this.events = JSON.parse(JSON.stringify(DefaultConfiguration.events))\n    this.grabber = JSON.parse(JSON.stringify(DefaultConfiguration.grabber))\n    this.recognition = JSON.parse(JSON.stringify(DefaultConfiguration.recognition))\n    this.rendering = JSON.parse(JSON.stringify(DefaultConfiguration.rendering))\n    this.server = JSON.parse(JSON.stringify(DefaultConfiguration.server))\n    this.triggers = JSON.parse(JSON.stringify(DefaultConfiguration.triggers))\n\n    this.overrideDefaultConfiguration(configuration)\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  mergeDeep(target: any, ...sources: any[]): any\n  {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const isObject = (item: any) =>\n    {\n      return (item && typeof item === 'object' && !Array.isArray(item))\n    }\n    if (!sources.length) return target\n    const source = sources.shift()\n\n    if (isObject(target) && isObject(source)) {\n      for (const key in source) {\n        if (isObject(source[key])) {\n          if (!target[key]) {\n            Object.assign(target, { [key]: {} })\n          }\n          this.mergeDeep(target[key], source[key])\n        } else {\n          Object.assign(target, { [key]: source[key] })\n        }\n      }\n    }\n\n    return this.mergeDeep(target, ...sources)\n  }\n\n  overrideDefaultConfiguration(configuration?: TConfigurationClient): void\n  {\n    if (configuration) {\n      this.events = this.mergeDeep({}, DefaultConfiguration.events, configuration?.events)\n      this.grabber = this.mergeDeep({}, DefaultConfiguration.grabber, configuration?.grabber)\n      this.recognition = this.mergeDeep({}, DefaultConfiguration.recognition, configuration?.recognition)\n      this.rendering = this.mergeDeep({}, DefaultConfiguration.rendering, configuration?.rendering)\n      this.server = this.mergeDeep({}, DefaultConfiguration.server, configuration?.server)\n      this.triggers = this.mergeDeep({}, DefaultConfiguration.triggers, configuration?.triggers)\n\n      if (this.server?.useWindowLocation) {\n        this.server.scheme = window.location.protocol.indexOf('s') > -1 ? 'https' : 'http'\n        this.server.host = window.location.host\n      }\n\n      if (this.recognition.replaceMimeTypes) {\n        this.recognition.text.mimeTypes = configuration?.recognition?.text?.mimeTypes || ['application/vnd.myscript.jiix']\n        this.recognition.math.mimeTypes = configuration?.recognition?.math?.mimeTypes || ['application/vnd.myscript.jiix']\n        this.recognition.diagram.mimeTypes = configuration?.recognition?.diagram?.mimeTypes || ['application/vnd.myscript.jiix']\n        this.recognition.rawContent.mimeTypes = configuration?.recognition?.rawContent?.mimeTypes || ['application/vnd.myscript.jiix']\n      }\n    }\n\n    if (\n      this.server.protocol === 'WEBSOCKET' &&\n      this.recognition.type === 'TEXT'\n    ) {\n      if (\n        this.rendering.smartGuide.enable &&\n        !this.recognition.text.mimeTypes.includes('application/vnd.myscript.jiix')\n      ) {\n        // mimeType required for smartGuide\n        this.recognition.text.mimeTypes.push('application/vnd.myscript.jiix')\n      }\n    } else {\n      // smartGuide enable only on websocket text\n      this.rendering.smartGuide.enable = false\n    }\n  }\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import { TPenStyle } from '../@types/style/PenStyle'\nimport { TStroke } from '../@types/stroker/Stroker'\n\nexport class Stroke implements TStroke\n{\n  type: string\n  pointerId: number\n  pointerType: string\n  elementType?: string\n  x: number[]\n  y: number[]\n  t: number[]\n  p: number[]\n  // l: number[]\n  color: string\n  width: number\n  '-myscript-pen-width': number\n  '-myscript-pen-fill-style': string\n  '-myscript-pen-fill-color': string\n\n  constructor(style: TPenStyle, pointerId: number, pointerType = 'pen')\n  {\n    this.type = 'stroke'\n    this.pointerId = pointerId\n    this.pointerType = pointerType\n    this.x = []\n    this.y = []\n    this.t = []\n    this.p = []\n    // this.l = []\n    this.color = style.color\n    this.width = style.width\n    this['-myscript-pen-width'] = style['-myscript-pen-width']\n    this['-myscript-pen-fill-style'] = style['-myscript-pen-fill-style']\n    this['-myscript-pen-fill-color'] = style['-myscript-pen-fill-color']\n  }\n}","\n\nimport { TPenStyle } from '../@types/style/PenStyle'\nimport { TPoint } from '../@types/renderer/Point'\nimport { TStroke, TStrokeGroup } from '../@types/stroker/Stroker'\nimport { IModel, TExport, TRawResults } from '../@types/model/Model'\nimport { TRecognitionPositions } from '../@types/model/RecognitionPositions'\nimport { Stroke } from './Stroke'\n\nexport class Model implements IModel\n{\n  readonly creationTime: number\n  modificationTime?: number\n  currentStroke?: TStroke\n  strokeGroups: TStrokeGroup[]\n  lastPositions: TRecognitionPositions\n  defaultSymbols: TStroke[]\n  rawStrokes: TStroke[]\n  recognizedSymbols?: TStroke[]\n  rawResults: TRawResults\n  exports?: TExport\n  width?: number\n  height?: number\n\n  constructor(width?: number, height?: number)\n  {\n    this.rawStrokes = []\n    this.strokeGroups = []\n    this.lastPositions = {\n      lastSentPosition: -1,\n      lastReceivedPosition: -1,\n      lastRenderedPosition: -1\n    }\n    this.defaultSymbols = []\n    this.rawResults = {\n      convert: undefined,\n      exports: undefined\n    }\n    this.creationTime = new Date().getTime()\n    this.width = width\n    this.height = height\n  }\n\n  private filterPointByAcquisitionDelta(stroke: TStroke, point: TPoint): boolean\n  {\n    const delta: number = (2 + (stroke['-myscript-pen-width'] / 4))\n    return stroke.x.length === 0 || stroke.y.length === 0 ||\n      Math.abs(stroke.x[stroke.x.length - 1] - point.x) >= delta ||\n      Math.abs(stroke.y[stroke.y.length - 1] - point.y) >= delta\n  }\n\n  addPoint(stroke: TStroke, point: TPoint): void\n  {\n    if (this.filterPointByAcquisitionDelta(stroke, point)) {\n      stroke.x.push(point.x)\n      stroke.y.push(point.y)\n      stroke.t.push(point.t)\n      stroke.p.push(point.p)\n    }\n  }\n\n  addStroke(stroke: TStroke): void\n  {\n    this.rawStrokes.push(stroke)\n  }\n\n  extractPendingStrokes(position?: number): TStroke[]\n  {\n    position = position || this.lastPositions.lastReceivedPosition + 1\n    return this.rawStrokes.slice(position)\n  }\n\n  addStrokeToGroup(stroke: TStroke, strokePenStyle: TPenStyle): void\n  {\n    const lastGroup = this.strokeGroups.length - 1\n\n    const isPenStyleEqual = (ps1: TPenStyle, ps2: TPenStyle) => {\n      return ps1['-myscript-pen-fill-color'] === ps2['-myscript-pen-fill-color'] &&\n        ps1['-myscript-pen-fill-style'] === ps2['-myscript-pen-fill-style'] &&\n        ps1['-myscript-pen-width'] === ps2['-myscript-pen-width'] &&\n        ps1.color === ps2.color &&\n        ps1.width === ps2.width\n    }\n\n    if (this.strokeGroups[lastGroup] && isPenStyleEqual(this.strokeGroups[lastGroup].penStyle, strokePenStyle)) {\n      this.strokeGroups[lastGroup].strokes.push(stroke)\n    } else {\n      const newStrokeGroup: TStrokeGroup = {\n        penStyle: strokePenStyle,\n        strokes: [stroke]\n      }\n      this.strokeGroups.push(newStrokeGroup)\n    }\n  }\n\n  initCurrentStroke(point: TPoint, pointerId: number, pointerType: string, style: TPenStyle, dpi = 96): void\n  {\n    if (style['-myscript-pen-width']) {\n      const pxWidth = (style['-myscript-pen-width'] * dpi) / 25.4\n      style.width = pxWidth / 2\n    }\n    this.currentStroke = new Stroke(style, pointerId, pointerType)\n    this.addPoint(this.currentStroke, point)\n  }\n\n  appendToCurrentStroke(point: TPoint): void\n  {\n    if (this.currentStroke) {\n      this.addPoint(this.currentStroke, point)\n    }\n  }\n\n  endCurrentStroke(point: TPoint, penStyle: TPenStyle): void\n  {\n    if (this.currentStroke) {\n      this.addPoint(this.currentStroke, point)\n      // Mutating pending strokes\n      this.addStroke(this.currentStroke)\n      this.addStrokeToGroup(this.currentStroke, penStyle)\n      // Resetting the current stroke to an undefined one\n      this.currentStroke = undefined\n    }\n  }\n\n  clear(): void\n  {\n    this.currentStroke = undefined\n    this.rawStrokes = []\n    this.strokeGroups = []\n    this.lastPositions.lastSentPosition = -1\n    this.lastPositions.lastReceivedPosition = -1\n    this.lastPositions.lastRenderedPosition = -1\n    this.recognizedSymbols = undefined\n    this.exports = undefined\n    this.rawResults.convert = undefined\n    this.rawResults.exports = undefined\n  }\n}\n","import { TPenStyle } from \"../@types/style/PenStyle\"\n\nexport const DefaultPenStyle: TPenStyle = {\n  color: '#000000',\n  width: 0,\n  '-myscript-pen-width': 1,\n  '-myscript-pen-fill-style': 'none',\n  '-myscript-pen-fill-color': '#FFFFFF00'\n}","import { TTheme } from \"../@types/style/Theme\"\n\nexport const DefaultTheme: TTheme = {\n  ink: {\n    color: '#000000',\n    width: 1,\n    '-myscript-pen-width': 1,\n    '-myscript-pen-fill-style': 'none',\n    '-myscript-pen-fill-color': '#FFFFFF00'\n  },\n  '.math': {\n    'font-family': 'STIXGeneral'\n  },\n  '.math-solved': {\n    'font-family': 'STIXGeneral',\n    color: '#A8A8A8FF'\n  },\n  '.text': {\n    'font-family': 'MyScriptInter',\n    'font-size': 10\n  }\n}\n","import { TPenStyle } from \"../@types/style/PenStyle\"\nimport { TTheme } from \"../@types/style/Theme\"\nimport { DefaultPenStyle } from \"./DefaultPenStyle\"\n\nimport { DefaultTheme } from \"./DefaultTheme\"\n\nexport class StyleManager\n{\n  penStyle: TPenStyle\n  theme: TTheme\n\n  constructor(penStyle?: TPenStyle, theme?: TTheme)\n  {\n    this.penStyle = this.overrideDefaultPenStyle(penStyle)\n    this.theme = this.overrideDefaultTheme(theme)\n  }\n\n  overrideDefaultPenStyle(penStyle?: TPenStyle): TPenStyle\n  {\n    const currentPenStyle: TPenStyle = {\n      ...DefaultPenStyle,\n      ...(penStyle || {})\n    }\n    return currentPenStyle\n  }\n\n  overrideDefaultTheme(theme?: TTheme): TTheme\n  {\n    const currentTheme: TTheme = {\n      ...DefaultTheme,\n      ...(theme || {})\n    }\n    return currentTheme\n  }\n}","import { TConfiguration, TConfigurationClient } from \"./@types/Configuration\"\nimport { TEditorOptions } from \"./@types/Editor\"\nimport { IGrabber } from \"./@types/grabber/Grabber\"\nimport { IModel } from \"./@types/model/Model\"\nimport { TPoint } from \"./@types/renderer/Point\"\nimport { IRenderer } from \"./@types/renderer/Renderer\"\nimport { IStroker } from \"./@types/stroker/Stroker\"\nimport { TPenStyle } from \"./@types/style/PenStyle\"\nimport { TTheme } from \"./@types/style/Theme\"\nimport { BehaviorsManager } from \"./behaviors/BehaviorsManager\"\nimport { Configuration } from \"./configuration/Configuration\"\n\nimport './iink.css'\nimport { Model } from \"./model/Model\"\nimport { StyleManager } from \"./style/StyleManager\"\n\nexport enum EditorMode\n{\n  Mouse = 'mouse',\n  Pen = 'pen',\n  Touche = 'touch',\n  Eraser = 'eraser'\n}\n\nexport class Editor\n{\n  private _wrapperHTML: HTMLElement\n  private _loaderHTML: HTMLDivElement\n  private _errorHTML: HTMLDivElement\n  private _configuration: Configuration\n  private _behaviorsManager: BehaviorsManager\n  private _styleManager: StyleManager\n  private _mode: EditorMode\n\n  model: IModel\n  debug = false\n\n  constructor(wrapperHTML: HTMLElement, options?: TEditorOptions)\n  {\n    this._wrapperHTML = wrapperHTML as HTMLElement\n    this._wrapperHTML.classList.add(options?.globalClassCss || 'ms-editor')\n\n    this._loaderHTML = document.createElement('div')\n    this._loaderHTML.classList.add('loader')\n    this._loaderHTML = this._wrapperHTML.appendChild(this._loaderHTML)\n    this._loaderHTML.style.display = 'initial'\n\n    this._errorHTML = document.createElement('div')\n    this._errorHTML.classList.add('error-msg')\n    this._errorHTML = this._wrapperHTML.appendChild(this._errorHTML)\n    this._errorHTML.style.display = 'none'\n\n    this._mode = EditorMode.Pen\n\n    this.model = new Model(this._wrapperHTML.clientWidth, this._wrapperHTML.clientHeight)\n\n    this._styleManager = new StyleManager(options?.penStyle, options?.theme)\n\n    this._configuration = new Configuration(options?.configuration)\n\n    this._behaviorsManager = new BehaviorsManager(this.configuration, options?.behaviors)\n    this._behaviorsManager.init(this._wrapperHTML)\n      .then(async () => {\n        this.grabber.onPointerDown = (evt: PointerEvent, point: TPoint) => this.pointerDown(evt, point)\n        this.grabber.onPointerMove = (evt: PointerEvent, point: TPoint) => this.pointerMove(evt, point)\n        this.grabber.onPointerUp = (evt: PointerEvent, point: TPoint) => this.pointerUp(evt, point)\n      })\n      .catch((e: Error) =>\n      {\n        this.showError(e)\n      })\n      .finally(() =>\n      {\n        this._loaderHTML.style.display = 'none'\n      })\n  }\n\n  get configuration(): TConfiguration\n  {\n    return this._configuration\n  }\n  set configuration(config: TConfigurationClient)\n  {\n    this.clear()\n    if (this._configuration) {\n      // TODO maybe need some removeListener are close connection\n      this._configuration.overrideDefaultConfiguration(config)\n    } else {\n      this._configuration = new Configuration(config)\n    }\n  }\n  get grabber(): IGrabber\n  {\n    return this._behaviorsManager.behaviors.grabber\n  }\n  get stroker(): IStroker\n  {\n    return this._behaviorsManager.behaviors.stroker\n  }\n  get renderer(): IRenderer\n  {\n    return this._behaviorsManager.behaviors.renderer\n  }\n  get theme(): TTheme\n  {\n    return this._styleManager.theme\n  }\n  get penStyle(): TPenStyle\n  {\n    return this._styleManager.penStyle\n  }\n  get mode(): EditorMode {\n    return this._mode\n  }\n\n  private showError(err: Error)\n  {\n    this._errorHTML.style.display = 'initial'\n    this._errorHTML.innerText = err.message\n    if (this.debug) {\n      const pName = document.createElement('p')\n      pName.innerHTML = err.name\n      this._errorHTML.prepend(pName)\n\n      const pStack = document.createElement('p')\n      pStack.style.width = '50vw'\n      pStack.style.marginLeft = 'calc(-25vw + 100px)'\n      pStack.innerHTML = err.stack || ''\n      this._errorHTML.appendChild(pStack)\n    }\n  }\n\n  pointerDown(evt: PointerEvent, point: TPoint): void\n  {\n    const target: Element = (evt.target as Element)\n    const pointerDownOnEditor = target?.id === this._wrapperHTML.id || target?.classList?.contains('ms-canvas')\n    if (pointerDownOnEditor) {\n      let { pointerType } = evt\n      if (this._mode === EditorMode.Eraser) {\n        pointerType = EditorMode.Eraser\n      }\n      const style: TPenStyle = Object.assign({}, this.theme?.ink, this.penStyle)\n      this.model.initCurrentStroke(point, evt.pointerId, pointerType, style)\n      this.renderer.drawCurrentStroke(this.model, this.stroker)\n    }\n  }\n\n  pointerMove(_evt: PointerEvent, point: TPoint): void\n  {\n    this.model.appendToCurrentStroke(point)\n    this.renderer.drawCurrentStroke(this.model, this.stroker)\n  }\n\n  pointerUp(_evt: PointerEvent, point: TPoint): void\n  {\n    this.model.endCurrentStroke(point, this.penStyle)\n    this.renderer.drawModel(this.model, this.stroker)\n  }\n\n  setMode(mode: EditorMode): void\n  {\n    this._mode = mode\n    if (this._mode === EditorMode.Eraser) {\n      this._wrapperHTML.classList.add('erasing')\n    } else {\n      document.body.style.cursor = 'initial'\n      this._wrapperHTML.classList.remove('erasing')\n    }\n  }\n\n  clear(): void\n  {\n    this.model.clear()\n    this.renderer.drawModel(this.model, this.stroker)\n  }\n\n  resize(): void\n  {\n    this.model.width = this._wrapperHTML.clientWidth\n    this.model.height = this._wrapperHTML.clientHeight\n    this.renderer.resize(this.model, this.stroker)\n  }\n}\n","import { TConfigurationClient } from \"./@types/Configuration\"\n\n/**\n * Return the list of available recognition languages\n * @param {Configuration} [configuration] Configuration to get the languages\n * @return {JSON} A list of available languages\n */\n export async function getAvailableLanguageList(configuration?: TConfigurationClient): Promise<Array<Record<string, string>> | never>\n {\n   if (configuration?.server?.scheme && configuration?.server?.host) {\n     const serverConfig = configuration.server\n     const response = await fetch(`${ serverConfig.scheme }://${ serverConfig.host }/api/v4.0/iink/availableLanguageList`)\n     return response.json()\n   } else {\n     return Promise.reject('Cannot get languages ! Please check your server configuration!')\n   }\n }"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","adopt","then","apply","PointerEventGrabber","constructor","configuration","this","prevent","preventDefault","pointerDownHandler","evt","button","buttons","activePointerId","pointerId","onPointerDown","point","extractPoint","pointerMoveHandler","undefined","onPointerMove","pointerUpHandler","stopPropagation","onPointerUp","setConfiguration","roundFloat","oneFloat","requestedFloatPrecision","floatPrecision","Math","pow","round","event","clientX","clientY","changedTouches","rect","domElement","getBoundingClientRect","x","left","clientLeft","xyFloatPrecision","y","top","clientTop","t","Date","now","timestampFloatPrecision","p","pressure","attach","detach","addEventListener","listenerOptions","document","documentElement","removeEventListener","ShapeSymbols","table","shape","recognizedShape","ellipse","line","phi","angle","returnedAngle","PI","drawArrowHead","context2D","headPoint","length","alpha","beta","save","fillStyle","strokeStyle","moveTo","beginPath","lineTo","cos","sin","fill","restore","drawShapeEllipse","shapeEllipse","points","drawEllipseArc","centerPoint","maxRadius","minRadius","orientation","startAngle","sweepAngle","z1","z3","z2","z4","n","floor","abs","boundariesPoints","i","atan2","cosAlpha","sinAlpha","push","stroke","beginDecoration","beginTangentAngle","endDecoration","endTangentAngle","drawLine","p1","p2","drawShapeSymbol","symbol","lineWidth","width","color","elementType","shapeSymbol","candidates","selectedCandidateIndex","lines","forEach","lineSymbol","data","type","drawShapeLine","shapeLine","firstPoint","lastPoint","primitives","primitive","TextSymbols","inputCharacter","char","string","textLine","drawTextLine","drawText","label","font","textHeight","textAlign","justificationType","textBaseline","fillText","topLeftPoint","height","underlineList","underline","drawUnderline","delta","firstCharacter","lastCharacter","CanvasRenderer","config","createCanvas","element","canvas","createElement","classList","add","appendChild","resizeContent","context","renderingCanvas","capturingCanvas","parentNode","max","_a","minWidth","clientWidth","_b","minHeight","clientHeight","window","devicePixelRatio","style","_c","getContext","scale","drawSymbol","stroker","drawStroke","pointerType","Object","keys","includes","drawTextSymbol","init","renderingCanvasContext","capturingCanvasContext","drawModel","model","clearRect","symbols","defaultSymbols","recognizedSymbols","extractPendingStrokes","rawStrokes","drawCurrentStroke","currentStroke","resize","destroy","removeChild","computeLinksPoints","radius","computeMiddlePoint","point1","point2","computeAxeAngle","begin","end","QuadraticCanvasStroker","renderArc","context2d","center","arc","renderLine","linkPoints1","linkPoints2","renderFinal","linkPoints","newAngle","renderQuadratic","ctrl","linkPoints3","quadraticCurveTo","getPointByIndex","index","nbquadratics","secondPoint","beginLine","endLine","beginFinal","endFinal","closePath","RestBehaviors","grabber","renderer","rendering","BehaviorsManager","behaviors","overrideDefaultBehaviors","defaultBehaviors","assign","DefaultConfiguration","protocol","scheme","host","applicationKey","hmacKey","useWindowLocation","websocket","pingEnabled","pingDelay","maxPingLostCount","autoReconnect","maxRetryCount","fileChunkSize","alwaysConnected","replaceMimeTypes","lang","gesture","enable","export","jiix","strokes","text","chars","words","debug","math","mimeTypes","solver","margin","bottom","right","eraser","mode","guides","diagram","rawContent","recognition","capture","passive","smartGuide","fadeOut","duration","exportContent","exportContentDelay","resizeTriggerDelay","processDelay","Configuration","events","JSON","parse","stringify","server","triggers","overrideDefaultConfiguration","mergeDeep","target","sources","isObject","item","Array","isArray","source","shift","key","location","indexOf","_e","_d","_g","_f","_j","_h","styleInject","css","ref","insertAt","head","getElementsByTagName","firstChild","insertBefore","styleSheet","cssText","createTextNode","Stroke","Model","strokeGroups","lastPositions","lastSentPosition","lastReceivedPosition","lastRenderedPosition","rawResults","convert","exports","creationTime","getTime","filterPointByAcquisitionDelta","addPoint","addStroke","position","slice","addStrokeToGroup","strokePenStyle","lastGroup","ps1","penStyle","ps2","newStrokeGroup","initCurrentStroke","dpi","pxWidth","appendToCurrentStroke","endCurrentStroke","clear","DefaultPenStyle","DefaultTheme","ink","StyleManager","theme","overrideDefaultPenStyle","overrideDefaultTheme","EditorMode","Editor","wrapperHTML","options","_wrapperHTML","globalClassCss","_loaderHTML","display","_errorHTML","_mode","Pen","_styleManager","_configuration","_behaviorsManager","pointerDown","pointerMove","pointerUp","catch","showError","finally","err","innerText","message","pName","innerHTML","name","prepend","pStack","marginLeft","stack","id","contains","Eraser","_evt","setMode","body","cursor","remove","getAvailableLanguageList","serverConfig","fetch","json"],"mappings":"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"}