{"version":3,"file":"iink.min.js","sources":["../node_modules/tslib/tslib.es6.js","../src/Constants.ts","../src/grabber/PointerEventGrabber.ts","../src/renderer/canvas/CanvasRendererShapeSymbol.ts","../src/renderer/canvas/CanvasRendererTextSymbol.ts","../src/renderer/QuadraticUtils.ts","../src/renderer/canvas/CanvasQuadraticStroker.ts","../src/renderer/canvas/CanvasRenderer.ts","../src/renderer/canvas/CanvasRendererStrokeSymbol.ts","../node_modules/json-css/lib/jsoncss.min.js","../src/style/StyleHelper.ts","../node_modules/crypto-js/core.js","../node_modules/crypto-js/enc-hex.js","../node_modules/crypto-js/x64-core.js","../node_modules/crypto-js/sha512.js","../node_modules/crypto-js/hmac.js","../node_modules/crypto-js/hmac-sha512.js","../src/recognizer/CryptoHelper.ts","../src/recognizer/AbstractRecognizer.ts","../src/recognizer/RestRecognizer.ts","../src/utils/DeferredPromise.ts","../src/event/GlobalEvent.ts","../src/undo-redo/UndoRedoContext.ts","../src/undo-redo/UndoRedoManager.ts","../src/behaviors/RestBehaviors.ts","../src/event/WSEvent.ts","../src/recognizer/WSRecognizer.ts","../src/renderer/svg/SVGQuadraticStroker.ts","../src/renderer/svg/SVGRenderer.ts","../src/behaviors/WSBehaviors.ts","../src/behaviors/BehaviorsManager.ts","../src/configuration/DefaultConfiguration.ts","../src/configuration/Configuration.ts","../src/model/Stroke.ts","../src/model/Model.ts","../src/style/DefaultPenStyle.ts","../src/style/DefaultTheme.ts","../src/style/StyleManager.ts","../src/smartguide/SmartGuide.ts","../src/Editor.ts","../node_modules/style-inject/dist/style-inject.es.js","../src/helpers.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","/**\n * @group Error\n * @remarks List all errors generated by the backend with their descriptions\n */\nexport const Error = {\n  WRONG_CREDENTIALS: \"Application credentials are invalid. Please check or regenerate your application key and hmackey.\",\n  UNKNOW: \"An unknown error has occurred.\",\n  ABNORMAL_CLOSURE: \"MyScript recognition server is not reachable. Please reload once you are connected.\",\n  CANT_ESTABLISH: \"Unable to establish a connection to MyScript recognition server. Check the host and your connectivity.\",\n  GOING_AWAY: \"MyScript recognition server is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection.\",\n  PROTOCOL_ERROR: \"MyScript recognition server terminated the connection due to a protocol error.\",\n  UNSUPPORTED_DATA: \"MyScript recognition server terminated the connection because the endpoint received data of a type it cannot accept. (For example, a text-only endpoint received binary data.)\",\n  INVALID_FRAME_PAULOAD: \"MyScript recognition server terminated the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message).\",\n  POLICY_VIOLATION: \"MyScript recognition server terminated the connection because it received a message that violates its policy.\",\n  MESSAGE_TOO_BIG: \"MyScript recognition server terminated the connection because a data frame was received that is too large.\",\n  INTERNAL_ERROR: \"MyScript recognition server terminated the connection because it encountered an unexpected condition that prevented it from fulfilling the request.\",\n  SERVICE_RESTART: \"MyScript recognition server terminated the connection because it is restarting.\",\n  TRY_AGAIN: \"MyScript recognition server terminated the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients.\",\n  BAD_GATEWAY: \"MyScript recognition server was acting as a gateway or proxy and received an invalid response from the upstream server.\",\n  TLS_HANDSHAKE: \"MyScript recognition server connection was closed due to a failure to perform a TLS handshake\"\n} as const\n\n/**\n * @event\n * @remarks Lists all events that can be listened to on the editor or DOM element\n */\nexport const EventType = {\n  /**\n   * @event\n   * event emitted when history has changed i.e. the context of undo-redo\n   */\n  CHANGED: \"changed\",\n  /**\n   * @event\n   * event emitted on click on clear button from the Smartguide\n   */\n  CLEAR: \"clear\",\n  /**\n   * @event\n   * event emitted when clearing is complete\n   */\n  CLEARED: \"cleared\",\n  /**\n   * @event\n   * event emitted on click on convert button from the Smartguide\n   */\n  CONVERT: \"convert\",\n  /**\n   * @event\n   * event emitted after the conversion is complete\n   */\n  CONVERTED: \"converted\",\n  /**\n   * @event\n   * event emitted when the editor encounters an error\n   */\n  ERROR: \"error\",\n  /**\n   * @event\n   * event emitted after the end of the export\n   */\n  EXPORTED: \"exported\",\n  /**\n   * @event\n   * event emitted on click on candidate element from the Smartguide\n   */\n  IMPORT: \"import\",\n  /**\n   * @event\n   * event emitted after the end of the import\n   */\n  IMPORTED: \"imported\",\n  /**\n   * @event\n   * event emitted when the server is idle after a job\n   */\n  IDLE: \"idle\",\n  /**\n   * @event\n   * event emitted after full editor initialization\n   */\n  LOADED: \"loaded\",\n  /**\n   * @event\n   * event emitted to notify the user, for example after clicking the Smartguide copy button\n   */\n  NOTIF: \"notif\",\n  /**\n   * @event\n   * event emitted after rendering is complete\n   */\n  RENDERED: \"rendered\",\n} as const\n\n/**\n * @internal\n */\nexport const WSEventType = {\n  PART_CHANGE: \"ws_part_change\",\n  CONTENT_CHANGE: \"ws_content_change\",\n  SVG_PATCH: \"ws_svg_patch\",\n  EXPORTED: \"ws_exported\",\n  ERROR: \"ws_error\",\n  INITIALIZED: \"ws_initialized\",\n  CONNECTED: \"ws_connected\",\n  CONNECTION_ACTIVE: \"connection_active\",\n  DISCONNECTED: \"ws_disconnected\",\n} as const\n\n/**\n * @internal\n */\nexport const WSMessage = {\n  CLOSE_RECOGNIZER: \"CLOSE_RECOGNIZER\"\n}\n\n/**\n * @group Export\n * @remarks List all supported MIME types for export.\n * @remarks Attention, the MIME types supported depend on the {@link TRecognitionType | type of recognition}\n */\nexport const Exports = {\n  JIIX: \"application/vnd.myscript.jiix\",\n  TEXT: \"text/plain\",\n  LATEX: \"application/x-latex\",\n  MATHML: \"application/mathml+xml\",\n  SVG: \"image/svg+xml\",\n  OFFICE_DOCUMENT: \"application/vnd.openxmlformats-officedocument.presentationml.presentation\"\n} as const\n\n/**\n * @group Constants\n */\nexport default {\n  Error,\n  EventType,\n  Exports\n} as const\n","import { IGrabber } from \"../@types/grabber/Grabber\"\nimport { TGrabberConfiguration } from \"../@types/configuration/GrabberConfiguration\"\nimport { TPoint } from \"../@types/renderer/Point\"\n\nexport class PointerEventGrabber implements IGrabber\n{\n  private configuration!: TGrabberConfiguration\n\n  private domElement!: HTMLElement\n\n  private activePointerId?: number\n\n  private prevent = (e: Event) => e.preventDefault()\n\n  onPointerDown!: (evt: PointerEvent, point: TPoint) => void\n  onPointerMove!: (evt: PointerEvent, point: TPoint) => void\n  onPointerUp!: (evt: PointerEvent, point: TPoint) => void\n\n  constructor(configuration: TGrabberConfiguration)\n  {\n    this.setConfiguration(configuration)\n  }\n\n  private roundFloat(oneFloat: number, requestedFloatPrecision: number): number\n  {\n    if (requestedFloatPrecision >= 0) {\n      const floatPrecision: number = Math.pow(10, requestedFloatPrecision)\n      return Math.round(oneFloat / floatPrecision) * floatPrecision\n    }\n    return oneFloat\n  }\n\n  private extractPoint(event: MouseEvent | TouchEvent): TPoint\n  {\n    let clientX: number, clientY: number\n    if (\"changedTouches\" in event) {\n      ({ clientX, clientY } = event.changedTouches[0])\n    } else {\n      ({ clientX, clientY } = event)\n    }\n    const rect: DOMRect = this.domElement.getBoundingClientRect()\n    return {\n      x: this.roundFloat(clientX - rect.left - this.domElement.clientLeft, this.configuration.xyFloatPrecision),\n      y: this.roundFloat(clientY - rect.top - this.domElement.clientTop, this.configuration.xyFloatPrecision),\n      t: this.roundFloat(Date.now(), this.configuration.timestampFloatPrecision),\n      p: (event as PointerEvent).pressure || 1,\n\n    }\n  }\n\n  private pointerDownHandler = (evt: PointerEvent) =>\n  {\n    // exit if not a left click or multi-touch\n    if (evt.button !== 0 || evt.buttons !== 1) {\n      return\n    }\n\n    this.activePointerId = evt.pointerId\n\n    if (this.onPointerDown) {\n      const point = this.extractPoint(evt)\n      this.onPointerDown(evt, point)\n    }\n  }\n\n  private pointerMoveHandler = (evt: PointerEvent) =>\n  {\n    if (this.activePointerId != undefined && this.activePointerId === evt.pointerId) {\n      if (this.onPointerMove) {\n        const point = this.extractPoint(evt)\n        this.onPointerMove(evt, point)\n      }\n    }\n  }\n\n  private pointerUpHandler = (evt: PointerEvent) =>\n  {\n    if (this.activePointerId != undefined && this.activePointerId === evt.pointerId) {\n      this.activePointerId = undefined\n      evt.stopPropagation()\n      if (this.onPointerUp) {\n        const point = this.extractPoint(evt)\n        this.onPointerUp(evt, point)\n      }\n    }\n  }\n\n  setConfiguration(configuration: TGrabberConfiguration)\n  {\n    this.configuration = configuration\n  }\n\n  attach(domElement: HTMLElement)\n  {\n    if (this.domElement) {\n      this.detach()\n    }\n    this.domElement = domElement\n    this.domElement.addEventListener(\"pointerdown\", this.pointerDownHandler, this.configuration.listenerOptions)\n\n    this.domElement.addEventListener(\"pointermove\", this.pointerMoveHandler, this.configuration.listenerOptions)\n\n    this.domElement.addEventListener(\"pointerup\", this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement.addEventListener(\"pointerout\", this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement.addEventListener(\"pointerleave\", this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement.addEventListener(\"pointercancel\", this.pointerUpHandler, this.configuration.listenerOptions)\n\n    this.domElement.addEventListener(\"touchmove\", this.prevent)\n\n    // FIXME investigate why this is needed for iOS devices\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    document.documentElement.addEventListener(\"pointerdown\", () => { })\n  }\n\n  detach()\n  {\n    this.domElement?.removeEventListener(\"pointerdown\", this.pointerDownHandler, this.configuration.listenerOptions)\n    this.domElement?.removeEventListener(\"pointermove\", this.pointerMoveHandler, this.configuration.listenerOptions)\n    this.domElement?.removeEventListener(\"pointerup\", this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement?.removeEventListener(\"pointerout\", this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement?.removeEventListener(\"pointerleave\", this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement?.removeEventListener(\"pointercancel\", this.pointerUpHandler, this.configuration.listenerOptions)\n    this.domElement?.removeEventListener(\"touchmove\", this.prevent)\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    document.documentElement.removeEventListener(\"pointerdown\", () => { })\n  }\n}\n","\nimport { TPartialXYPoint } from \"../../@types/renderer/Point\"\nimport { TSymbol, TShapeEllipseSymbol, TShapeLineSymbol, TShapeSymbol, TShapeTableSymbol, TLineSymbol, TShapeRecognizedSymbol } from \"../../@types/renderer/Symbol\"\n\nexport const ShapeSymbols = {\n  table: \"table\",\n  shape: \"shape\",\n  recognizedShape: \"recognizedShape\",\n  ellipse: \"ellipse\",\n  line: \"line\"\n}\n\nfunction phi(angle: number): number\n{\n  let returnedAngle = ((angle + Math.PI) % (Math.PI * 2)) - Math.PI\n  if (returnedAngle < -Math.PI) {\n    returnedAngle += Math.PI * 2\n  }\n  return returnedAngle\n}\n\nfunction drawEllipseArc(context2D: CanvasRenderingContext2D, shapeEllipse: TShapeEllipseSymbol): TPartialXYPoint[]\n{\n  const { centerPoint, maxRadius, minRadius, orientation, startAngle, sweepAngle } = shapeEllipse\n  const angleStep = 0.02 // angle delta between interpolated\n\n  let z1 = Math.cos(orientation)\n  let z3 = Math.sin(orientation)\n  let z2 = z1\n  let z4 = z3\n  z1 *= maxRadius\n  z2 *= minRadius\n  z3 *= maxRadius\n  z4 *= minRadius\n\n  const n = Math.floor(Math.abs(sweepAngle) / angleStep)\n\n  const boundariesPoints = []\n\n  context2D.save()\n  try {\n    context2D.beginPath()\n\n    for (let i = 0; i <= n; i++) {\n      const angle = startAngle + ((i / n) * sweepAngle) // points on the arc, in radian\n      const alpha = Math.atan2(Math.sin(angle) / minRadius, Math.cos(angle) / maxRadius)\n\n      const cosAlpha = Math.cos(alpha)\n      const sinAlpha = Math.sin(alpha)\n\n      // current point\n      const x = (centerPoint.x + (z1 * cosAlpha)) - (z4 * sinAlpha)\n      const y = (centerPoint.y + (z2 * sinAlpha)) + (z3 * cosAlpha)\n      if (i === 0) {\n        context2D.moveTo(x, y)\n      } else {\n        context2D.lineTo(x, y)\n      }\n\n      if (i === 0 || i === n) {\n        boundariesPoints.push({ x, y })\n      }\n    }\n\n    context2D.stroke()\n  } finally {\n    context2D.restore()\n  }\n\n  return boundariesPoints\n}\n\nfunction drawArrowHead(context2D: CanvasRenderingContext2D, headPoint: TPartialXYPoint, angle: number, length: number)\n{\n  const alpha = phi(angle + (Math.PI * (7 / 8)))\n  const beta = phi(angle - (Math.PI * (7 / 8)))\n  context2D.save()\n  try {\n    context2D.fillStyle = context2D.strokeStyle\n\n    context2D.moveTo(headPoint.x, headPoint.y)\n    context2D.beginPath()\n    context2D.lineTo(headPoint.x + (length * Math.cos(alpha)), headPoint.y + (length * Math.sin(alpha)))\n    context2D.lineTo(headPoint.x + (length * Math.cos(beta)), headPoint.y + (length * Math.sin(beta)))\n    context2D.lineTo(headPoint.x, headPoint.y)\n    context2D.fill()\n  } finally {\n    context2D.restore()\n  }\n}\n\nfunction drawShapeEllipse(context2D: CanvasRenderingContext2D, shapeEllipse: TShapeEllipseSymbol)\n{\n  const points = drawEllipseArc(context2D, shapeEllipse)\n\n  if (shapeEllipse?.beginDecoration === \"ARROW_HEAD\") {\n    drawArrowHead(context2D, points[0], shapeEllipse.beginTangentAngle, 12.0)\n  }\n  if (shapeEllipse?.endDecoration === \"ARROW_HEAD\") {\n    drawArrowHead(context2D, points[1], shapeEllipse.endTangentAngle, 12.0)\n  }\n}\n\n/**\n * Draw a line\n * @param {Object} context2D Current rendering context2D\n * @param {{x: Number, y: Number}} p1 Origin point\n * @param {{x: Number, y: Number}} p2 Destination point\n */\nexport function drawLine(context2D: CanvasRenderingContext2D, p1: TPartialXYPoint, p2: TPartialXYPoint)\n{\n  context2D.save()\n  try {\n    context2D.beginPath()\n    context2D.moveTo(p1.x, p1.y)\n    context2D.lineTo(p2.x, p2.y)\n    context2D.stroke()\n  } finally {\n    context2D.restore()\n  }\n}\n\nfunction drawShapeLine(context2D: CanvasRenderingContext2D, shapeLine: TShapeLineSymbol)\n{\n  drawLine(context2D, shapeLine.firstPoint, shapeLine.lastPoint)\n  if (shapeLine.beginDecoration === \"ARROW_HEAD\") {\n    drawArrowHead(context2D, shapeLine.firstPoint, shapeLine.beginTangentAngle, 12.0)\n  }\n  if (shapeLine.endDecoration === \"ARROW_HEAD\") {\n    drawArrowHead(context2D, shapeLine.lastPoint, shapeLine.endTangentAngle, 12.0)\n  }\n}\n\n/**\n * Draw a shape symbol\n * @param {Object} context2D Current rendering context2D\n * @param {Object} symbol Symbol to draw\n */\nexport function drawShapeSymbol(context2D: CanvasRenderingContext2D, symbol: TSymbol)\n{\n  context2D.save()\n  try {\n    context2D.lineWidth = symbol.width as number\n    context2D.strokeStyle = symbol.color as string\n\n    if (symbol.elementType) {\n      switch (symbol.elementType) {\n        case ShapeSymbols.shape:\n          // eslint-disable-next-line no-case-declarations\n          const shapeSymbol = symbol as TShapeSymbol\n          drawShapeSymbol(context2D, shapeSymbol.candidates[shapeSymbol.selectedCandidateIndex])\n          break\n        case ShapeSymbols.table:\n          // eslint-disable-next-line no-case-declarations\n          const tableSymbols = symbol as TShapeTableSymbol\n          tableSymbols.lines.forEach(line => drawShapeSymbol(context2D, line))\n          break\n        case ShapeSymbols.line:\n          // eslint-disable-next-line no-case-declarations\n          const lineSymbol = symbol as TLineSymbol\n          drawLine(context2D, lineSymbol.data.p1, lineSymbol.data.p2)\n          break\n        default:\n          // logger.error(`${ symbol.elementType } not implemented`)\n          break\n      }\n    } else {\n      switch (symbol.type) {\n        case ShapeSymbols.ellipse:\n          drawShapeEllipse(context2D, symbol as TShapeEllipseSymbol)\n          break\n        case ShapeSymbols.line:\n          drawShapeLine(context2D, symbol as TShapeLineSymbol)\n          break\n        case ShapeSymbols.recognizedShape:\n          // eslint-disable-next-line no-case-declarations\n          const recognizedShape = symbol as TShapeRecognizedSymbol\n          recognizedShape.primitives.forEach(primitive => drawShapeSymbol(context2D, primitive))\n          break\n        default:\n          // logger.error(`${ symbol.type } not implemented`)\n          break\n      }\n    }\n  } finally {\n    context2D.restore()\n  }\n}\n","import { TPartialXYPoint } from \"../../@types/renderer/Point\"\nimport { drawLine } from \"./CanvasRendererShapeSymbol\"\nimport { TSymbol, TTextUnderlineDataSymbol, TTextUnderlineSymbol, TUnderLineSymbol } from \"../../@types/renderer/Symbol\"\n\nexport const TextSymbols = {\n  inputCharacter: \"inputCharacter\",\n  char: \"char\",\n  string: \"string\",\n  textLine: \"textLine\"\n}\n\nfunction drawUnderline(context2D: CanvasRenderingContext2D, underline: TUnderLineSymbol, label: string, data: TTextUnderlineDataSymbol)\n{\n  const delta = data.width / label.length\n  const p1: TPartialXYPoint = {\n    x: data.topLeftPoint.x + (underline.data.firstCharacter * delta),\n    y: data.topLeftPoint.y + data.height\n  }\n  const p2: TPartialXYPoint = {\n    x: data.topLeftPoint.x + (underline.data.lastCharacter * delta),\n    y: data.topLeftPoint.y + data.height\n  }\n  drawLine(context2D, p1, p2)\n}\n\nfunction drawText(context2D: CanvasRenderingContext2D, label: string, data: TTextUnderlineDataSymbol)\n{\n  context2D.save()\n  try {\n    context2D.font = `${ data.textHeight }px serif`\n    context2D.textAlign = (data.justificationType === \"CENTER\") ? \"center\" : \"left\"\n    context2D.textBaseline = \"bottom\"\n    context2D.fillStyle = context2D.strokeStyle\n    context2D.fillText(label, data.topLeftPoint.x, (data.topLeftPoint.y + data.height))\n  } finally {\n    context2D.restore()\n  }\n}\n\nfunction drawTextLine(context2D: CanvasRenderingContext2D, textLine: TTextUnderlineSymbol)\n{\n  drawText(context2D, textLine.label, textLine.data)\n  textLine.underlineList.forEach((underline) =>\n  {\n    drawUnderline(context2D, underline, textLine.label, textLine.data)\n  })\n}\n\n/**\n * Draw a text symbol\n * @param {Object} context Current rendering context\n * @param {Object} symbol Symbol to draw\n */\nexport function drawTextSymbol(context2D: CanvasRenderingContext2D, symbol: TSymbol)\n{\n  context2D.save()\n  try {\n    context2D.lineWidth = (symbol.width as number)\n    context2D.strokeStyle = (symbol.color as string)\n    const type: string = symbol.elementType || symbol.type\n\n    switch (type) {\n      case TextSymbols.textLine:\n        drawTextLine(context2D, symbol as TTextUnderlineSymbol)\n        break\n      default:\n        // logger.error(`${symbol.elementType} not implemented`)\n        break\n    }\n\n  } finally {\n    context2D.restore()\n  }\n}\n","import { TPartialXYPoint, TPoint } from \"../@types/renderer/Point\"\n\nexport function computeLinksPoints(point: TPoint, angle: number, width: number): TPartialXYPoint[]\n{\n  const radius = point.p * width\n  return [\n    {\n      x: (point.x - (Math.sin(angle) * radius)),\n      y: (point.y + (Math.cos(angle) * radius))\n    },\n    {\n      x: (point.x + (Math.sin(angle) * radius)),\n      y: (point.y - (Math.cos(angle) * radius))\n    }\n  ]\n}\n\nexport function computeMiddlePoint(point1: TPoint, point2: TPoint): TPoint\n{\n  return {\n    x: ((point2.x + point1.x) / 2),\n    y: ((point2.y + point1.y) / 2),\n    p: ((point2.p + point1.p) / 2),\n    t: ((point2.t + point1.t) / 2)\n  }\n}\n\nexport function computeAxeAngle(begin: TPoint, end: TPoint): number\n{\n  return Math.atan2(end.y - begin.y, end.x - begin.x)\n}\n","import { TPoint } from \"../../@types/renderer/Point\"\nimport { TStroke } from \"../../@types/model/Stroke\"\nimport { computeAxeAngle, computeLinksPoints, computeMiddlePoint } from \"../QuadraticUtils\"\n\nexport class CanvasQuadraticStroker\n{\n\n  private renderArc(context2d: CanvasRenderingContext2D, center: TPoint, radius: number): void\n  {\n    context2d.arc(center.x, center.y, radius, 0, Math.PI * 2, true)\n  }\n\n  private renderLine(context2d: CanvasRenderingContext2D, begin: TPoint, end: TPoint, width: number): void\n  {\n    const linkPoints1 = computeLinksPoints(begin, computeAxeAngle(begin, end), width)\n    const linkPoints2 = computeLinksPoints(end, computeAxeAngle(begin, end), width)\n\n    context2d.moveTo(linkPoints1[0].x, linkPoints1[0].y)\n    context2d.lineTo(linkPoints2[0].x, linkPoints2[0].y)\n    context2d.lineTo(linkPoints2[1].x, linkPoints2[1].y)\n    context2d.lineTo(linkPoints1[1].x, linkPoints1[1].y)\n  }\n\n  private renderFinal(context2d: CanvasRenderingContext2D, begin: TPoint, end: TPoint, width: number): void\n  {\n    const ARCSPLIT = 6\n    const angle = computeAxeAngle(begin, end)\n    const linkPoints = computeLinksPoints(end, angle, width)\n    context2d.moveTo(linkPoints[0].x, linkPoints[0].y)\n    for (let i = 1; i <= ARCSPLIT; i++) {\n      const newAngle = angle - ((i * Math.PI) / ARCSPLIT)\n      context2d.lineTo(end.x - ((end.p * width) * Math.sin(newAngle)), end.y + (end.p * width * Math.cos(newAngle)))\n    }\n  }\n\n  private renderQuadratic(context2d: CanvasRenderingContext2D, begin: TPoint, end: TPoint, ctrl: TPoint, width: number): void\n  {\n    const linkPoints1 = computeLinksPoints(begin, computeAxeAngle(begin, ctrl), width)\n    const linkPoints2 = computeLinksPoints(end, computeAxeAngle(ctrl, end), width)\n    const linkPoints3 = computeLinksPoints(ctrl, computeAxeAngle(begin, end), width)\n\n    context2d.moveTo(linkPoints1[0].x, linkPoints1[0].y)\n    context2d.quadraticCurveTo(linkPoints3[0].x, linkPoints3[0].y, linkPoints2[0].x, linkPoints2[0].y)\n    context2d.lineTo(linkPoints2[1].x, linkPoints2[1].y)\n    context2d.quadraticCurveTo(linkPoints3[1].x, linkPoints3[1].y, linkPoints1[1].x, linkPoints1[1].y)\n  }\n\n  private getPointByIndex(stroke: TStroke, index: number): TPoint {\n    const point: TPoint = {\n      x: stroke.x[index] || 0,\n      y: stroke.y[index] || 0,\n      t: stroke.t[index] || 0,\n      p: stroke.p[index] || 0,\n    }\n    return point\n  }\n\n  drawStroke(context2d: CanvasRenderingContext2D, stroke: TStroke): void\n  {\n    const length = stroke.x.length\n    const width = (stroke.width as number) > 0 ? (stroke.width as number) : context2d.lineWidth\n    const color = (stroke.color as string) ? (stroke.color as string) : context2d.strokeStyle\n    const firstPoint = this.getPointByIndex(stroke, 0) as TPoint\n    const nbquadratics = length - 2\n\n    context2d.save()\n    try {\n      context2d.beginPath()\n      if (length < 3) {\n        this.renderArc(context2d, firstPoint, width * 0.6)\n      } else {\n        this.renderArc(context2d, firstPoint, width * firstPoint.p)\n        const secondPoint: TPoint = computeMiddlePoint(firstPoint, this.getPointByIndex(stroke, 1))\n        this.renderLine(context2d, firstPoint, secondPoint, width)\n\n        // Possibility to try this (the start looks better when the ink is large)\n        // var first = computeMiddlePoint(stroke[0], stroke[1]);\n        // context2d.arc(first.x, first.y, width * first.p, 0, Math.PI * 2, true);\n\n        for (let i = 0; i < nbquadratics; i++) {\n          const begin: TPoint = computeMiddlePoint(this.getPointByIndex(stroke, i), this.getPointByIndex(stroke, i + 1))\n          const end: TPoint = computeMiddlePoint(this.getPointByIndex(stroke, i + 1), this.getPointByIndex(stroke, i + 2))\n          const ctrl: TPoint = this.getPointByIndex(stroke, i + 1)\n          this.renderQuadratic(context2d, begin, end, ctrl, width)\n        }\n        const beginLine: TPoint = computeMiddlePoint(this.getPointByIndex(stroke, length - 2), this.getPointByIndex(stroke, length - 1))\n        const endLine: TPoint = this.getPointByIndex(stroke, length - 1)\n        this.renderLine(context2d, beginLine, endLine, width)\n\n        const beginFinal: TPoint = this.getPointByIndex(stroke, length - 2)\n        const endFinal: TPoint = this.getPointByIndex(stroke, length - 1)\n        this.renderFinal(context2d, beginFinal, endFinal, width)\n      }\n      context2d.closePath()\n      if (color !== undefined) {\n        context2d.fillStyle = color\n        context2d.fill()\n      }\n      context2d.save()\n    }\n    finally {\n      context2d.restore()\n    }\n  }\n}\n","import { TStroke } from \"../../@types/model/Stroke\"\nimport { TRenderingConfiguration } from \"../../@types/configuration/RenderingConfiguration\"\nimport { IModel } from \"../../@types/model/Model\"\nimport { IRenderer, TCanvasRendererContext } from \"../../@types/renderer/Renderer\"\nimport { TSymbol } from \"../../@types/renderer/Symbol\"\n\nimport { drawShapeSymbol, ShapeSymbols } from \"./CanvasRendererShapeSymbol\"\nimport { drawStroke } from \"./CanvasRendererStrokeSymbol\"\nimport { drawTextSymbol, TextSymbols } from \"./CanvasRendererTextSymbol\"\nimport { CanvasQuadraticStroker } from \"./CanvasQuadraticStroker\"\n\nexport class CanvasRenderer implements IRenderer\n{\n  config: TRenderingConfiguration\n  stroker: CanvasQuadraticStroker\n  context!: TCanvasRendererContext\n\n  constructor(config: TRenderingConfiguration)\n  {\n    this.config = config\n    this.stroker = new CanvasQuadraticStroker()\n  }\n\n  private createCanvas(element: HTMLElement, type: string): HTMLCanvasElement\n  {\n    const canvas: HTMLCanvasElement = document.createElement(\"canvas\")\n    canvas.id = type\n    canvas.classList.add(type)\n    canvas.classList.add(\"ms-canvas\")\n    element.appendChild(canvas)\n    return canvas\n  }\n\n  private resizeContent(): void\n  {\n    const pixelRatio: number = window.devicePixelRatio\n    const elements: HTMLCanvasElement[] = [this.context.renderingCanvas, this.context.capturingCanvas]\n    elements.forEach((canvas) =>\n    {\n      const domElement = canvas.parentNode as HTMLElement\n      const width = Math.max(this.config.minWidth, domElement.clientWidth)\n      const height = Math.max(this.config.minHeight, domElement.clientHeight)\n      canvas.width = width * pixelRatio\n      canvas.height = height * pixelRatio\n      canvas.getContext(\"2d\")?.scale(pixelRatio, pixelRatio)\n      canvas.style.width = `${ width }px`\n      canvas.style.height = `${ height }px`\n    })\n  }\n\n  private drawSymbol(context2D: CanvasRenderingContext2D, symbol: TSymbol)\n  {\n    const type = symbol.elementType || symbol.type\n    if (type === \"stroke\") {\n      drawStroke(context2D, symbol as TStroke, this.stroker)\n    } else if (Object.keys(TextSymbols).includes(type)) {\n      drawTextSymbol(context2D, symbol)\n    } else if (Object.keys(ShapeSymbols).includes(type)) {\n      drawShapeSymbol(context2D, symbol)\n    }\n  }\n\n  init(element: HTMLElement): void\n  {\n    const renderingCanvas: HTMLCanvasElement = this.createCanvas(element, \"ms-rendering-canvas\")\n    const capturingCanvas: HTMLCanvasElement = this.createCanvas(element, \"ms-capture-canvas\")\n\n    this.context = {\n      parent: element,\n      renderingCanvas,\n      renderingCanvasContext: renderingCanvas.getContext(\"2d\") as CanvasRenderingContext2D,\n      capturingCanvas,\n      capturingCanvasContext: capturingCanvas.getContext(\"2d\") as CanvasRenderingContext2D\n    }\n\n    this.resizeContent()\n  }\n\n  drawModel(model: IModel): void\n  {\n    this.context.renderingCanvasContext?.clearRect(0, 0, this.context.renderingCanvas.width, this.context.renderingCanvas.height)\n    const symbols = [...model.defaultSymbols, ...model.rawStrokes]\n    symbols.forEach(symbol => this.drawSymbol(this.context.renderingCanvasContext, symbol))\n    this.context.capturingCanvasContext.clearRect(0, 0, this.context.capturingCanvas.width, this.context.capturingCanvas.height)\n    model.updatePositionRendered(symbols.length)\n  }\n\n  drawPendingStroke(stroke: TStroke | undefined): void\n  {\n    this.context.capturingCanvasContext.clearRect(0, 0, this.context.capturingCanvas.width, this.context.capturingCanvas.height)\n    if (stroke && stroke?.pointerType !== \"eraser\") {\n      this.stroker.drawStroke(this.context.capturingCanvasContext, stroke)\n    }\n  }\n\n  resize(model: IModel): void\n  {\n    this.resizeContent()\n    this.drawModel(model)\n  }\n\n  destroy(): void\n  {\n    if (this.context.parent) {\n      this.context.parent.innerHTML = \"\"\n    }\n  }\n}\n","import { TStroke } from \"../../@types/model/Stroke\"\nimport { CanvasQuadraticStroker } from \"./CanvasQuadraticStroker\"\n\nexport function drawStroke (context2D: CanvasRenderingContext2D, stroke: TStroke, stroker: CanvasQuadraticStroker) {\n  if (stroker && stroke && stroke.pointerType !== \"eraser\") {\n    stroker.drawStroke(context2D, stroke)\n  }\n}\n","!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports.JsonCSS=e():t.JsonCSS=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,\"a\",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p=\"\",e(e.s=1)}([function(t,e,n){\"use strict\";function o(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}Object.defineProperty(e,\"__esModule\",{value:!0});var r=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t},i=function t(e){var n=this;o(this,t),this.toJSON=function(t){if(\"string\"!=typeof t)return console.error(\"Need a CSS string but given \",void 0===t?\"undefined\":r(t),t),\"Not a valid CSS..!\";var e={},o=void 0,i=void 0,u=void 0;try{t.split(\"{\").forEach(function(t){if(i=t.trim())if(-1===i.indexOf(\"}\"))e[i]={},o=i;else{i.substring(0,i.indexOf(\"}\")).split(\";\").forEach(function(t){(u=t.split(\":\"))&&2===u.length&&(e[o][u[0].trim().replace(/^\\\"|\\\"$/g,\"\")]=n._trimSemiColon(u[1].trim().replace(/^\\\"|\\\"$/g,\"\")))});try{o=i.split(\"}\")[1].trim(),o&&(e[o]={})}catch(t){}}})}catch(t){return\"Not a valid CSS..!\"}return e},this.toCSS=function(t){if(\"object\"!==(void 0===t?\"undefined\":r(t)))return console.error(\"Need a JSON object but given \",void 0===t?\"undefined\":r(t),t),\"Not a valid JSON..!\";var e=\"\";try{for(var n in t)if(t.hasOwnProperty(n)){e+=n+\" {\\n\";for(var o in t[n])t[n].hasOwnProperty(o)&&(e+=o+\": \"+t[n][o]+\";\\n\");e+=\"}\\n\"}}catch(t){return\"Not a valid JSON..!\"}return e},this._trimSemiColon=function(t){return\";\"===t.slice(-1)?t.slice(0,n.length-1):t}};e.default=i},function(t,e,n){\"use strict\";t.exports=n(0).default}])});","import JsonCSS from \"json-css\"\nimport { TPenStyle } from \"../@types/style/PenStyle\"\nimport { TTheme } from \"../@types/style/Theme\"\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst parser: any = new JsonCSS()\n\nexport default {\n  themeToCSS(json: TTheme): string\n  {\n    return parser.toCSS(json) as string\n    // css = css.replace( /[\\r\\n]+/gm, \"\" )\n    // return css\n  },\n  themeToJSON(style: string): TTheme\n  {\n    const theme = parser.toJSON(style) as TTheme\n    theme[\".text\"][\"font-size\"] = Number(theme[\".text\"][\"font-size\"])\n    theme.ink[\"-myscript-pen-width\"] = Number(theme.ink[\"-myscript-pen-width\"])\n    theme.ink.width = Number(theme.ink.width)\n    return theme\n  },\n  penStyleToCSS (penStyle: TPenStyle): string {\n    let css = parser.toCSS({ css: penStyle }) as string\n    css = css.substring(6, css.length - 3)\n    return css\n  },\n  penStyleToJSON (penStyleString: string): TPenStyle {\n    const penStyle = parser.toJSON(`css {${penStyleString}}`).css as TPenStyle\n    if (penStyle.width) {\n      penStyle.width = Number(penStyle.width)\n    } else {\n      delete penStyle.width\n    }\n    if (penStyle[\"-myscript-pen-width\"]) {\n      penStyle[\"-myscript-pen-width\"] = Number(penStyle[\"-myscript-pen-width\"])\n    } else {\n      delete penStyle[\"-myscript-pen-width\"]\n    }\n    return penStyle\n  }\n}",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory();\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\troot.CryptoJS = factory();\n\t}\n}(this, function () {\n\n\t/**\n\t * CryptoJS core components.\n\t */\n\tvar CryptoJS = CryptoJS || (function (Math, undefined) {\n\t    /*\n\t     * Local polyfil of Object.create\n\t     */\n\t    var create = Object.create || (function () {\n\t        function F() {};\n\n\t        return function (obj) {\n\t            var subtype;\n\n\t            F.prototype = obj;\n\n\t            subtype = new F();\n\n\t            F.prototype = null;\n\n\t            return subtype;\n\t        };\n\t    }())\n\n\t    /**\n\t     * CryptoJS namespace.\n\t     */\n\t    var C = {};\n\n\t    /**\n\t     * Library namespace.\n\t     */\n\t    var C_lib = C.lib = {};\n\n\t    /**\n\t     * Base object for prototypal inheritance.\n\t     */\n\t    var Base = C_lib.Base = (function () {\n\n\n\t        return {\n\t            /**\n\t             * Creates a new object that inherits from this object.\n\t             *\n\t             * @param {Object} overrides Properties to copy into the new object.\n\t             *\n\t             * @return {Object} The new object.\n\t             *\n\t             * @static\n\t             *\n\t             * @example\n\t             *\n\t             *     var MyType = CryptoJS.lib.Base.extend({\n\t             *         field: 'value',\n\t             *\n\t             *         method: function () {\n\t             *         }\n\t             *     });\n\t             */\n\t            extend: function (overrides) {\n\t                // Spawn\n\t                var subtype = create(this);\n\n\t                // Augment\n\t                if (overrides) {\n\t                    subtype.mixIn(overrides);\n\t                }\n\n\t                // Create default initializer\n\t                if (!subtype.hasOwnProperty('init') || this.init === subtype.init) {\n\t                    subtype.init = function () {\n\t                        subtype.$super.init.apply(this, arguments);\n\t                    };\n\t                }\n\n\t                // Initializer's prototype is the subtype object\n\t                subtype.init.prototype = subtype;\n\n\t                // Reference supertype\n\t                subtype.$super = this;\n\n\t                return subtype;\n\t            },\n\n\t            /**\n\t             * Extends this object and runs the init method.\n\t             * Arguments to create() will be passed to init().\n\t             *\n\t             * @return {Object} The new object.\n\t             *\n\t             * @static\n\t             *\n\t             * @example\n\t             *\n\t             *     var instance = MyType.create();\n\t             */\n\t            create: function () {\n\t                var instance = this.extend();\n\t                instance.init.apply(instance, arguments);\n\n\t                return instance;\n\t            },\n\n\t            /**\n\t             * Initializes a newly created object.\n\t             * Override this method to add some logic when your objects are created.\n\t             *\n\t             * @example\n\t             *\n\t             *     var MyType = CryptoJS.lib.Base.extend({\n\t             *         init: function () {\n\t             *             // ...\n\t             *         }\n\t             *     });\n\t             */\n\t            init: function () {\n\t            },\n\n\t            /**\n\t             * Copies properties into this object.\n\t             *\n\t             * @param {Object} properties The properties to mix in.\n\t             *\n\t             * @example\n\t             *\n\t             *     MyType.mixIn({\n\t             *         field: 'value'\n\t             *     });\n\t             */\n\t            mixIn: function (properties) {\n\t                for (var propertyName in properties) {\n\t                    if (properties.hasOwnProperty(propertyName)) {\n\t                        this[propertyName] = properties[propertyName];\n\t                    }\n\t                }\n\n\t                // IE won't copy toString using the loop above\n\t                if (properties.hasOwnProperty('toString')) {\n\t                    this.toString = properties.toString;\n\t                }\n\t            },\n\n\t            /**\n\t             * Creates a copy of this object.\n\t             *\n\t             * @return {Object} The clone.\n\t             *\n\t             * @example\n\t             *\n\t             *     var clone = instance.clone();\n\t             */\n\t            clone: function () {\n\t                return this.init.prototype.extend(this);\n\t            }\n\t        };\n\t    }());\n\n\t    /**\n\t     * An array of 32-bit words.\n\t     *\n\t     * @property {Array} words The array of 32-bit words.\n\t     * @property {number} sigBytes The number of significant bytes in this word array.\n\t     */\n\t    var WordArray = C_lib.WordArray = Base.extend({\n\t        /**\n\t         * Initializes a newly created word array.\n\t         *\n\t         * @param {Array} words (Optional) An array of 32-bit words.\n\t         * @param {number} sigBytes (Optional) The number of significant bytes in the words.\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.lib.WordArray.create();\n\t         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607]);\n\t         *     var wordArray = CryptoJS.lib.WordArray.create([0x00010203, 0x04050607], 6);\n\t         */\n\t        init: function (words, sigBytes) {\n\t            words = this.words = words || [];\n\n\t            if (sigBytes != undefined) {\n\t                this.sigBytes = sigBytes;\n\t            } else {\n\t                this.sigBytes = words.length * 4;\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts this word array to a string.\n\t         *\n\t         * @param {Encoder} encoder (Optional) The encoding strategy to use. Default: CryptoJS.enc.Hex\n\t         *\n\t         * @return {string} The stringified word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     var string = wordArray + '';\n\t         *     var string = wordArray.toString();\n\t         *     var string = wordArray.toString(CryptoJS.enc.Utf8);\n\t         */\n\t        toString: function (encoder) {\n\t            return (encoder || Hex).stringify(this);\n\t        },\n\n\t        /**\n\t         * Concatenates a word array to this word array.\n\t         *\n\t         * @param {WordArray} wordArray The word array to append.\n\t         *\n\t         * @return {WordArray} This word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     wordArray1.concat(wordArray2);\n\t         */\n\t        concat: function (wordArray) {\n\t            // Shortcuts\n\t            var thisWords = this.words;\n\t            var thatWords = wordArray.words;\n\t            var thisSigBytes = this.sigBytes;\n\t            var thatSigBytes = wordArray.sigBytes;\n\n\t            // Clamp excess bits\n\t            this.clamp();\n\n\t            // Concat\n\t            if (thisSigBytes % 4) {\n\t                // Copy one byte at a time\n\t                for (var i = 0; i < thatSigBytes; i++) {\n\t                    var thatByte = (thatWords[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                    thisWords[(thisSigBytes + i) >>> 2] |= thatByte << (24 - ((thisSigBytes + i) % 4) * 8);\n\t                }\n\t            } else {\n\t                // Copy one word at a time\n\t                for (var i = 0; i < thatSigBytes; i += 4) {\n\t                    thisWords[(thisSigBytes + i) >>> 2] = thatWords[i >>> 2];\n\t                }\n\t            }\n\t            this.sigBytes += thatSigBytes;\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Removes insignificant bits.\n\t         *\n\t         * @example\n\t         *\n\t         *     wordArray.clamp();\n\t         */\n\t        clamp: function () {\n\t            // Shortcuts\n\t            var words = this.words;\n\t            var sigBytes = this.sigBytes;\n\n\t            // Clamp\n\t            words[sigBytes >>> 2] &= 0xffffffff << (32 - (sigBytes % 4) * 8);\n\t            words.length = Math.ceil(sigBytes / 4);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this word array.\n\t         *\n\t         * @return {WordArray} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = wordArray.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\t            clone.words = this.words.slice(0);\n\n\t            return clone;\n\t        },\n\n\t        /**\n\t         * Creates a word array filled with random bytes.\n\t         *\n\t         * @param {number} nBytes The number of random bytes to generate.\n\t         *\n\t         * @return {WordArray} The random word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.lib.WordArray.random(16);\n\t         */\n\t        random: function (nBytes) {\n\t            var words = [];\n\n\t            var r = (function (m_w) {\n\t                var m_w = m_w;\n\t                var m_z = 0x3ade68b1;\n\t                var mask = 0xffffffff;\n\n\t                return function () {\n\t                    m_z = (0x9069 * (m_z & 0xFFFF) + (m_z >> 0x10)) & mask;\n\t                    m_w = (0x4650 * (m_w & 0xFFFF) + (m_w >> 0x10)) & mask;\n\t                    var result = ((m_z << 0x10) + m_w) & mask;\n\t                    result /= 0x100000000;\n\t                    result += 0.5;\n\t                    return result * (Math.random() > .5 ? 1 : -1);\n\t                }\n\t            });\n\n\t            for (var i = 0, rcache; i < nBytes; i += 4) {\n\t                var _r = r((rcache || Math.random()) * 0x100000000);\n\n\t                rcache = _r() * 0x3ade67b7;\n\t                words.push((_r() * 0x100000000) | 0);\n\t            }\n\n\t            return new WordArray.init(words, nBytes);\n\t        }\n\t    });\n\n\t    /**\n\t     * Encoder namespace.\n\t     */\n\t    var C_enc = C.enc = {};\n\n\t    /**\n\t     * Hex encoding strategy.\n\t     */\n\t    var Hex = C_enc.Hex = {\n\t        /**\n\t         * Converts a word array to a hex string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The hex string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var hexString = CryptoJS.enc.Hex.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\n\t            // Convert\n\t            var hexChars = [];\n\t            for (var i = 0; i < sigBytes; i++) {\n\t                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                hexChars.push((bite >>> 4).toString(16));\n\t                hexChars.push((bite & 0x0f).toString(16));\n\t            }\n\n\t            return hexChars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a hex string to a word array.\n\t         *\n\t         * @param {string} hexStr The hex string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Hex.parse(hexString);\n\t         */\n\t        parse: function (hexStr) {\n\t            // Shortcut\n\t            var hexStrLength = hexStr.length;\n\n\t            // Convert\n\t            var words = [];\n\t            for (var i = 0; i < hexStrLength; i += 2) {\n\t                words[i >>> 3] |= parseInt(hexStr.substr(i, 2), 16) << (24 - (i % 8) * 4);\n\t            }\n\n\t            return new WordArray.init(words, hexStrLength / 2);\n\t        }\n\t    };\n\n\t    /**\n\t     * Latin1 encoding strategy.\n\t     */\n\t    var Latin1 = C_enc.Latin1 = {\n\t        /**\n\t         * Converts a word array to a Latin1 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The Latin1 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var latin1String = CryptoJS.enc.Latin1.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            // Shortcuts\n\t            var words = wordArray.words;\n\t            var sigBytes = wordArray.sigBytes;\n\n\t            // Convert\n\t            var latin1Chars = [];\n\t            for (var i = 0; i < sigBytes; i++) {\n\t                var bite = (words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff;\n\t                latin1Chars.push(String.fromCharCode(bite));\n\t            }\n\n\t            return latin1Chars.join('');\n\t        },\n\n\t        /**\n\t         * Converts a Latin1 string to a word array.\n\t         *\n\t         * @param {string} latin1Str The Latin1 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Latin1.parse(latin1String);\n\t         */\n\t        parse: function (latin1Str) {\n\t            // Shortcut\n\t            var latin1StrLength = latin1Str.length;\n\n\t            // Convert\n\t            var words = [];\n\t            for (var i = 0; i < latin1StrLength; i++) {\n\t                words[i >>> 2] |= (latin1Str.charCodeAt(i) & 0xff) << (24 - (i % 4) * 8);\n\t            }\n\n\t            return new WordArray.init(words, latin1StrLength);\n\t        }\n\t    };\n\n\t    /**\n\t     * UTF-8 encoding strategy.\n\t     */\n\t    var Utf8 = C_enc.Utf8 = {\n\t        /**\n\t         * Converts a word array to a UTF-8 string.\n\t         *\n\t         * @param {WordArray} wordArray The word array.\n\t         *\n\t         * @return {string} The UTF-8 string.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var utf8String = CryptoJS.enc.Utf8.stringify(wordArray);\n\t         */\n\t        stringify: function (wordArray) {\n\t            try {\n\t                return decodeURIComponent(escape(Latin1.stringify(wordArray)));\n\t            } catch (e) {\n\t                throw new Error('Malformed UTF-8 data');\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts a UTF-8 string to a word array.\n\t         *\n\t         * @param {string} utf8Str The UTF-8 string.\n\t         *\n\t         * @return {WordArray} The word array.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.enc.Utf8.parse(utf8String);\n\t         */\n\t        parse: function (utf8Str) {\n\t            return Latin1.parse(unescape(encodeURIComponent(utf8Str)));\n\t        }\n\t    };\n\n\t    /**\n\t     * Abstract buffered block algorithm template.\n\t     *\n\t     * The property blockSize must be implemented in a concrete subtype.\n\t     *\n\t     * @property {number} _minBufferSize The number of blocks that should be kept unprocessed in the buffer. Default: 0\n\t     */\n\t    var BufferedBlockAlgorithm = C_lib.BufferedBlockAlgorithm = Base.extend({\n\t        /**\n\t         * Resets this block algorithm's data buffer to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     bufferedBlockAlgorithm.reset();\n\t         */\n\t        reset: function () {\n\t            // Initial values\n\t            this._data = new WordArray.init();\n\t            this._nDataBytes = 0;\n\t        },\n\n\t        /**\n\t         * Adds new data to this block algorithm's buffer.\n\t         *\n\t         * @param {WordArray|string} data The data to append. Strings are converted to a WordArray using UTF-8.\n\t         *\n\t         * @example\n\t         *\n\t         *     bufferedBlockAlgorithm._append('data');\n\t         *     bufferedBlockAlgorithm._append(wordArray);\n\t         */\n\t        _append: function (data) {\n\t            // Convert string to WordArray, else assume WordArray already\n\t            if (typeof data == 'string') {\n\t                data = Utf8.parse(data);\n\t            }\n\n\t            // Append\n\t            this._data.concat(data);\n\t            this._nDataBytes += data.sigBytes;\n\t        },\n\n\t        /**\n\t         * Processes available data blocks.\n\t         *\n\t         * This method invokes _doProcessBlock(offset), which must be implemented by a concrete subtype.\n\t         *\n\t         * @param {boolean} doFlush Whether all blocks and partial blocks should be processed.\n\t         *\n\t         * @return {WordArray} The processed data.\n\t         *\n\t         * @example\n\t         *\n\t         *     var processedData = bufferedBlockAlgorithm._process();\n\t         *     var processedData = bufferedBlockAlgorithm._process(!!'flush');\n\t         */\n\t        _process: function (doFlush) {\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\t            var dataSigBytes = data.sigBytes;\n\t            var blockSize = this.blockSize;\n\t            var blockSizeBytes = blockSize * 4;\n\n\t            // Count blocks ready\n\t            var nBlocksReady = dataSigBytes / blockSizeBytes;\n\t            if (doFlush) {\n\t                // Round up to include partial blocks\n\t                nBlocksReady = Math.ceil(nBlocksReady);\n\t            } else {\n\t                // Round down to include only full blocks,\n\t                // less the number of blocks that must remain in the buffer\n\t                nBlocksReady = Math.max((nBlocksReady | 0) - this._minBufferSize, 0);\n\t            }\n\n\t            // Count words ready\n\t            var nWordsReady = nBlocksReady * blockSize;\n\n\t            // Count bytes ready\n\t            var nBytesReady = Math.min(nWordsReady * 4, dataSigBytes);\n\n\t            // Process blocks\n\t            if (nWordsReady) {\n\t                for (var offset = 0; offset < nWordsReady; offset += blockSize) {\n\t                    // Perform concrete-algorithm logic\n\t                    this._doProcessBlock(dataWords, offset);\n\t                }\n\n\t                // Remove processed words\n\t                var processedWords = dataWords.splice(0, nWordsReady);\n\t                data.sigBytes -= nBytesReady;\n\t            }\n\n\t            // Return processed words\n\t            return new WordArray.init(processedWords, nBytesReady);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this object.\n\t         *\n\t         * @return {Object} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = bufferedBlockAlgorithm.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\t            clone._data = this._data.clone();\n\n\t            return clone;\n\t        },\n\n\t        _minBufferSize: 0\n\t    });\n\n\t    /**\n\t     * Abstract hasher template.\n\t     *\n\t     * @property {number} blockSize The number of 32-bit words this hasher operates on. Default: 16 (512 bits)\n\t     */\n\t    var Hasher = C_lib.Hasher = BufferedBlockAlgorithm.extend({\n\t        /**\n\t         * Configuration options.\n\t         */\n\t        cfg: Base.extend(),\n\n\t        /**\n\t         * Initializes a newly created hasher.\n\t         *\n\t         * @param {Object} cfg (Optional) The configuration options to use for this hash computation.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hasher = CryptoJS.algo.SHA256.create();\n\t         */\n\t        init: function (cfg) {\n\t            // Apply config defaults\n\t            this.cfg = this.cfg.extend(cfg);\n\n\t            // Set initial values\n\t            this.reset();\n\t        },\n\n\t        /**\n\t         * Resets this hasher to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     hasher.reset();\n\t         */\n\t        reset: function () {\n\t            // Reset data buffer\n\t            BufferedBlockAlgorithm.reset.call(this);\n\n\t            // Perform concrete-hasher logic\n\t            this._doReset();\n\t        },\n\n\t        /**\n\t         * Updates this hasher with a message.\n\t         *\n\t         * @param {WordArray|string} messageUpdate The message to append.\n\t         *\n\t         * @return {Hasher} This hasher.\n\t         *\n\t         * @example\n\t         *\n\t         *     hasher.update('message');\n\t         *     hasher.update(wordArray);\n\t         */\n\t        update: function (messageUpdate) {\n\t            // Append\n\t            this._append(messageUpdate);\n\n\t            // Update the hash\n\t            this._process();\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Finalizes the hash computation.\n\t         * Note that the finalize operation is effectively a destructive, read-once operation.\n\t         *\n\t         * @param {WordArray|string} messageUpdate (Optional) A final message update.\n\t         *\n\t         * @return {WordArray} The hash.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hash = hasher.finalize();\n\t         *     var hash = hasher.finalize('message');\n\t         *     var hash = hasher.finalize(wordArray);\n\t         */\n\t        finalize: function (messageUpdate) {\n\t            // Final message update\n\t            if (messageUpdate) {\n\t                this._append(messageUpdate);\n\t            }\n\n\t            // Perform concrete-hasher logic\n\t            var hash = this._doFinalize();\n\n\t            return hash;\n\t        },\n\n\t        blockSize: 512/32,\n\n\t        /**\n\t         * Creates a shortcut function to a hasher's object interface.\n\t         *\n\t         * @param {Hasher} hasher The hasher to create a helper for.\n\t         *\n\t         * @return {Function} The shortcut function.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var SHA256 = CryptoJS.lib.Hasher._createHelper(CryptoJS.algo.SHA256);\n\t         */\n\t        _createHelper: function (hasher) {\n\t            return function (message, cfg) {\n\t                return new hasher.init(cfg).finalize(message);\n\t            };\n\t        },\n\n\t        /**\n\t         * Creates a shortcut function to the HMAC's object interface.\n\t         *\n\t         * @param {Hasher} hasher The hasher to use in this HMAC helper.\n\t         *\n\t         * @return {Function} The shortcut function.\n\t         *\n\t         * @static\n\t         *\n\t         * @example\n\t         *\n\t         *     var HmacSHA256 = CryptoJS.lib.Hasher._createHmacHelper(CryptoJS.algo.SHA256);\n\t         */\n\t        _createHmacHelper: function (hasher) {\n\t            return function (message, key) {\n\t                return new C_algo.HMAC.init(hasher, key).finalize(message);\n\t            };\n\t        }\n\t    });\n\n\t    /**\n\t     * Algorithm namespace.\n\t     */\n\t    var C_algo = C.algo = {};\n\n\t    return C;\n\t}(Math));\n\n\n\treturn CryptoJS;\n\n}));",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\treturn CryptoJS.enc.Hex;\n\n}));",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function (undefined) {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var Base = C_lib.Base;\n\t    var X32WordArray = C_lib.WordArray;\n\n\t    /**\n\t     * x64 namespace.\n\t     */\n\t    var C_x64 = C.x64 = {};\n\n\t    /**\n\t     * A 64-bit word.\n\t     */\n\t    var X64Word = C_x64.Word = Base.extend({\n\t        /**\n\t         * Initializes a newly created 64-bit word.\n\t         *\n\t         * @param {number} high The high 32 bits.\n\t         * @param {number} low The low 32 bits.\n\t         *\n\t         * @example\n\t         *\n\t         *     var x64Word = CryptoJS.x64.Word.create(0x00010203, 0x04050607);\n\t         */\n\t        init: function (high, low) {\n\t            this.high = high;\n\t            this.low = low;\n\t        }\n\n\t        /**\n\t         * Bitwise NOTs this word.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after negating.\n\t         *\n\t         * @example\n\t         *\n\t         *     var negated = x64Word.not();\n\t         */\n\t        // not: function () {\n\t            // var high = ~this.high;\n\t            // var low = ~this.low;\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Bitwise ANDs this word with the passed word.\n\t         *\n\t         * @param {X64Word} word The x64-Word to AND with this word.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after ANDing.\n\t         *\n\t         * @example\n\t         *\n\t         *     var anded = x64Word.and(anotherX64Word);\n\t         */\n\t        // and: function (word) {\n\t            // var high = this.high & word.high;\n\t            // var low = this.low & word.low;\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Bitwise ORs this word with the passed word.\n\t         *\n\t         * @param {X64Word} word The x64-Word to OR with this word.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after ORing.\n\t         *\n\t         * @example\n\t         *\n\t         *     var ored = x64Word.or(anotherX64Word);\n\t         */\n\t        // or: function (word) {\n\t            // var high = this.high | word.high;\n\t            // var low = this.low | word.low;\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Bitwise XORs this word with the passed word.\n\t         *\n\t         * @param {X64Word} word The x64-Word to XOR with this word.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after XORing.\n\t         *\n\t         * @example\n\t         *\n\t         *     var xored = x64Word.xor(anotherX64Word);\n\t         */\n\t        // xor: function (word) {\n\t            // var high = this.high ^ word.high;\n\t            // var low = this.low ^ word.low;\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Shifts this word n bits to the left.\n\t         *\n\t         * @param {number} n The number of bits to shift.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after shifting.\n\t         *\n\t         * @example\n\t         *\n\t         *     var shifted = x64Word.shiftL(25);\n\t         */\n\t        // shiftL: function (n) {\n\t            // if (n < 32) {\n\t                // var high = (this.high << n) | (this.low >>> (32 - n));\n\t                // var low = this.low << n;\n\t            // } else {\n\t                // var high = this.low << (n - 32);\n\t                // var low = 0;\n\t            // }\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Shifts this word n bits to the right.\n\t         *\n\t         * @param {number} n The number of bits to shift.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after shifting.\n\t         *\n\t         * @example\n\t         *\n\t         *     var shifted = x64Word.shiftR(7);\n\t         */\n\t        // shiftR: function (n) {\n\t            // if (n < 32) {\n\t                // var low = (this.low >>> n) | (this.high << (32 - n));\n\t                // var high = this.high >>> n;\n\t            // } else {\n\t                // var low = this.high >>> (n - 32);\n\t                // var high = 0;\n\t            // }\n\n\t            // return X64Word.create(high, low);\n\t        // },\n\n\t        /**\n\t         * Rotates this word n bits to the left.\n\t         *\n\t         * @param {number} n The number of bits to rotate.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after rotating.\n\t         *\n\t         * @example\n\t         *\n\t         *     var rotated = x64Word.rotL(25);\n\t         */\n\t        // rotL: function (n) {\n\t            // return this.shiftL(n).or(this.shiftR(64 - n));\n\t        // },\n\n\t        /**\n\t         * Rotates this word n bits to the right.\n\t         *\n\t         * @param {number} n The number of bits to rotate.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after rotating.\n\t         *\n\t         * @example\n\t         *\n\t         *     var rotated = x64Word.rotR(7);\n\t         */\n\t        // rotR: function (n) {\n\t            // return this.shiftR(n).or(this.shiftL(64 - n));\n\t        // },\n\n\t        /**\n\t         * Adds this word with the passed word.\n\t         *\n\t         * @param {X64Word} word The x64-Word to add with this word.\n\t         *\n\t         * @return {X64Word} A new x64-Word object after adding.\n\t         *\n\t         * @example\n\t         *\n\t         *     var added = x64Word.add(anotherX64Word);\n\t         */\n\t        // add: function (word) {\n\t            // var low = (this.low + word.low) | 0;\n\t            // var carry = (low >>> 0) < (this.low >>> 0) ? 1 : 0;\n\t            // var high = (this.high + word.high + carry) | 0;\n\n\t            // return X64Word.create(high, low);\n\t        // }\n\t    });\n\n\t    /**\n\t     * An array of 64-bit words.\n\t     *\n\t     * @property {Array} words The array of CryptoJS.x64.Word objects.\n\t     * @property {number} sigBytes The number of significant bytes in this word array.\n\t     */\n\t    var X64WordArray = C_x64.WordArray = Base.extend({\n\t        /**\n\t         * Initializes a newly created word array.\n\t         *\n\t         * @param {Array} words (Optional) An array of CryptoJS.x64.Word objects.\n\t         * @param {number} sigBytes (Optional) The number of significant bytes in the words.\n\t         *\n\t         * @example\n\t         *\n\t         *     var wordArray = CryptoJS.x64.WordArray.create();\n\t         *\n\t         *     var wordArray = CryptoJS.x64.WordArray.create([\n\t         *         CryptoJS.x64.Word.create(0x00010203, 0x04050607),\n\t         *         CryptoJS.x64.Word.create(0x18191a1b, 0x1c1d1e1f)\n\t         *     ]);\n\t         *\n\t         *     var wordArray = CryptoJS.x64.WordArray.create([\n\t         *         CryptoJS.x64.Word.create(0x00010203, 0x04050607),\n\t         *         CryptoJS.x64.Word.create(0x18191a1b, 0x1c1d1e1f)\n\t         *     ], 10);\n\t         */\n\t        init: function (words, sigBytes) {\n\t            words = this.words = words || [];\n\n\t            if (sigBytes != undefined) {\n\t                this.sigBytes = sigBytes;\n\t            } else {\n\t                this.sigBytes = words.length * 8;\n\t            }\n\t        },\n\n\t        /**\n\t         * Converts this 64-bit word array to a 32-bit word array.\n\t         *\n\t         * @return {CryptoJS.lib.WordArray} This word array's data as a 32-bit word array.\n\t         *\n\t         * @example\n\t         *\n\t         *     var x32WordArray = x64WordArray.toX32();\n\t         */\n\t        toX32: function () {\n\t            // Shortcuts\n\t            var x64Words = this.words;\n\t            var x64WordsLength = x64Words.length;\n\n\t            // Convert\n\t            var x32Words = [];\n\t            for (var i = 0; i < x64WordsLength; i++) {\n\t                var x64Word = x64Words[i];\n\t                x32Words.push(x64Word.high);\n\t                x32Words.push(x64Word.low);\n\t            }\n\n\t            return X32WordArray.create(x32Words, this.sigBytes);\n\t        },\n\n\t        /**\n\t         * Creates a copy of this word array.\n\t         *\n\t         * @return {X64WordArray} The clone.\n\t         *\n\t         * @example\n\t         *\n\t         *     var clone = x64WordArray.clone();\n\t         */\n\t        clone: function () {\n\t            var clone = Base.clone.call(this);\n\n\t            // Clone \"words\" array\n\t            var words = clone.words = this.words.slice(0);\n\n\t            // Clone each X64Word object\n\t            var wordsLength = words.length;\n\t            for (var i = 0; i < wordsLength; i++) {\n\t                words[i] = words[i].clone();\n\t            }\n\n\t            return clone;\n\t        }\n\t    });\n\t}());\n\n\n\treturn CryptoJS;\n\n}));",";(function (root, factory, undef) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"), require(\"./x64-core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\", \"./x64-core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var Hasher = C_lib.Hasher;\n\t    var C_x64 = C.x64;\n\t    var X64Word = C_x64.Word;\n\t    var X64WordArray = C_x64.WordArray;\n\t    var C_algo = C.algo;\n\n\t    function X64Word_create() {\n\t        return X64Word.create.apply(X64Word, arguments);\n\t    }\n\n\t    // Constants\n\t    var K = [\n\t        X64Word_create(0x428a2f98, 0xd728ae22), X64Word_create(0x71374491, 0x23ef65cd),\n\t        X64Word_create(0xb5c0fbcf, 0xec4d3b2f), X64Word_create(0xe9b5dba5, 0x8189dbbc),\n\t        X64Word_create(0x3956c25b, 0xf348b538), X64Word_create(0x59f111f1, 0xb605d019),\n\t        X64Word_create(0x923f82a4, 0xaf194f9b), X64Word_create(0xab1c5ed5, 0xda6d8118),\n\t        X64Word_create(0xd807aa98, 0xa3030242), X64Word_create(0x12835b01, 0x45706fbe),\n\t        X64Word_create(0x243185be, 0x4ee4b28c), X64Word_create(0x550c7dc3, 0xd5ffb4e2),\n\t        X64Word_create(0x72be5d74, 0xf27b896f), X64Word_create(0x80deb1fe, 0x3b1696b1),\n\t        X64Word_create(0x9bdc06a7, 0x25c71235), X64Word_create(0xc19bf174, 0xcf692694),\n\t        X64Word_create(0xe49b69c1, 0x9ef14ad2), X64Word_create(0xefbe4786, 0x384f25e3),\n\t        X64Word_create(0x0fc19dc6, 0x8b8cd5b5), X64Word_create(0x240ca1cc, 0x77ac9c65),\n\t        X64Word_create(0x2de92c6f, 0x592b0275), X64Word_create(0x4a7484aa, 0x6ea6e483),\n\t        X64Word_create(0x5cb0a9dc, 0xbd41fbd4), X64Word_create(0x76f988da, 0x831153b5),\n\t        X64Word_create(0x983e5152, 0xee66dfab), X64Word_create(0xa831c66d, 0x2db43210),\n\t        X64Word_create(0xb00327c8, 0x98fb213f), X64Word_create(0xbf597fc7, 0xbeef0ee4),\n\t        X64Word_create(0xc6e00bf3, 0x3da88fc2), X64Word_create(0xd5a79147, 0x930aa725),\n\t        X64Word_create(0x06ca6351, 0xe003826f), X64Word_create(0x14292967, 0x0a0e6e70),\n\t        X64Word_create(0x27b70a85, 0x46d22ffc), X64Word_create(0x2e1b2138, 0x5c26c926),\n\t        X64Word_create(0x4d2c6dfc, 0x5ac42aed), X64Word_create(0x53380d13, 0x9d95b3df),\n\t        X64Word_create(0x650a7354, 0x8baf63de), X64Word_create(0x766a0abb, 0x3c77b2a8),\n\t        X64Word_create(0x81c2c92e, 0x47edaee6), X64Word_create(0x92722c85, 0x1482353b),\n\t        X64Word_create(0xa2bfe8a1, 0x4cf10364), X64Word_create(0xa81a664b, 0xbc423001),\n\t        X64Word_create(0xc24b8b70, 0xd0f89791), X64Word_create(0xc76c51a3, 0x0654be30),\n\t        X64Word_create(0xd192e819, 0xd6ef5218), X64Word_create(0xd6990624, 0x5565a910),\n\t        X64Word_create(0xf40e3585, 0x5771202a), X64Word_create(0x106aa070, 0x32bbd1b8),\n\t        X64Word_create(0x19a4c116, 0xb8d2d0c8), X64Word_create(0x1e376c08, 0x5141ab53),\n\t        X64Word_create(0x2748774c, 0xdf8eeb99), X64Word_create(0x34b0bcb5, 0xe19b48a8),\n\t        X64Word_create(0x391c0cb3, 0xc5c95a63), X64Word_create(0x4ed8aa4a, 0xe3418acb),\n\t        X64Word_create(0x5b9cca4f, 0x7763e373), X64Word_create(0x682e6ff3, 0xd6b2b8a3),\n\t        X64Word_create(0x748f82ee, 0x5defb2fc), X64Word_create(0x78a5636f, 0x43172f60),\n\t        X64Word_create(0x84c87814, 0xa1f0ab72), X64Word_create(0x8cc70208, 0x1a6439ec),\n\t        X64Word_create(0x90befffa, 0x23631e28), X64Word_create(0xa4506ceb, 0xde82bde9),\n\t        X64Word_create(0xbef9a3f7, 0xb2c67915), X64Word_create(0xc67178f2, 0xe372532b),\n\t        X64Word_create(0xca273ece, 0xea26619c), X64Word_create(0xd186b8c7, 0x21c0c207),\n\t        X64Word_create(0xeada7dd6, 0xcde0eb1e), X64Word_create(0xf57d4f7f, 0xee6ed178),\n\t        X64Word_create(0x06f067aa, 0x72176fba), X64Word_create(0x0a637dc5, 0xa2c898a6),\n\t        X64Word_create(0x113f9804, 0xbef90dae), X64Word_create(0x1b710b35, 0x131c471b),\n\t        X64Word_create(0x28db77f5, 0x23047d84), X64Word_create(0x32caab7b, 0x40c72493),\n\t        X64Word_create(0x3c9ebe0a, 0x15c9bebc), X64Word_create(0x431d67c4, 0x9c100d4c),\n\t        X64Word_create(0x4cc5d4be, 0xcb3e42b6), X64Word_create(0x597f299c, 0xfc657e2a),\n\t        X64Word_create(0x5fcb6fab, 0x3ad6faec), X64Word_create(0x6c44198c, 0x4a475817)\n\t    ];\n\n\t    // Reusable objects\n\t    var W = [];\n\t    (function () {\n\t        for (var i = 0; i < 80; i++) {\n\t            W[i] = X64Word_create();\n\t        }\n\t    }());\n\n\t    /**\n\t     * SHA-512 hash algorithm.\n\t     */\n\t    var SHA512 = C_algo.SHA512 = Hasher.extend({\n\t        _doReset: function () {\n\t            this._hash = new X64WordArray.init([\n\t                new X64Word.init(0x6a09e667, 0xf3bcc908), new X64Word.init(0xbb67ae85, 0x84caa73b),\n\t                new X64Word.init(0x3c6ef372, 0xfe94f82b), new X64Word.init(0xa54ff53a, 0x5f1d36f1),\n\t                new X64Word.init(0x510e527f, 0xade682d1), new X64Word.init(0x9b05688c, 0x2b3e6c1f),\n\t                new X64Word.init(0x1f83d9ab, 0xfb41bd6b), new X64Word.init(0x5be0cd19, 0x137e2179)\n\t            ]);\n\t        },\n\n\t        _doProcessBlock: function (M, offset) {\n\t            // Shortcuts\n\t            var H = this._hash.words;\n\n\t            var H0 = H[0];\n\t            var H1 = H[1];\n\t            var H2 = H[2];\n\t            var H3 = H[3];\n\t            var H4 = H[4];\n\t            var H5 = H[5];\n\t            var H6 = H[6];\n\t            var H7 = H[7];\n\n\t            var H0h = H0.high;\n\t            var H0l = H0.low;\n\t            var H1h = H1.high;\n\t            var H1l = H1.low;\n\t            var H2h = H2.high;\n\t            var H2l = H2.low;\n\t            var H3h = H3.high;\n\t            var H3l = H3.low;\n\t            var H4h = H4.high;\n\t            var H4l = H4.low;\n\t            var H5h = H5.high;\n\t            var H5l = H5.low;\n\t            var H6h = H6.high;\n\t            var H6l = H6.low;\n\t            var H7h = H7.high;\n\t            var H7l = H7.low;\n\n\t            // Working variables\n\t            var ah = H0h;\n\t            var al = H0l;\n\t            var bh = H1h;\n\t            var bl = H1l;\n\t            var ch = H2h;\n\t            var cl = H2l;\n\t            var dh = H3h;\n\t            var dl = H3l;\n\t            var eh = H4h;\n\t            var el = H4l;\n\t            var fh = H5h;\n\t            var fl = H5l;\n\t            var gh = H6h;\n\t            var gl = H6l;\n\t            var hh = H7h;\n\t            var hl = H7l;\n\n\t            // Rounds\n\t            for (var i = 0; i < 80; i++) {\n\t                // Shortcut\n\t                var Wi = W[i];\n\n\t                // Extend message\n\t                if (i < 16) {\n\t                    var Wih = Wi.high = M[offset + i * 2]     | 0;\n\t                    var Wil = Wi.low  = M[offset + i * 2 + 1] | 0;\n\t                } else {\n\t                    // Gamma0\n\t                    var gamma0x  = W[i - 15];\n\t                    var gamma0xh = gamma0x.high;\n\t                    var gamma0xl = gamma0x.low;\n\t                    var gamma0h  = ((gamma0xh >>> 1) | (gamma0xl << 31)) ^ ((gamma0xh >>> 8) | (gamma0xl << 24)) ^ (gamma0xh >>> 7);\n\t                    var gamma0l  = ((gamma0xl >>> 1) | (gamma0xh << 31)) ^ ((gamma0xl >>> 8) | (gamma0xh << 24)) ^ ((gamma0xl >>> 7) | (gamma0xh << 25));\n\n\t                    // Gamma1\n\t                    var gamma1x  = W[i - 2];\n\t                    var gamma1xh = gamma1x.high;\n\t                    var gamma1xl = gamma1x.low;\n\t                    var gamma1h  = ((gamma1xh >>> 19) | (gamma1xl << 13)) ^ ((gamma1xh << 3) | (gamma1xl >>> 29)) ^ (gamma1xh >>> 6);\n\t                    var gamma1l  = ((gamma1xl >>> 19) | (gamma1xh << 13)) ^ ((gamma1xl << 3) | (gamma1xh >>> 29)) ^ ((gamma1xl >>> 6) | (gamma1xh << 26));\n\n\t                    // W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16]\n\t                    var Wi7  = W[i - 7];\n\t                    var Wi7h = Wi7.high;\n\t                    var Wi7l = Wi7.low;\n\n\t                    var Wi16  = W[i - 16];\n\t                    var Wi16h = Wi16.high;\n\t                    var Wi16l = Wi16.low;\n\n\t                    var Wil = gamma0l + Wi7l;\n\t                    var Wih = gamma0h + Wi7h + ((Wil >>> 0) < (gamma0l >>> 0) ? 1 : 0);\n\t                    var Wil = Wil + gamma1l;\n\t                    var Wih = Wih + gamma1h + ((Wil >>> 0) < (gamma1l >>> 0) ? 1 : 0);\n\t                    var Wil = Wil + Wi16l;\n\t                    var Wih = Wih + Wi16h + ((Wil >>> 0) < (Wi16l >>> 0) ? 1 : 0);\n\n\t                    Wi.high = Wih;\n\t                    Wi.low  = Wil;\n\t                }\n\n\t                var chh  = (eh & fh) ^ (~eh & gh);\n\t                var chl  = (el & fl) ^ (~el & gl);\n\t                var majh = (ah & bh) ^ (ah & ch) ^ (bh & ch);\n\t                var majl = (al & bl) ^ (al & cl) ^ (bl & cl);\n\n\t                var sigma0h = ((ah >>> 28) | (al << 4))  ^ ((ah << 30)  | (al >>> 2)) ^ ((ah << 25) | (al >>> 7));\n\t                var sigma0l = ((al >>> 28) | (ah << 4))  ^ ((al << 30)  | (ah >>> 2)) ^ ((al << 25) | (ah >>> 7));\n\t                var sigma1h = ((eh >>> 14) | (el << 18)) ^ ((eh >>> 18) | (el << 14)) ^ ((eh << 23) | (el >>> 9));\n\t                var sigma1l = ((el >>> 14) | (eh << 18)) ^ ((el >>> 18) | (eh << 14)) ^ ((el << 23) | (eh >>> 9));\n\n\t                // t1 = h + sigma1 + ch + K[i] + W[i]\n\t                var Ki  = K[i];\n\t                var Kih = Ki.high;\n\t                var Kil = Ki.low;\n\n\t                var t1l = hl + sigma1l;\n\t                var t1h = hh + sigma1h + ((t1l >>> 0) < (hl >>> 0) ? 1 : 0);\n\t                var t1l = t1l + chl;\n\t                var t1h = t1h + chh + ((t1l >>> 0) < (chl >>> 0) ? 1 : 0);\n\t                var t1l = t1l + Kil;\n\t                var t1h = t1h + Kih + ((t1l >>> 0) < (Kil >>> 0) ? 1 : 0);\n\t                var t1l = t1l + Wil;\n\t                var t1h = t1h + Wih + ((t1l >>> 0) < (Wil >>> 0) ? 1 : 0);\n\n\t                // t2 = sigma0 + maj\n\t                var t2l = sigma0l + majl;\n\t                var t2h = sigma0h + majh + ((t2l >>> 0) < (sigma0l >>> 0) ? 1 : 0);\n\n\t                // Update working variables\n\t                hh = gh;\n\t                hl = gl;\n\t                gh = fh;\n\t                gl = fl;\n\t                fh = eh;\n\t                fl = el;\n\t                el = (dl + t1l) | 0;\n\t                eh = (dh + t1h + ((el >>> 0) < (dl >>> 0) ? 1 : 0)) | 0;\n\t                dh = ch;\n\t                dl = cl;\n\t                ch = bh;\n\t                cl = bl;\n\t                bh = ah;\n\t                bl = al;\n\t                al = (t1l + t2l) | 0;\n\t                ah = (t1h + t2h + ((al >>> 0) < (t1l >>> 0) ? 1 : 0)) | 0;\n\t            }\n\n\t            // Intermediate hash value\n\t            H0l = H0.low  = (H0l + al);\n\t            H0.high = (H0h + ah + ((H0l >>> 0) < (al >>> 0) ? 1 : 0));\n\t            H1l = H1.low  = (H1l + bl);\n\t            H1.high = (H1h + bh + ((H1l >>> 0) < (bl >>> 0) ? 1 : 0));\n\t            H2l = H2.low  = (H2l + cl);\n\t            H2.high = (H2h + ch + ((H2l >>> 0) < (cl >>> 0) ? 1 : 0));\n\t            H3l = H3.low  = (H3l + dl);\n\t            H3.high = (H3h + dh + ((H3l >>> 0) < (dl >>> 0) ? 1 : 0));\n\t            H4l = H4.low  = (H4l + el);\n\t            H4.high = (H4h + eh + ((H4l >>> 0) < (el >>> 0) ? 1 : 0));\n\t            H5l = H5.low  = (H5l + fl);\n\t            H5.high = (H5h + fh + ((H5l >>> 0) < (fl >>> 0) ? 1 : 0));\n\t            H6l = H6.low  = (H6l + gl);\n\t            H6.high = (H6h + gh + ((H6l >>> 0) < (gl >>> 0) ? 1 : 0));\n\t            H7l = H7.low  = (H7l + hl);\n\t            H7.high = (H7h + hh + ((H7l >>> 0) < (hl >>> 0) ? 1 : 0));\n\t        },\n\n\t        _doFinalize: function () {\n\t            // Shortcuts\n\t            var data = this._data;\n\t            var dataWords = data.words;\n\n\t            var nBitsTotal = this._nDataBytes * 8;\n\t            var nBitsLeft = data.sigBytes * 8;\n\n\t            // Add padding\n\t            dataWords[nBitsLeft >>> 5] |= 0x80 << (24 - nBitsLeft % 32);\n\t            dataWords[(((nBitsLeft + 128) >>> 10) << 5) + 30] = Math.floor(nBitsTotal / 0x100000000);\n\t            dataWords[(((nBitsLeft + 128) >>> 10) << 5) + 31] = nBitsTotal;\n\t            data.sigBytes = dataWords.length * 4;\n\n\t            // Hash final blocks\n\t            this._process();\n\n\t            // Convert hash to 32-bit word array before returning\n\t            var hash = this._hash.toX32();\n\n\t            // Return final computed hash\n\t            return hash;\n\t        },\n\n\t        clone: function () {\n\t            var clone = Hasher.clone.call(this);\n\t            clone._hash = this._hash.clone();\n\n\t            return clone;\n\t        },\n\n\t        blockSize: 1024/32\n\t    });\n\n\t    /**\n\t     * Shortcut function to the hasher's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     *\n\t     * @return {WordArray} The hash.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hash = CryptoJS.SHA512('message');\n\t     *     var hash = CryptoJS.SHA512(wordArray);\n\t     */\n\t    C.SHA512 = Hasher._createHelper(SHA512);\n\n\t    /**\n\t     * Shortcut function to the HMAC's object interface.\n\t     *\n\t     * @param {WordArray|string} message The message to hash.\n\t     * @param {WordArray|string} key The secret key.\n\t     *\n\t     * @return {WordArray} The HMAC.\n\t     *\n\t     * @static\n\t     *\n\t     * @example\n\t     *\n\t     *     var hmac = CryptoJS.HmacSHA512(message, key);\n\t     */\n\t    C.HmacSHA512 = Hasher._createHmacHelper(SHA512);\n\t}());\n\n\n\treturn CryptoJS.SHA512;\n\n}));",";(function (root, factory) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\t(function () {\n\t    // Shortcuts\n\t    var C = CryptoJS;\n\t    var C_lib = C.lib;\n\t    var Base = C_lib.Base;\n\t    var C_enc = C.enc;\n\t    var Utf8 = C_enc.Utf8;\n\t    var C_algo = C.algo;\n\n\t    /**\n\t     * HMAC algorithm.\n\t     */\n\t    var HMAC = C_algo.HMAC = Base.extend({\n\t        /**\n\t         * Initializes a newly created HMAC.\n\t         *\n\t         * @param {Hasher} hasher The hash algorithm to use.\n\t         * @param {WordArray|string} key The secret key.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hmacHasher = CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256, key);\n\t         */\n\t        init: function (hasher, key) {\n\t            // Init hasher\n\t            hasher = this._hasher = new hasher.init();\n\n\t            // Convert string to WordArray, else assume WordArray already\n\t            if (typeof key == 'string') {\n\t                key = Utf8.parse(key);\n\t            }\n\n\t            // Shortcuts\n\t            var hasherBlockSize = hasher.blockSize;\n\t            var hasherBlockSizeBytes = hasherBlockSize * 4;\n\n\t            // Allow arbitrary length keys\n\t            if (key.sigBytes > hasherBlockSizeBytes) {\n\t                key = hasher.finalize(key);\n\t            }\n\n\t            // Clamp excess bits\n\t            key.clamp();\n\n\t            // Clone key for inner and outer pads\n\t            var oKey = this._oKey = key.clone();\n\t            var iKey = this._iKey = key.clone();\n\n\t            // Shortcuts\n\t            var oKeyWords = oKey.words;\n\t            var iKeyWords = iKey.words;\n\n\t            // XOR keys with pad constants\n\t            for (var i = 0; i < hasherBlockSize; i++) {\n\t                oKeyWords[i] ^= 0x5c5c5c5c;\n\t                iKeyWords[i] ^= 0x36363636;\n\t            }\n\t            oKey.sigBytes = iKey.sigBytes = hasherBlockSizeBytes;\n\n\t            // Set initial values\n\t            this.reset();\n\t        },\n\n\t        /**\n\t         * Resets this HMAC to its initial state.\n\t         *\n\t         * @example\n\t         *\n\t         *     hmacHasher.reset();\n\t         */\n\t        reset: function () {\n\t            // Shortcut\n\t            var hasher = this._hasher;\n\n\t            // Reset\n\t            hasher.reset();\n\t            hasher.update(this._iKey);\n\t        },\n\n\t        /**\n\t         * Updates this HMAC with a message.\n\t         *\n\t         * @param {WordArray|string} messageUpdate The message to append.\n\t         *\n\t         * @return {HMAC} This HMAC instance.\n\t         *\n\t         * @example\n\t         *\n\t         *     hmacHasher.update('message');\n\t         *     hmacHasher.update(wordArray);\n\t         */\n\t        update: function (messageUpdate) {\n\t            this._hasher.update(messageUpdate);\n\n\t            // Chainable\n\t            return this;\n\t        },\n\n\t        /**\n\t         * Finalizes the HMAC computation.\n\t         * Note that the finalize operation is effectively a destructive, read-once operation.\n\t         *\n\t         * @param {WordArray|string} messageUpdate (Optional) A final message update.\n\t         *\n\t         * @return {WordArray} The HMAC.\n\t         *\n\t         * @example\n\t         *\n\t         *     var hmac = hmacHasher.finalize();\n\t         *     var hmac = hmacHasher.finalize('message');\n\t         *     var hmac = hmacHasher.finalize(wordArray);\n\t         */\n\t        finalize: function (messageUpdate) {\n\t            // Shortcut\n\t            var hasher = this._hasher;\n\n\t            // Compute HMAC\n\t            var innerHash = hasher.finalize(messageUpdate);\n\t            hasher.reset();\n\t            var hmac = hasher.finalize(this._oKey.clone().concat(innerHash));\n\n\t            return hmac;\n\t        }\n\t    });\n\t}());\n\n\n}));",";(function (root, factory, undef) {\n\tif (typeof exports === \"object\") {\n\t\t// CommonJS\n\t\tmodule.exports = exports = factory(require(\"./core\"), require(\"./x64-core\"), require(\"./sha512\"), require(\"./hmac\"));\n\t}\n\telse if (typeof define === \"function\" && define.amd) {\n\t\t// AMD\n\t\tdefine([\"./core\", \"./x64-core\", \"./sha512\", \"./hmac\"], factory);\n\t}\n\telse {\n\t\t// Global (browser)\n\t\tfactory(root.CryptoJS);\n\t}\n}(this, function (CryptoJS) {\n\n\treturn CryptoJS.HmacSHA512;\n\n}));","import Hex from \"crypto-js/enc-hex\"\nimport HmacSHA512 from \"crypto-js/hmac-sha512\"\n\nexport function computeHmac (message: string, applicationKey: string, hmacKey: string): string {\n  const hmac = new HmacSHA512(message, applicationKey + hmacKey)\n  return hmac.toString(Hex) as string\n}\n","\nimport { TRecognitionConfiguration } from \"../@types/configuration/RecognitionConfiguration\"\nimport { TServerConfiguration } from \"../@types/configuration/ServerConfiguration\"\nimport { IRecognizer } from \"../@types/recognizer/Recognizer\"\nimport { IModel } from \"../@types/model/Model\"\n\nexport abstract class AbstractRecognizer implements IRecognizer\n{\n  protected serverConfiguration: TServerConfiguration\n  protected recognitionConfiguration: TRecognitionConfiguration\n\n  constructor(serverConfig: TServerConfiguration, recognitionConfig: TRecognitionConfiguration)\n  {\n    this.serverConfiguration = serverConfig\n    this.recognitionConfiguration = recognitionConfig\n  }\n  abstract export(model: IModel, mimeTypes?: string[]): Promise<IModel | never>\n\n  abstract resize(model: IModel): Promise<IModel | never>\n\n}\n","import { TStroke, TStrokeGroup, TStrokeGroupJSON } from \"../@types/model/Stroke\"\nimport { TConverstionState, TRecognitionConfiguration } from \"../@types/configuration/RecognitionConfiguration\"\nimport { TServerConfiguration } from \"../@types/configuration/ServerConfiguration\"\nimport { IModel, TExport, TJIIXExport } from \"../@types/model/Model\"\nimport { TPenStyle } from \"../@types/style/PenStyle\"\n\nimport { Error as ErrorConst } from \"../Constants\"\nimport StyleHelper from \"../style/StyleHelper\"\nimport { computeHmac } from \"./CryptoHelper\"\nimport { AbstractRecognizer } from \"./AbstractRecognizer\"\nimport { TRestPostConfiguration, TRestPostData } from \"../@types/recognizer/RestRecognizer\"\n\ntype ApiError = {\n  code?: string\n  message: string\n}\n\nexport class RestRecognizer extends AbstractRecognizer\n{\n  constructor(serverConfig: TServerConfiguration, recognitionConfig: TRecognitionConfiguration)\n  {\n    super(serverConfig, recognitionConfig)\n  }\n\n  get url()\n  {\n    return `${ this.serverConfiguration.scheme }://${ this.serverConfiguration.host }/api/v4.0/iink/batch`\n  }\n\n  get postConfig(): TRestPostConfiguration\n  {\n    switch (this.recognitionConfiguration.type) {\n      case \"DIAGRAM\":\n        return {\n          lang: this.recognitionConfiguration.lang,\n          diagram: this.recognitionConfiguration.diagram,\n          export: this.recognitionConfiguration.export\n        }\n      case \"MATH\":\n        return {\n          lang: this.recognitionConfiguration.lang,\n          math: this.recognitionConfiguration.math,\n          export: this.recognitionConfiguration.export\n        }\n      case \"Raw Content\":\n        return {\n          lang: this.recognitionConfiguration.lang,\n          \"raw-content\": this.recognitionConfiguration[\"raw-content\"],\n          export: this.recognitionConfiguration.export\n        }\n      case \"TEXT\":\n        return {\n          lang: this.recognitionConfiguration.lang,\n          text: this.recognitionConfiguration.text,\n          export: this.recognitionConfiguration.export\n        }\n      default:\n        throw new Error(`get postConfig error Recognition type unkow \"${ this.recognitionConfiguration.type }\"`)\n        break\n    }\n  }\n\n  private buildData(model: IModel): TRestPostData\n  {\n    const newStrokes: TStrokeGroupJSON[] = []\n    model.strokeGroups.forEach((group: TStrokeGroup) =>\n    {\n      const newPenStyle = JSON.stringify(group.penStyle) === \"{}\" ? undefined : StyleHelper.penStyleToCSS(group.penStyle as TPenStyle)\n      const newGroup = {\n        penStyle: newPenStyle,\n        strokes: group.strokes.map((s: TStroke) =>\n        {\n          return {\n            x: s.x,\n            y: s.y,\n            t: s.t,\n            p: s.p,\n            pointerType: s.pointerType\n          }\n        })\n      }\n      newStrokes.push(newGroup)\n    })\n\n    const contentType: string = this.recognitionConfiguration.type === \"Raw Content\" ?\n      \"Raw Content\" :\n      this.recognitionConfiguration.type.charAt(0).toUpperCase() + this.recognitionConfiguration.type.slice(1).toLowerCase()\n\n    return {\n      configuration: this.postConfig,\n      xDPI: 96,\n      yDPI: 96,\n      contentType,\n      // theme: StyleHelper.themeToCSS(),\n      height: model.height,\n      width: model.width,\n      strokeGroups: newStrokes\n    }\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private async post(data: any, mimeType: string): Promise<any>\n  {\n    const headers = new Headers()\n    headers.append(\"Accept\", \"application/json,\" + mimeType)\n    headers.append(\"applicationKey\", this.serverConfiguration.applicationKey)\n    headers.append(\"hmac\", computeHmac(JSON.stringify(data), this.serverConfiguration.applicationKey, this.serverConfiguration.hmacKey))\n    headers.append(\"Content-Type\", \"application/json\")\n    const reqInit: RequestInit = {\n      method: \"POST\",\n      headers,\n      body: JSON.stringify(data)\n    }\n    const request = new Request(this.url, reqInit)\n    const response: Response = await fetch(request)\n    if (response.ok) {\n      const contentType = response.headers.get(\"content-type\")\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      let result: any\n      switch (contentType) {\n        case \"application/vnd.openxmlformats-officedocument.presentationml.presentation\":\n        case \"image/png\":\n        case \"image/jpeg\":\n          result = await response.blob()\n          break\n        case \"application/json\":\n          result = await response.json()\n          break\n        case \"application/vnd.myscript.jiix\":\n          result = await response.clone().json().catch(async () => await response.text())\n          break\n        default:\n          result = await response.text()\n          break\n      }\n      return result\n    } else {\n      const err = await response.json() as ApiError\n      throw err\n    }\n  }\n\n  private async tryFetch(data: unknown, mimeType: string): Promise<TExport | never>\n  {\n    return this.post(data, mimeType)\n      .then((res) =>\n      {\n        const exports: TExport = {}\n        exports[mimeType] = res as TJIIXExport | string | Blob\n        return exports\n      })\n      .catch((err) =>\n      {\n        let message = err.message || ErrorConst.UNKNOW\n        if (!err.code) {\n          message = ErrorConst.CANT_ESTABLISH\n        } else if (err.code === \"access.not.granted\") {\n          message = ErrorConst.WRONG_CREDENTIALS\n        }\n        const error = new Error(message)\n        throw error\n      })\n  }\n\n  private getMimeTypes(requestedMimeTypes?: string[]): string[]\n  {\n    let mimeTypes: string[] = requestedMimeTypes || []\n    if (!mimeTypes.length) {\n      switch (this.recognitionConfiguration.type) {\n        case \"DIAGRAM\":\n          mimeTypes = this.recognitionConfiguration.diagram.mimeTypes\n          break\n        case \"MATH\":\n          mimeTypes = this.recognitionConfiguration.math.mimeTypes\n          break\n        case \"Raw Content\":\n          mimeTypes = [\"application/vnd.myscript.jiix\"]\n          break\n        case \"TEXT\":\n          mimeTypes = this.recognitionConfiguration.text.mimeTypes\n          break\n        default:\n          throw new Error(`Recognition type \"${ this.recognitionConfiguration.type }\" is unknown.\\n Possible types are:\\n -DIAGRAM\\n -MATH\\n -Raw Content\\n -TEXT`)\n          break\n      }\n    }\n    return mimeTypes\n  }\n\n  async convert(model: IModel, conversionState?: TConverstionState, requestedMimeTypes?: string[]): Promise<IModel | never>\n  {\n    const myModel = model.getClone()\n    myModel.updatePositionSent()\n\n    const mimeTypes = this.getMimeTypes(requestedMimeTypes)\n\n    const dataToConcert = this.buildData(myModel)\n    dataToConcert.conversionState = conversionState\n\n    const promises = mimeTypes.map(mt => this.tryFetch(dataToConcert, mt))\n    const converts: TExport[] = await Promise.all(promises)\n    converts.forEach(c => {\n      myModel.converts = Object.assign(myModel.converts || {}, c)\n    })\n\n    myModel.updatePositionReceived()\n\n    return myModel\n  }\n\n  private async exportModel(model: IModel, mimeType: string): Promise<TExport | never>\n  {\n    const data = this.buildData(model)\n    return this.tryFetch(data, mimeType)\n  }\n\n  async export(model: IModel, requestedMimeTypes?: string[]): Promise<IModel | never>\n  {\n    const myModel = model.getClone()\n    myModel.updatePositionSent()\n\n    if (myModel.isEmpty) {\n      return Promise.resolve(myModel)\n    }\n\n    const mimeTypes = this.getMimeTypes(requestedMimeTypes)\n\n    if (!mimeTypes.length) {\n      return Promise.reject(new Error(\"Export failed, no mimeTypes define in recognition configuration\"))\n    }\n\n    const mimeTypesRequiringExport: string[] = mimeTypes.filter(m => !myModel.exports || !myModel.exports[m])\n    const exports: TExport[] = await Promise.all(mimeTypesRequiringExport.map(mimeType => this.exportModel(myModel, mimeType)))\n    exports.forEach(e => {\n      myModel.exports = Object.assign(myModel.exports || {}, e)\n    })\n\n    myModel.updatePositionReceived()\n\n    return myModel\n  }\n\n  async resize(model: IModel): Promise<IModel | never>\n  {\n    return this.export(model)\n  }\n\n}\n","\nexport class DeferredPromise<T> {\n  promise: Promise<T>\n  resolve!: (value: T) => void\n  reject!: (value: Error) => void\n\n  isFullFilled: boolean\n  isPending: boolean\n\n\n  constructor() {\n    this.isFullFilled = false\n    this.isPending = true\n\n    this.promise = new Promise((resolve, reject)=> {\n      this.reject = async (v: unknown) => {\n        this.isFullFilled = true\n        this.isPending = false\n        return reject(v)\n      }\n      this.resolve = async (v: unknown) => {\n        this.isFullFilled = true\n        this.isPending = false\n        return resolve(v as T)\n      }\n    })\n  }\n}","import { IModel, TExport, TJIIXExport } from \"../@types/model/Model\"\nimport { TUndoRedoContext } from \"../@types/undo-redo/UndoRedoContext\"\nimport { EventType } from \"../Constants\"\n\nexport class GlobalEvent extends EventTarget\n{\n  static #instance: GlobalEvent\n\n  private constructor()\n  {\n    super()\n  }\n\n  public static getInstance(): GlobalEvent\n  {\n    if (!GlobalEvent.#instance) {\n      GlobalEvent.#instance = new GlobalEvent()\n    }\n\n    return GlobalEvent.#instance\n  }\n\n  #emit(type: string, data?: unknown): void\n  {\n    this.dispatchEvent(new CustomEvent(type, Object.assign({ bubbles: true, composed: true }, data ? { detail: data } : undefined)))\n  }\n\n  emitLoaded(): void\n  {\n    this.#emit(EventType.LOADED)\n  }\n\n  emitExported(exports: TExport): void\n  {\n    this.#emit(EventType.EXPORTED, exports)\n  }\n\n  emitChange(undoRedoContext: TUndoRedoContext): void\n  {\n    this.#emit(EventType.CHANGED, {\n      canUndo: undoRedoContext.canUndo,\n      canRedo: undoRedoContext.canRedo,\n      canClear: !undoRedoContext.stack[undoRedoContext.stackIndex].isEmpty,\n      stackIndex: undoRedoContext.stackIndex,\n      stackLength: undoRedoContext.stack.length,\n      isEmpty: undoRedoContext.stack[undoRedoContext.stackIndex].isEmpty,\n    })\n  }\n\n  emitIdle(model: IModel): void\n  {\n    this.#emit(EventType.IDLE, model)\n  }\n\n  emitError(err: Error): void\n  {\n    this.#emit(EventType.ERROR, err)\n  }\n  emitNotif(message: string, timeout?: number): void\n  {\n    this.#emit(EventType.NOTIF, { message, timeout })\n  }\n\n  emitClear(): void\n  {\n    this.#emit(EventType.CLEAR)\n  }\n  emitCleared(model?: IModel): void\n  {\n    this.#emit(EventType.CLEARED, model)\n  }\n\n  emitConvert(): void\n  {\n    this.#emit(EventType.CONVERT, exports)\n  }\n  emitConverted(exports: TExport): void\n  {\n    this.#emit(EventType.CONVERTED, exports)\n  }\n\n  emitImport(jiix: string | TJIIXExport, mimeType: string): void\n  {\n    this.#emit(EventType.IMPORT, { jiix, mimeType })\n  }\n  emitImported(jiix: TJIIXExport): void\n  {\n    this.#emit(EventType.IMPORTED, jiix)\n  }\n}\n","import { IModel } from \"../@types/model/Model\"\nimport { TUndoRedoContext } from \"../@types/undo-redo/UndoRedoContext\"\n\nexport class UndoRedoContext implements TUndoRedoContext\n{\n  stackIndex: number\n  stack: IModel[]\n  canRedo: boolean\n  canUndo: boolean\n\n  constructor(model: IModel)\n  {\n    this.stackIndex = 0\n    this.stack = [model.getClone()]\n    this.canRedo = false\n    this.canUndo = false\n  }\n}\n","import { TUndoRedoConfiguration } from \"../@types/configuration/UndoRedoConfiguration\"\nimport { IModel } from \"../@types/model/Model\"\nimport { TUndoRedoContext } from \"../@types/undo-redo/UndoRedoContext\"\nimport { GlobalEvent } from \"../event/GlobalEvent\"\nimport { UndoRedoContext } from \"./UndoRedoContext\"\n\nexport class UndoRedoManager\n{\n  context: TUndoRedoContext\n  configuration: TUndoRedoConfiguration\n\n  constructor(configuration: TUndoRedoConfiguration, model: IModel)\n  {\n    this.configuration = configuration\n    this.context = new UndoRedoContext(model)\n  }\n\n  get globalEvent(): GlobalEvent\n  {\n    return GlobalEvent.getInstance()\n  }\n\n  private updateCanUndoRedo(): void {\n    this.context.canRedo = this.context.stack.length - 1 > this.context.stackIndex\n    this.context.canUndo = this.context.stackIndex > 0\n  }\n\n  getLastModel(): IModel {\n    return this.context.stack[this.context.stack.length - 1]\n  }\n\n  getModelFromModificationDate(modificationDate: number): IModel {\n    return this.context.stack.find(m => m.modificationDate === modificationDate) as IModel\n  }\n\n  addModelToStack(model: IModel): void {\n    if (this.context.stackIndex + 1 < this.context.stack.length) {\n      this.context.stack.splice(this.context.stackIndex + 1)\n    }\n\n    this.context.stackIndex++\n    this.context.stack.push(model.getClone())\n\n    if (this.context.stack.length > this.configuration.maxStackSize) {\n      this.context.stack.shift()\n      this.context.stackIndex--\n    }\n\n    this.updateCanUndoRedo()\n    this.globalEvent.emitChange(this.context)\n  }\n\n  updateModelInStack(model: IModel): void {\n    const index = this.context.stack.findIndex(m => m.modificationDate === model.modificationDate)\n    if (index > -1) {\n      this.context.stack.splice(index, 1, model.getClone())\n      this.globalEvent.emitChange(this.context)\n    }\n  }\n\n  undo(): IModel {\n    if (this.context.canUndo) {\n      this.context.stackIndex--\n      this.updateCanUndoRedo()\n      this.globalEvent.emitChange(this.context)\n    }\n    return this.context.stack[this.context.stackIndex].getClone()\n  }\n\n  redo(): IModel {\n    if (this.context.canRedo) {\n      this.context.stackIndex++\n      this.updateCanUndoRedo()\n      this.globalEvent.emitChange(this.context)\n    }\n    return this.context.stack[this.context.stackIndex].getClone()\n  }\n\n  reset(model: IModel): void {\n    this.context = new UndoRedoContext(model)\n    this.globalEvent.emitChange(this.context)\n  }\n\n}\n","import { IBehaviors } from \"../@types/Behaviors\"\nimport { TConfiguration } from \"../@types/Configuration\"\nimport { IModel, TExport } from \"../@types/model/Model\"\n\nimport { PointerEventGrabber } from \"../grabber/PointerEventGrabber\"\nimport { CanvasRenderer } from \"../renderer/canvas/CanvasRenderer\"\nimport { RestRecognizer } from \"../recognizer/RestRecognizer\"\nimport { DeferredPromise } from \"../utils/DeferredPromise\"\nimport { TTriggerConfiguration } from \"../@types/configuration/TriggerConfiguration\"\nimport { GlobalEvent } from \"../event/GlobalEvent\"\nimport { UndoRedoManager } from \"../undo-redo/UndoRedoManager\"\nimport { TConverstionState } from \"../@types/configuration/RecognitionConfiguration\"\n\nexport class RestBehaviors implements IBehaviors\n{\n  grabber: PointerEventGrabber\n  renderer: CanvasRenderer\n  recognizer: RestRecognizer\n  undoRedoManager: UndoRedoManager\n  initialized: DeferredPromise<void | Error>\n\n  #triggerConfiguration: TTriggerConfiguration\n  #resizeTimer?: ReturnType<typeof setTimeout>\n  #exportTimer?: ReturnType<typeof setTimeout>\n\n  constructor(configuration: TConfiguration, model: IModel)\n  {\n    this.grabber = new PointerEventGrabber(configuration.grabber)\n    this.renderer = new CanvasRenderer(configuration.rendering)\n    this.recognizer = new RestRecognizer(configuration.server, configuration.recognition)\n    this.undoRedoManager = new UndoRedoManager(configuration[\"undo-redo\"], model.getClone())\n\n    this.#triggerConfiguration = configuration.triggers\n    this.initialized = new DeferredPromise<void | Error>()\n  }\n\n  get globalEvent(): GlobalEvent\n  {\n    return GlobalEvent.getInstance()\n  }\n\n  async #_export(model: IModel, mimeTypes?: string[]): Promise<IModel | never>\n  {\n    const newModel = await this.recognizer.export(model, mimeTypes)\n    this.globalEvent.emitExported(newModel?.exports as TExport)\n    return newModel\n  }\n\n  async init(domElement: HTMLElement): Promise<void | Error>\n  {\n    this.grabber.attach(domElement)\n    this.renderer.init(domElement)\n    this.initialized.resolve()\n    return this.initialized.promise\n  }\n\n  drawCurrentStroke(model: IModel): void\n  {\n    this.renderer.drawPendingStroke(model.currentStroke)\n  }\n\n  async updateModelRendering(model: IModel): Promise<IModel | never>\n  {\n    this.renderer.drawModel(model)\n    return this.export(model)\n  }\n\n  async export(model: IModel, mimeTypes?: string[]): Promise<IModel | never>\n  {\n    const deferred = new DeferredPromise<IModel | never>()\n    this.undoRedoManager.addModelToStack(model)\n    if (this.#triggerConfiguration.exportContent !== \"DEMAND\") {\n      clearTimeout(this.#exportTimer)\n      let currentModel = model.getClone()\n      this.#exportTimer = setTimeout(async () =>\n      {\n        try {\n          currentModel = await this.#_export(currentModel, mimeTypes)\n          this.undoRedoManager.updateModelInStack(currentModel)\n          if (model.modificationDate === currentModel.modificationDate) {\n            model.exports = currentModel.exports\n          }\n          deferred.resolve(model)\n        } catch (error) {\n          deferred.reject(error as Error)\n        }\n      }, this.#triggerConfiguration.exportContentDelay)\n    } else {\n      deferred.resolve(model)\n    }\n    return deferred.promise\n  }\n\n  async convert(model: IModel, conversionState?: TConverstionState, requestedMimeTypes?: string[]): Promise<IModel | never>\n  {\n    return this.recognizer.convert(model, conversionState, requestedMimeTypes)\n  }\n\n  async resize(model: IModel): Promise<IModel>\n  {\n    this.renderer.resize(model)\n    if (model.strokeGroups.length) {\n      const deferredResize = new DeferredPromise<IModel>()\n      clearTimeout(this.#resizeTimer)\n      this.#resizeTimer = setTimeout(async () =>\n      {\n        const resizeModel = await this.recognizer.resize(model)\n        deferredResize.resolve(resizeModel)\n      }, this.#triggerConfiguration.resizeTriggerDelay)\n      return deferredResize.promise\n    } else {\n      return Promise.resolve(model)\n    }\n  }\n\n  async undo(): Promise<IModel>\n  {\n    const oldModel = this.undoRedoManager.undo()\n    this.renderer.drawModel(oldModel)\n    const modelUpdated = await this.#_export(oldModel)\n    this.undoRedoManager.updateModelInStack(modelUpdated)\n    return modelUpdated\n  }\n\n  async redo(): Promise<IModel>\n  {\n    const newModel = this.undoRedoManager.redo()\n    this.renderer.drawModel(newModel)\n    const modelUpdated = await this.#_export(newModel)\n    this.undoRedoManager.updateModelInStack(modelUpdated)\n    return modelUpdated\n  }\n\n  async clear(model: IModel): Promise<IModel>\n  {\n    const myModel = model.getClone()\n    myModel.clear()\n    this.undoRedoManager.addModelToStack(myModel)\n    this.renderer.drawModel(myModel)\n    myModel.modificationDate = new Date().getTime()\n    this.globalEvent.emitCleared(myModel)\n    this.globalEvent.emitExported(myModel.exports as TExport)\n    return myModel\n  }\n\n  async destroy(model: IModel): Promise<void>\n  {\n    this.grabber.detach()\n    this.renderer.destroy()\n    this.undoRedoManager.reset(model)\n    this.globalEvent.emitCleared(model)\n    this.globalEvent.emitExported(model.exports as TExport)\n    return Promise.resolve()\n  }\n}\n","import { TWebSocketContentChangeEvent, TWebSocketExportEvent, TWebSocketPartChangeEvent, TWebSocketSVGPatchEvent } from \"../@types/recognizer/WSRecognizer\"\nimport { WSEventType } from \"../Constants\"\n\nexport class WSEvent extends EventTarget\n{\n  #abortController: AbortController\n\n  constructor()\n  {\n    super()\n    this.#abortController = new AbortController()\n  }\n\n  private emit(type: string, data?: unknown): void\n  {\n    this.dispatchEvent(new CustomEvent(type, Object.assign({ bubbles: true, composed: true }, data ? { detail: data } : undefined)))\n  }\n\n  emitInitialized(): void\n  {\n    this.emit(WSEventType.INITIALIZED)\n  }\n  emitConnected(): void\n  {\n    this.emit(WSEventType.CONNECTED)\n  }\n\n  emitConnectionActive(): void\n  {\n    this.emit(WSEventType.CONNECTION_ACTIVE)\n  }\n  addConnectionActiveListener(callback: () => void): void\n  {\n    this.addEventListener(WSEventType.CONNECTION_ACTIVE, () => callback(), { signal: this.#abortController.signal })\n  }\n\n  emitDisconnected(event: CloseEvent): void\n  {\n    this.emit(WSEventType.DISCONNECTED, event)\n  }\n  addDisconnectedListener(callback: (event: CloseEvent) => void): void\n  {\n    this.addEventListener(WSEventType.DISCONNECTED, (evt: unknown) => callback(((evt as CustomEvent).detail as CloseEvent)), { signal: this.#abortController.signal })\n  }\n\n  emitPartChange(partChange: TWebSocketPartChangeEvent): void\n  {\n    this.emit(WSEventType.PART_CHANGE, partChange)\n  }\n  addPartChangeListener(callback: (partChange: TWebSocketPartChangeEvent) => void): void\n  {\n    this.addEventListener(WSEventType.PART_CHANGE, (evt: unknown) => callback(((evt as CustomEvent).detail as TWebSocketPartChangeEvent)), { signal: this.#abortController.signal })\n  }\n\n  emitContentChange(contentChange: TWebSocketContentChangeEvent): void\n  {\n    this.emit(WSEventType.CONTENT_CHANGE, contentChange)\n  }\n  addContentChangeListener(callback: (contentChange: TWebSocketContentChangeEvent) => void): void\n  {\n    this.addEventListener(WSEventType.CONTENT_CHANGE, (evt: unknown) => callback(((evt as CustomEvent).detail as TWebSocketContentChangeEvent)), { signal: this.#abortController.signal })\n  }\n\n  emitSVGPatch(patchChange: TWebSocketSVGPatchEvent): void\n  {\n    this.emit(WSEventType.SVG_PATCH, patchChange)\n  }\n  addSVGPatchListener(callback: (contentChange: TWebSocketSVGPatchEvent) => void): void\n  {\n    this.addEventListener(WSEventType.SVG_PATCH, (evt: unknown) => callback(((evt as CustomEvent).detail as TWebSocketSVGPatchEvent)), { signal: this.#abortController.signal })\n  }\n\n  emitExported(exports: TWebSocketExportEvent): void\n  {\n    this.emit(WSEventType.EXPORTED, exports)\n  }\n  addExportListener(callback: (exports: TWebSocketExportEvent) => void): void\n  {\n    this.addEventListener(WSEventType.EXPORTED, (evt: unknown) => callback(((evt as CustomEvent).detail as TWebSocketExportEvent)), { signal: this.#abortController.signal })\n  }\n\n  emitError(err: Error): void\n  {\n    this.emit(WSEventType.ERROR, err)\n  }\n  addErrorListener(callback: (err: Error) => void): void\n  {\n    this.addEventListener(WSEventType.ERROR, (evt: unknown) => callback(((evt as CustomEvent).detail as Error)), { signal: this.#abortController.signal })\n  }\n\n  clearListeners()\n  {\n    this.#abortController.abort()\n  }\n}","import { TConverstionState, TRecognitionConfiguration } from \"../@types/configuration/RecognitionConfiguration\"\nimport { TServerConfiguration } from \"../@types/configuration/ServerConfiguration\"\nimport { IModel, TExport } from \"../@types/model/Model\"\nimport { TWebSocketContentChangeEvent, TWebSocketErrorEvent, TWebSocketEvent, TWebSocketExportEvent, TWebSocketHMACChallengeEvent, TWebSocketPartChangeEvent, TWebSocketSVGPatchEvent } from \"../@types/recognizer/WSRecognizer\"\nimport { TStroke } from \"../@types/model/Stroke\"\nimport { Error as ErrorConst, WSEventType } from \"../Constants\"\nimport { WSEvent } from \"../event/WSEvent\"\nimport { AbstractRecognizer } from \"./AbstractRecognizer\"\nimport { computeHmac } from \"./CryptoHelper\"\nimport StyleHelper from \"../style/StyleHelper\"\nimport { DeferredPromise } from \"../utils/DeferredPromise\"\nimport { TPenStyle } from \"../@types/style/PenStyle\"\nimport { TTheme } from \"../@types/style/Theme\"\n\nexport class WSRecognizer extends AbstractRecognizer\n{\n  private socket!: WebSocket\n  private pingCount = 0\n  private reconnectionCount = 0\n  // private contentPartCount = 0\n  private sessionId?: string\n  private currentPartId?: string\n  private viewSizeHeight!: number\n  private viewSizeWidth!: number\n  private currentErrorCode?: string | number\n  wsEvent: WSEvent\n\n  #fileImportDeffered?: DeferredPromise<TExport>\n\n  constructor(serverConfig: TServerConfiguration, recognitionConfig: TRecognitionConfiguration)\n  {\n    super(serverConfig, recognitionConfig)\n    this.wsEvent = new WSEvent()\n  }\n\n  get url()\n  {\n    const scheme = (this.serverConfiguration.scheme === \"https\") ? \"wss\" : \"ws\"\n    return `${ scheme }://${ this.serverConfiguration.host }/api/v4.0/iink/document`\n  }\n\n  get mimeTypes(): string[]\n  {\n    switch (this.recognitionConfiguration.type.toLocaleLowerCase()) {\n      case \"text\":\n        return this.recognitionConfiguration.text.mimeTypes\n      case \"math\":\n        return this.recognitionConfiguration.math.mimeTypes\n      case \"diagram\":\n        return this.recognitionConfiguration.diagram.mimeTypes\n      default:\n        //'raw-content'\n        return []\n    }\n  }\n\n  private infinitePing(): void\n  {\n    this.pingCount++\n    if (this.serverConfiguration.websocket.maxPingLostCount < this.pingCount) {\n      this.close(1000, \"PING_LOST\")\n    } else if (this.socket.readyState <= 1) {\n      setTimeout(() =>\n      {\n        if (this.socket.readyState <= 1) {\n          this.socket.send(JSON.stringify({ type: \"ping\" }))\n          this.infinitePing()\n        }\n      }, this.serverConfiguration.websocket.pingDelay)\n    }\n  }\n\n  private openCallback(): void\n  {\n    this.wsEvent.emitConnected()\n    const params = {\n      type: this.sessionId ? \"restoreIInkSession\" : \"newContentPackage\",\n      iinkSessionId: this.sessionId,\n      applicationKey: this.serverConfiguration.applicationKey,\n      xDpi: 96,\n      yDpi: 96,\n      viewSizeHeight: this.viewSizeHeight,\n      viewSizeWidth: this.viewSizeWidth\n    }\n    this.send(params)\n  }\n\n  private closeCallback(evt: CloseEvent): void\n  {\n    let message = \"\"\n    if (!this.currentErrorCode) {\n      switch (evt.code) {\n        case 1000:\n          // Normal Closure\n          break\n        case 1001:\n          message = ErrorConst.GOING_AWAY\n          break\n        case 1002:\n          message = ErrorConst.PROTOCOL_ERROR\n          break\n        case 1003:\n          message = ErrorConst.UNSUPPORTED_DATA\n          break\n        case 1006:\n          message = ErrorConst.ABNORMAL_CLOSURE\n          break\n        case 1007:\n          message = ErrorConst.INVALID_FRAME_PAULOAD\n          break\n        case 1008:\n          message = ErrorConst.POLICY_VIOLATION\n          break\n        case 1009:\n          message = ErrorConst.MESSAGE_TOO_BIG\n          break\n        case 1011:\n          message = ErrorConst.INTERNAL_ERROR\n          break\n        case 1012:\n          message = ErrorConst.SERVICE_RESTART\n          break\n        case 1013:\n          message = ErrorConst.TRY_AGAIN\n          break\n        case 1014:\n          message = ErrorConst.BAD_GATEWAY\n          break\n        case 1015:\n          message = ErrorConst.TLS_HANDSHAKE\n          break\n        default:\n          message = ErrorConst.CANT_ESTABLISH\n          break\n      }\n      if (message) {\n        this.wsEvent.emitError(new Error(message))\n      }\n    }\n    this.wsEvent.emitDisconnected(evt)\n  }\n\n  // private errorCallback(e: Event): void\n  // {\n  //   this.wsEvent.emitError(new Error(e.type))\n  // }\n\n  private manageHMACChallengeMessage(websocketMessage: TWebSocketEvent): void\n  {\n    const hmacChallengeMessage = websocketMessage as TWebSocketHMACChallengeEvent\n    if (hmacChallengeMessage.hmacChallenge) {\n      this.send({\n        type: \"hmac\",\n        hmac: computeHmac(hmacChallengeMessage.hmacChallenge, this.serverConfiguration.applicationKey, this.serverConfiguration.hmacKey)\n      })\n    }\n    if (hmacChallengeMessage.iinkSessionId) {\n      this.sessionId = hmacChallengeMessage.iinkSessionId\n    }\n  }\n\n  private manageContentPackageDescriptionMessage(): void\n  {\n    this.reconnectionCount = 0\n\n    this.send({ ...this.recognitionConfiguration, type: \"configuration\" })\n\n    if (this.currentPartId) {\n      this.send({ type: \"openContentPart\", id: this.currentPartId, mimeTypes: this.mimeTypes })\n    }\n    else {\n      this.send({ type: \"newContentPart\", contentType: this.recognitionConfiguration.type, mimeTypes: this.mimeTypes })\n    }\n  }\n\n  private managePartChangeMessage(websocketMessage: TWebSocketEvent): void\n  {\n    const partChangeMessage = websocketMessage as TWebSocketPartChangeEvent\n    this.currentPartId = partChangeMessage.partId\n    this.wsEvent.emitPartChange(partChangeMessage)\n  }\n\n  private manageContentChangeMessage(websocketMessage: TWebSocketEvent): void\n  {\n    const contentChangeMessage = websocketMessage as TWebSocketContentChangeEvent\n    this.wsEvent.emitContentChange(contentChangeMessage)\n  }\n\n  private manageExportMessage(websocketMessage: TWebSocketEvent): void\n  {\n    const exportMessage = websocketMessage as TWebSocketExportEvent\n    this.wsEvent.emitExported(exportMessage)\n  }\n\n  private manageSVGPatchMessage(websocketMessage: TWebSocketEvent): void\n  {\n    const svgPatchMessage = websocketMessage as TWebSocketSVGPatchEvent\n    this.wsEvent.emitSVGPatch(svgPatchMessage)\n  }\n\n  private manageErrorMessage(websocketMessage: TWebSocketEvent): void\n  {\n    const err = websocketMessage as TWebSocketErrorEvent\n    this.currentErrorCode = err.data?.code || err.code\n    let message = err.data?.message || err.message || ErrorConst.UNKNOW\n    if (this.currentErrorCode === \"access.not.granted\") {\n      message = ErrorConst.WRONG_CREDENTIALS\n    }\n    this.wsEvent.emitError(new Error(message))\n  }\n\n  private messageCallback(message: MessageEvent<string>): void\n  {\n    this.currentErrorCode = undefined\n    const websocketMessage: TWebSocketEvent = JSON.parse(message.data)\n    if (websocketMessage.type !== \"pong\") {\n      this.pingCount = 0\n      switch (websocketMessage.type) {\n        case \"ack\":\n          this.manageHMACChallengeMessage(websocketMessage)\n          break\n        case \"contentPackageDescription\":\n          this.manageContentPackageDescriptionMessage()\n          break\n        case \"partChanged\":\n          this.managePartChangeMessage(websocketMessage)\n          break\n        case \"newPart\":\n          this.wsEvent.emitConnectionActive()\n          break\n        case \"contentChanged\":\n          this.manageContentChangeMessage(websocketMessage)\n          break\n        case \"exported\":\n          this.manageExportMessage(websocketMessage)\n          break\n        case \"svgPatch\":\n          this.manageSVGPatchMessage(websocketMessage)\n          break\n        case \"error\":\n          this.manageErrorMessage(websocketMessage)\n          break\n        // case 'supportedImportMimeTypes':\n        //   recognizerContext.supportedImportMimeTypes = message.data.mimeTypes\n        //   recognitionContext.response(undefined, message.data)\n        //   break\n        case \"fileChunkAck\":\n          this.#fileImportDeffered?.resolve((websocketMessage as unknown) as TExport)\n          break\n        //   case 'idle':\n        //     recognizerContext.idle = true\n        //     recognitionContext.patch(undefined, message.data)\n        //     break\n        //   default :\n        //     logger.warn('This is something unexpected in current recognizer. Not the type of message we should have here.', message)\n      }\n    }\n  }\n\n  init(height: number, width: number): void\n  {\n    try {\n      this.viewSizeHeight = height\n      this.viewSizeWidth = width\n\n      this.socket = new WebSocket(this.url)\n\n      if (this.serverConfiguration.websocket.pingEnabled) {\n        this.infinitePing()\n      }\n\n      this.socket.onopen = () => this.openCallback()\n      this.socket.onclose = (ev: CloseEvent) => this.closeCallback(ev)\n      // this.socket.onerror = (ev: Event) => this.errorCallback(ev)\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      this.socket.onmessage = (ev: MessageEvent<any>) => this.messageCallback(ev)\n\n      this.wsEvent.emitInitialized()\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    } catch (err: any) {\n      const error = new Error(ErrorConst.CANT_ESTABLISH)\n      error.name = err.code || \"CANT_ESTABLISH\"\n      this.wsEvent.emitError(err)\n    }\n  }\n\n  canReconnect(): boolean\n  {\n    return this.serverConfiguration.websocket.autoReconnect &&\n      this.reconnectionCount <= this.serverConfiguration.websocket.maxRetryCount &&\n      (!this.currentErrorCode || ![\"api.invalid.format\", \"access.not.granted\"].includes(this.currentErrorCode.toString()))\n  }\n\n  addStrokes(model: IModel): void\n  {\n    const strokes: TStroke[] = model.extractPendingStrokes()\n    if (strokes.length === 0) {\n      return\n    }\n    this.send({\n      type: \"addStrokes\",\n      strokes: strokes.map((s: TStroke) =>\n      {\n        return {\n          pointerType: s.pointerType,\n          pointerId: s.pointerId,\n          x: s.x,\n          y: s.y,\n          t: s.t,\n          p: s.p,\n        }\n      })\n    })\n  }\n\n  send(message: TWebSocketEvent): void\n  {\n    if (this.socket.readyState === this.socket.OPEN) {\n      this.socket.send(JSON.stringify(message))\n    } else {\n      this.socket.removeEventListener(\"close\", this.closeCallback)\n      // this.socket.removeEventListener('error', this.errorCallback)\n      this.socket.removeEventListener(\"message\", this.messageCallback)\n      this.socket.removeEventListener(\"open\", this.openCallback)\n      throw new Error(WSEventType.DISCONNECTED)\n    }\n  }\n\n  close(code: number, reason: string): void\n  {\n    if (this.socket.readyState === this.socket.OPEN || this.socket.readyState === this.socket.CONNECTING) {\n      this.socket.close(code, reason)\n    }\n  }\n\n  setPenStyle(penStyle: TPenStyle): void\n  {\n    const message: TWebSocketEvent = {\n      type: \"setPenStyle\",\n      style: StyleHelper.penStyleToCSS(penStyle)\n    }\n    this.send(message)\n  }\n\n  setPenStyleClasses(penStyleClasses: string): void\n  {\n    const message: TWebSocketEvent = {\n      type: \"setPenStyleClasses\",\n      styleClasses: penStyleClasses\n    }\n    this.send(message)\n  }\n\n  setTheme(theme: TTheme)\n  {\n    const message: TWebSocketEvent = {\n      type: \"setTheme\",\n      theme: StyleHelper.themeToCSS(theme)\n    }\n    this.send(message)\n  }\n\n  async export(model: IModel, requestedMimeTypes?: string[]): Promise<IModel | never>\n  {\n    let mimeTypes: string[] = requestedMimeTypes || []\n    if (!mimeTypes.length) {\n      switch (this.recognitionConfiguration.type) {\n        case \"DIAGRAM\":\n          mimeTypes = this.recognitionConfiguration.diagram.mimeTypes\n          break\n        case \"MATH\":\n          mimeTypes = this.recognitionConfiguration.math.mimeTypes\n          break\n        case \"Raw Content\":\n          mimeTypes = [\"application/vnd.myscript.jiix\"]\n          break\n        case \"TEXT\":\n          mimeTypes = this.recognitionConfiguration.text.mimeTypes\n          break\n        default:\n          throw new Error(`Recognition type \"${ this.recognitionConfiguration.type }\" is unknown.\\n Possible types are:\\n -DIAGRAM\\n -MATH\\n -Raw Content\\n -TEXT`)\n          break\n      }\n    }\n\n    if (!mimeTypes.length) {\n      return Promise.reject(new Error(\"Export failed, no mimeTypes define in recognition configuration\"))\n    }\n\n    const message: TWebSocketEvent = {\n      type: \"export\",\n      partId: this.currentPartId,\n      mimeTypes\n    }\n    this.send(message)\n    return model\n  }\n\n  async import(data: Blob, mimeType?: string): Promise<TExport | never>\n  {\n    const chunkSize = this.serverConfiguration.websocket.fileChunkSize\n    const importFileId = Math.random().toString(10).substring(2, 6)\n    // const messages = []\n    this.#fileImportDeffered = new DeferredPromise<TExport>()\n    const readBlob = (blob: Blob): Promise<string | never> =>\n    {\n      const fileReader = new FileReader()\n      return new Promise((resolve, reject) =>\n      {\n        fileReader.onloadend = (ev) => resolve(ev.target?.result as string)\n        fileReader.onerror = () => reject()\n        fileReader.readAsText(blob)\n      })\n    }\n\n    const importFileMessage: TWebSocketEvent = {\n      type: \"importFile\",\n      importFileId,\n      mimeType\n    }\n    this.send(importFileMessage)\n\n    for (let i = 0; i < data.size; i += chunkSize) {\n      const blobPart = data.slice(i, chunkSize, data.type)\n      const partFileString = await readBlob(blobPart)\n      const fileChuckMessage: TWebSocketEvent = {\n        type: \"fileChunk\",\n        importFileId,\n        data: partFileString,\n        lastChunk: i + chunkSize > data.size\n      }\n      this.send(fileChuckMessage)\n    }\n    return this.#fileImportDeffered.promise\n  }\n\n  async resize(model: IModel): Promise<IModel>\n  {\n    this.viewSizeHeight = model.height\n    this.viewSizeWidth = model.width\n    const message: TWebSocketEvent = {\n      type: \"changeViewSize\",\n      height: this.viewSizeHeight,\n      width: this.viewSizeWidth,\n    }\n    this.send(message)\n    return Promise.resolve(model)\n  }\n\n  convert(conversionState?: TConverstionState): void\n  {\n    const message: TWebSocketEvent = {\n      type: \"convert\",\n      conversionState\n    }\n    this.send(message)\n  }\n\n  undo(): void\n  {\n    const message: TWebSocketEvent = {\n      type: \"undo\",\n    }\n    this.send(message)\n  }\n\n  redo(): void\n  {\n    const message: TWebSocketEvent = {\n      type: \"redo\",\n    }\n    this.send(message)\n  }\n\n  clear(): void\n  {\n    const message: TWebSocketEvent = {\n      type: \"clear\",\n    }\n    this.send(message)\n  }\n}\n","import { TPoint } from \"../../@types/renderer/Point\"\nimport { TStroke } from \"../../@types/model/Stroke\"\nimport { computeAxeAngle, computeLinksPoints, computeMiddlePoint } from \"../QuadraticUtils\"\n\nexport class SVGQuadraticStroker\n{\n\n  private getArcPath(center: TPoint, radius: number): string\n  {\n    const svgPath = [\n      `M ${center.x},${center.y}`,\n      `m ${-radius},0`,\n      `a ${radius},${radius} 0 1 0 ${radius * 2},0`,\n      `a ${radius},${radius} 0 1 0 ${-(radius * 2)},0`\n    ].join(\" \")\n    return svgPath\n  }\n\n  private getLinePath(begin: TPoint, end: TPoint, width: number): string\n  {\n    const linkPoints1 = computeLinksPoints(begin, computeAxeAngle(begin, end), width)\n    const linkPoints2 = computeLinksPoints(end, computeAxeAngle(begin, end), width)\n    const svgPath = [\n      `M ${linkPoints1[0].x},${linkPoints1[0].y}`,\n      `L ${linkPoints2[0].x},${linkPoints2[0].y}`,\n      `L ${linkPoints2[1].x},${linkPoints2[1].y}`,\n      `L ${linkPoints1[1].x},${linkPoints1[1].y}`\n    ].join(\" \")\n    return svgPath\n  }\n\n  private getFinalPath(begin: TPoint, end: TPoint, width: number): string\n  {\n    const ARCSPLIT = 6\n    const angle = computeAxeAngle(begin, end)\n    const linkPoints = computeLinksPoints(end, angle, width)\n    const parts = [`M ${linkPoints[0].x},${linkPoints[0].y}`]\n    for (let i = 1; i <= ARCSPLIT; i++) {\n      const newAngle = angle - (i * (Math.PI / ARCSPLIT))\n      parts.push(`L ${end.x - (end.p * width * Math.sin(newAngle))},${end.y + (end.p * width * Math.cos(newAngle))}`)\n    }\n    const svgPath = parts.join(\" \")\n    return svgPath\n  }\n\n  private getQuadraticPath(begin: TPoint, end: TPoint, central: TPoint, width: number): string\n  {\n    const linkPoints1 = computeLinksPoints(begin, computeAxeAngle(begin, central), width)\n    const linkPoints2 = computeLinksPoints(end, computeAxeAngle(central, end), width)\n    const linkPoints3 = computeLinksPoints(central, computeAxeAngle(begin, end), width)\n    const svgPath = [\n      `M ${linkPoints1[0].x},${linkPoints1[0].y}`,\n      `Q ${linkPoints3[0].x},${linkPoints3[0].y} ${linkPoints2[0].x},${linkPoints2[0].y}`,\n      `L ${linkPoints2[1].x},${linkPoints2[1].y}`,\n      `Q ${linkPoints3[1].x},${linkPoints3[1].y} ${linkPoints1[1].x},${linkPoints1[1].y}`\n    ].join(\" \")\n    return svgPath\n  }\n\n  private getPointByIndex(stroke: TStroke, index: number): TPoint {\n    const point: TPoint = {\n      x: stroke.x[index] || 0,\n      y: stroke.y[index] || 0,\n      t: stroke.t[index] || 0,\n      p: stroke.p[index] || 0,\n    }\n    return point\n  }\n\n  private buildSVGPath (stroke: TStroke): string  {\n    const STROKE_LENGTH = stroke.x.length\n    const STROKE_WIDTH = (stroke.width as number)\n    const NB_QUADRATICS = STROKE_LENGTH - 2\n    const firstPoint = this.getPointByIndex(stroke, 0)\n\n    const parts = []\n    if (STROKE_LENGTH < 3) {\n      parts.push(this.getArcPath(firstPoint, STROKE_WIDTH * 0.6))\n    } else {\n      parts.push(this.getArcPath(firstPoint, STROKE_WIDTH * firstPoint.p))\n      parts.push(this.getLinePath(firstPoint, computeMiddlePoint(firstPoint, this.getPointByIndex(stroke, 1)), STROKE_WIDTH))\n\n      for (let i = 0; i < NB_QUADRATICS; i++) {\n        const begin = computeMiddlePoint(this.getPointByIndex(stroke, i), this.getPointByIndex(stroke, i + 1))\n        const end = computeMiddlePoint(this.getPointByIndex(stroke, i + 1), this.getPointByIndex(stroke, i + 2))\n        const central = this.getPointByIndex(stroke, i + 1)\n        parts.push(this.getQuadraticPath(begin, end, central, STROKE_WIDTH)\n        )\n      }\n      const beforeLastPoint = this.getPointByIndex(stroke, STROKE_LENGTH - 2)\n      const lastPoint = this.getPointByIndex(stroke, STROKE_LENGTH - 1)\n      parts.push(this.getLinePath(computeMiddlePoint(beforeLastPoint, lastPoint), lastPoint, STROKE_WIDTH))\n      parts.push(this.getFinalPath(beforeLastPoint, lastPoint, STROKE_WIDTH))\n    }\n    return parts.join(\" \")\n  }\n\n  drawStroke(svgElement: SVGElement, stroke: TStroke): void\n  {\n    const svgPath = this.buildSVGPath(stroke)\n    const svgStroke = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\")\n    svgStroke.classList.add(\"pending-stroke\")\n    svgStroke.setAttribute(\"id\", stroke.id as string)\n    svgStroke.setAttribute(\"color\", stroke.color as string)\n    const style = `fill:${stroke.color};stroke:transparent;`\n    svgStroke.setAttribute(\"style\", style)\n    svgStroke.setAttribute(\"d\", `${svgPath}Z`)\n    svgElement.appendChild(svgStroke)\n  }\n\n  drawErasingStroke (svgElement: SVGElement, stroke: TStroke) {\n    stroke.width = 20\n    const svgPath = this.buildSVGPath(stroke)\n    const svgStroke = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\")\n    svgStroke.classList.add(\"erasing-stroke\")\n    svgStroke.setAttribute(\"id\", stroke.id as string)\n    const style = \"fill:grey;stroke:transparent;shadowBlur:5;opacity:0.2;\"\n    svgStroke.setAttribute(\"style\", style)\n    svgStroke.setAttribute(\"d\", `${svgPath}Z`)\n    svgElement.appendChild(svgStroke)\n  }\n}","import { TRenderingConfiguration } from \"../../@types/configuration/RenderingConfiguration\"\nimport { IModel } from \"../../@types/model/Model\"\nimport { TUpdatePatch, TUpdatePatchAppendChild, TUpdatePatchInsertBefore, TUpdatePatchRemoveAttribut, TUpdatePatchRemoveChild, TUpdatePatchRemoveElement, TUpdatePatchReplaceAll, TUpdatePatchReplaceELement, TUpdatePatchSetAttribut } from \"../../@types/recognizer/WSRecognizer\"\nimport { IRenderer, TSVGRendererContext } from \"../../@types/renderer/Renderer\"\nimport { TStroke } from \"../../@types/model/Stroke\"\nimport { SVGQuadraticStroker } from \"./SVGQuadraticStroker\"\n\nexport class SVGRenderer implements IRenderer\n{\n  config: TRenderingConfiguration\n  stroker: SVGQuadraticStroker\n  context!: TSVGRendererContext\n\n  constructor(config: TRenderingConfiguration)\n  {\n    this.config = config\n    this.stroker = new SVGQuadraticStroker()\n  }\n\n  init(element: HTMLElement): void\n  {\n    element.style.fontSize = \"10px\"\n    this.context = {\n      parent: element\n    }\n  }\n\n  #drawStroke(svgElement: SVGElement, stroke: TStroke)\n  {\n    if (stroke.pointerType === \"ERASER\") {\n      this.stroker.drawErasingStroke(svgElement, stroke)\n    } else {\n      this.stroker.drawStroke(svgElement, stroke)\n    }\n  }\n\n  #replaceAll(layerName: string, update: TUpdatePatchReplaceAll): void\n  {\n    const oldLayer = this.context.parent.querySelector(`svg[data-layer=\"${ layerName }\"]`) as SVGElement | null\n    oldLayer?.remove()\n    this.context.parent.insertAdjacentHTML(\"beforeend\", update.svg)\n    const layer = this.context.parent.querySelector(`svg[data-layer=\"${ layerName }\"]`) as SVGElement\n    if (layerName === \"MODEL\") {\n      const pendingStrokesGroup = document.createElementNS(\"http://www.w3.org/2000/svg\", \"g\")\n      pendingStrokesGroup.id = \"pendingStrokes\"\n      layer.appendChild(pendingStrokesGroup)\n    }\n  }\n\n  #replaceElement(update: TUpdatePatchReplaceELement): void\n  {\n    const elementToRemove = this.context.parent.querySelector(`#${ update.id }`) as HTMLElement | null\n    if (elementToRemove) {\n      const parent = elementToRemove.parentNode as HTMLElement | null | undefined\n      elementToRemove?.remove()\n      parent?.insertAdjacentHTML(\"beforeend\", update.svg)\n    }\n  }\n\n  #appendChild(layerName: string, update: TUpdatePatchAppendChild): void\n  {\n    const parentSelector = update.parentId ? `#${ update.parentId }` : `svg[data-layer=\"${ layerName }\"]`\n    const parent = this.context.parent.querySelector(parentSelector) as HTMLElement\n    parent?.insertAdjacentHTML(\"beforeend\", update.svg)\n  }\n\n  #removeChild(update: TUpdatePatchRemoveChild): void\n  {\n    this.context.parent.querySelector(`#${ update.parentId } > *:nth-child(${ update.index + 1 })`)?.remove()\n  }\n\n  #removeElement(update: TUpdatePatchRemoveElement): void\n  {\n    const elementToRemove = this.context.parent.querySelector(`#${ update.id }`)\n    if (elementToRemove) {\n      if (update.id.includes(\"s\") || update.id.includes(\"MODEL\")) {\n        elementToRemove.remove()\n      } else {\n        elementToRemove.setAttribute(\"class\", \"removed-stroke\")\n        setTimeout(() =>\n        {\n          elementToRemove?.remove()\n        }, 100)\n      }\n    }\n  }\n\n  #insertBefore(update: TUpdatePatchInsertBefore): void\n  {\n    const parent = this.context.parent.querySelector(`#${ update.refId }`) as HTMLElement | null\n    parent?.insertAdjacentHTML(\"beforebegin\", update.svg)\n  }\n\n  #setAttribute(update: TUpdatePatchSetAttribut): void\n  {\n    const selector = update.id ? `#${ update.id }` : \"svg\"\n    const element = this.context.parent.querySelector(selector) as HTMLElement | null\n    element?.setAttribute(update.name, update.value)\n  }\n\n  #removeAttribute(update: TUpdatePatchRemoveAttribut): void\n  {\n    const selector = update.id ? `#${ update.id }` : \"svg\"\n    const element = this.context.parent.querySelector(selector) as HTMLElement | null\n    element?.removeAttribute(update.name)\n  }\n\n  updateLayer(layerName: string, update: TUpdatePatch): void\n  {\n    switch (update.type) {\n      case \"REPLACE_ALL\":\n        this.#replaceAll(layerName, update as TUpdatePatchReplaceAll)\n        break\n      case \"REPLACE_ELEMENT\":\n        this.#replaceElement(update as TUpdatePatchReplaceELement)\n        break\n      case \"APPEND_CHILD\":\n        this.#appendChild(layerName, update as TUpdatePatchAppendChild)\n        break\n      case \"REMOVE_ELEMENT\":\n        this.#removeElement(update as TUpdatePatchRemoveElement)\n        break\n      case \"REMOVE_CHILD\":\n        this.#removeChild(update as TUpdatePatchRemoveChild)\n        break\n      case \"INSERT_BEFORE\":\n        this.#insertBefore(update as TUpdatePatchInsertBefore)\n        break\n      case \"SET_ATTRIBUTE\":\n        this.#setAttribute(update as TUpdatePatchSetAttribut)\n        break\n      case \"REMOVE_ATTRIBUTE\":\n        this.#removeAttribute(update as TUpdatePatchRemoveAttribut)\n        break\n      default:\n        break\n    }\n  }\n\n  updatesLayer(layerName: string, updates: TUpdatePatch[]): void\n  {\n    updates.forEach(u => this.updateLayer(layerName, u))\n  }\n\n  clearPendingStroke(): void\n  {\n    const pendingStrokeGroup = this.context.parent.querySelector(\"#pendingStrokes\") as SVGElement\n    if (pendingStrokeGroup) {\n      pendingStrokeGroup.innerHTML = \"\"\n    }\n  }\n\n  drawPendingStroke(stroke: TStroke): void\n  {\n    if (stroke) {\n      const pendingStrokeGroup = this.context.parent.querySelector(\"#pendingStrokes\") as SVGElement\n      if (pendingStrokeGroup) {\n        const oldStroke = pendingStrokeGroup.querySelector(`#${ stroke?.id }`)\n        if (oldStroke) {\n          oldStroke.remove()\n        }\n        this.#drawStroke(pendingStrokeGroup, stroke)\n      }\n    }\n  }\n\n  resize(model: IModel): void\n  {\n    const rect = this.context.parent.getBoundingClientRect()\n    const svgList = this.context.parent.querySelectorAll(\"svg\")\n    const width = Math.max(rect.width, model.width)\n    const height = Math.max(rect.height, model.height)\n    svgList.forEach(svg =>\n    {\n      svg.setAttribute(\"viewBox\", `0 0 ${ width }, ${ height }`)\n      svg.setAttribute(\"width\", `${ width }px`)\n      svg.setAttribute(\"height\", `${ height }px`)\n    })\n  }\n\n  destroy(): void\n  {\n    if (this.context.parent) {\n      this.context.parent.innerHTML = \"\"\n    }\n  }\n}","import { IBehaviors } from \"../@types/Behaviors\"\nimport { TConfiguration } from \"../@types/Configuration\"\nimport { IModel, TExport } from \"../@types/model/Model\"\n\nimport { PointerEventGrabber } from \"../grabber/PointerEventGrabber\"\nimport { WSRecognizer } from \"../recognizer/WSRecognizer\"\nimport { TWebSocketExportEvent, TWebSocketSVGPatchEvent } from \"../@types/recognizer/WSRecognizer\"\nimport { DeferredPromise } from \"../utils/DeferredPromise\"\nimport { GlobalEvent } from \"../event/GlobalEvent\"\nimport { SVGRenderer } from \"../renderer/svg/SVGRenderer\"\nimport { UndoRedoManager } from \"../undo-redo/UndoRedoManager\"\nimport { TStroke } from \"../@types/model/Stroke\"\nimport { TTriggerConfiguration } from \"../@types/configuration/TriggerConfiguration\"\nimport { WSMessage } from \"../Constants\"\nimport { TConverstionState } from \"../@types/configuration/RecognitionConfiguration\"\nimport { TTheme } from \"../@types/style/Theme\"\nimport { TPenStyle } from \"../@types/style/PenStyle\"\n\nexport class WSBehaviors implements IBehaviors\n{\n  grabber: PointerEventGrabber\n  renderer: SVGRenderer\n  recognizer: WSRecognizer\n  undoRedoManager: UndoRedoManager\n  initialized: DeferredPromise<void>\n\n  #triggerConfiguration: TTriggerConfiguration\n  #exportTimer?: ReturnType<typeof setTimeout>\n  #resizeTimer?: ReturnType<typeof setTimeout>\n  #exportDeffered?: DeferredPromise<TExport>\n  #convertDeffered?: DeferredPromise<TExport>\n  #addStrokeDeffered?: DeferredPromise<TExport>\n  #importDeffered?: DeferredPromise<TExport>\n  #resizeDeffered?: DeferredPromise<void>\n  #undoDeffered?: DeferredPromise<void>\n  #redoDeffered?: DeferredPromise<void>\n  #clearDeffered?: DeferredPromise<void>\n\n  constructor(configuration: TConfiguration, model: IModel)\n  {\n    this.grabber = new PointerEventGrabber(configuration.grabber)\n    this.renderer = new SVGRenderer(configuration.rendering)\n    this.recognizer = new WSRecognizer(configuration.server, configuration.recognition)\n    this.undoRedoManager = new UndoRedoManager(configuration[\"undo-redo\"], model.getClone())\n    this.#triggerConfiguration = configuration.triggers\n    this.initialized = new DeferredPromise<void>()\n  }\n\n  get globalEvent(): GlobalEvent\n  {\n    return GlobalEvent.getInstance()\n  }\n\n  init(domElement: HTMLElement): Promise<void>\n  {\n    const model = this.undoRedoManager.getLastModel()\n    this.grabber.attach(domElement)\n    this.renderer.init(domElement)\n    this.recognizer.init(model.height, model.width)\n\n    this.recognizer.wsEvent.addConnectionActiveListener(this.onConnectionActive)\n    // this.recognizer.wsEvent.addPartChangeListener(this.onPartChange)\n    this.recognizer.wsEvent.addContentChangeListener(this.onContentChange)\n    this.recognizer.wsEvent.addSVGPatchListener(this.onSVGPatch)\n    this.recognizer.wsEvent.addExportListener(this.onExport)\n    this.recognizer.wsEvent.addDisconnectedListener(this.onDisconnected)\n    this.recognizer.wsEvent.addErrorListener(this.onError)\n\n    return this.initialized.promise\n  }\n\n  private onConnectionActive = () =>\n  {\n    this.initialized.resolve()\n  }\n\n  // private onPartChange = (evt: TWebSocketPartChangeEvent) =>\n  // {\n  //   console.log('onPartChange evt:', evt)\n  // }\n\n  // private onContentChange = (evt: TWebSocketContentChangeEvent) =>\n  private onContentChange = () =>\n  {\n    this.#resizeDeffered?.resolve()\n    this.#undoDeffered?.resolve()\n    this.#redoDeffered?.resolve()\n    this.#clearDeffered?.resolve()\n  }\n\n  private onSVGPatch = (evt: TWebSocketSVGPatchEvent) =>\n  {\n    // TODO analyse if required ...\n    // if (evt.updates.length) {\n    //   if (model.recognizedSymbols) {\n    //     model.recognizedSymbols.push(res)\n    //   } else {\n    //     model.recognizedSymbols = [res]\n    //   }\n    // }\n    this.renderer.updatesLayer(evt.layer, evt.updates)\n  }\n\n  private onError = (err: Error) =>\n  {\n    if (this.initialized.isPending) {\n      this.initialized.reject(err)\n    }\n    this.globalEvent.emitError(err)\n  }\n\n  private onExport = (exportMessage: TWebSocketExportEvent) =>\n  {\n    this.#importDeffered?.resolve(exportMessage.exports)\n    this.#addStrokeDeffered?.resolve(exportMessage.exports)\n    this.#exportDeffered?.resolve(exportMessage.exports)\n    this.#convertDeffered?.resolve(exportMessage.exports)\n\n    clearTimeout(this.#exportTimer)\n    this.#exportTimer = setTimeout(async () =>\n    {\n      this.globalEvent.emitExported(exportMessage.exports)\n    }, this.#triggerConfiguration.exportContentDelay)\n  }\n\n  private onDisconnected = (event: CloseEvent) =>\n  {\n    const err = new Error(event.reason)\n    err.name = event.code.toString()\n    if (this.initialized.isPending) {\n      if (event.code === 1000) {\n        this.initialized.resolve()\n      } else {\n        this.initialized.reject(err)\n      }\n    }\n    if (this.#addStrokeDeffered?.isPending) {\n      this.#addStrokeDeffered?.reject(err)\n    }\n    if (this.#exportDeffered?.isPending) {\n      this.#exportDeffered?.reject(err)\n    }\n    if (this.#convertDeffered?.isPending) {\n      this.#convertDeffered?.reject(err)\n    }\n    if (this.#importDeffered?.isPending) {\n      this.#importDeffered?.reject(err)\n    }\n    if (this.#resizeDeffered?.isPending) {\n      this.#resizeDeffered?.reject(err)\n    }\n    if (this.#undoDeffered?.isPending) {\n      this.#undoDeffered?.reject(err)\n    }\n    if (this.#redoDeffered?.isPending) {\n      this.#redoDeffered?.reject(err)\n    }\n    if (this.#clearDeffered?.isPending) {\n      this.#clearDeffered?.reject(err)\n    }\n  }\n\n  setPenStyle(penStyle: TPenStyle): void\n  {\n    this.recognizer.setPenStyle(penStyle)\n  }\n\n  setPenStyleClasses(penStyleClasses: string): void\n  {\n    this.recognizer.setPenStyleClasses(penStyleClasses)\n  }\n\n  setTheme(theme: TTheme): void\n  {\n    this.recognizer.setTheme(theme)\n  }\n\n  drawCurrentStroke(model: IModel): void\n  {\n    const currentStroke = model.currentStroke as TStroke\n    if (currentStroke) {\n      currentStroke.id = `pendingStroke-${ model.rawStrokes.length }`\n      this.renderer.drawPendingStroke(currentStroke)\n    }\n  }\n\n  async updateModelRendering(model: IModel): Promise<IModel | never>\n  {\n    await this.initialized.promise\n    model.updatePositionSent()\n    this.undoRedoManager.addModelToStack(model)\n    this.#addStrokeDeffered = new DeferredPromise<TExport>()\n    this.recognizer.addStrokes(model)\n\n    const exports: TExport = await this.#addStrokeDeffered.promise\n    model.updatePositionReceived()\n    if (model.exports) {\n      Object.assign(model.exports, exports)\n    } else {\n      model.exports = exports\n    }\n    this.undoRedoManager.updateModelInStack(model)\n    this.renderer.clearPendingStroke()\n    this.#addStrokeDeffered = undefined\n    return model\n  }\n\n  async export(model: IModel, mimeTypes?: string[]): Promise<IModel | never>\n  {\n    await this.initialized.promise\n    this.undoRedoManager.addModelToStack(model)\n    this.#exportDeffered = new DeferredPromise<TExport>()\n    await this.recognizer.export(model, mimeTypes)\n\n    const exports: TExport = await this.#exportDeffered.promise\n\n    model.updatePositionReceived()\n    if (model.exports) {\n      Object.assign(model.exports, exports)\n    } else {\n      model.exports = exports\n    }\n\n    this.undoRedoManager.updateModelInStack(model)\n    this.#exportDeffered = undefined\n    return model\n  }\n\n  async convert(model: IModel, conversionState?: TConverstionState): Promise<IModel | never>\n  {\n    await this.initialized.promise\n    this.undoRedoManager.addModelToStack(model)\n    this.#convertDeffered = new DeferredPromise<TExport>()\n    this.recognizer.convert(conversionState)\n\n    const myExportConverted: TExport = await this.#convertDeffered.promise\n    model.updatePositionReceived()\n    if (model.converts) {\n      Object.assign(model.converts, myExportConverted)\n    } else {\n      model.converts = myExportConverted\n    }\n    this.undoRedoManager.updateModelInStack(model)\n    this.#convertDeffered = undefined\n    return model\n  }\n\n  async import(model: IModel, data: Blob, mimeType?: string): Promise<IModel | never>\n  {\n    await this.initialized.promise\n    this.undoRedoManager.addModelToStack(model)\n    this.#importDeffered = new DeferredPromise<TExport>()\n    this.recognizer.import(data, mimeType)\n\n    const myImportExport: TExport = await this.#importDeffered.promise\n    model.updatePositionReceived()\n    if (model.exports) {\n      Object.assign(model.exports, myImportExport)\n    } else {\n      model.exports = myImportExport\n    }\n    this.undoRedoManager.updateModelInStack(model)\n    this.#importDeffered = undefined\n    return model\n  }\n\n  async resize(model: IModel): Promise<IModel>\n  {\n    await this.initialized.promise\n    this.renderer.resize(model)\n    this.#resizeDeffered = new DeferredPromise<void>()\n    clearTimeout(this.#resizeTimer)\n    this.#resizeTimer = setTimeout(async () =>\n    {\n      this.recognizer.resize(model)\n    }, this.#triggerConfiguration.resizeTriggerDelay)\n    await this.#resizeDeffered.promise\n    this.#resizeDeffered = undefined\n    return model\n  }\n\n  async undo(): Promise<IModel>\n  {\n    await this.initialized.promise\n    this.#undoDeffered = new DeferredPromise<void>()\n    this.recognizer.undo()\n    await this.#undoDeffered.promise\n    this.#undoDeffered = undefined\n    return this.undoRedoManager.undo()\n  }\n\n  async redo(): Promise<IModel>\n  {\n    await this.initialized.promise\n    this.#redoDeffered = new DeferredPromise<void>()\n    this.recognizer.redo()\n    await this.#redoDeffered.promise\n    this.#redoDeffered = undefined\n    return this.undoRedoManager.redo()\n  }\n\n  async clear(model: IModel): Promise<IModel>\n  {\n    await this.initialized.promise\n    this.#clearDeffered = new DeferredPromise<void>()\n    this.recognizer.clear()\n    const myModel = model.getClone()\n    myModel.clear()\n    this.undoRedoManager.addModelToStack(myModel)\n    await this.#clearDeffered?.promise\n    this.#clearDeffered = undefined\n    return myModel\n  }\n\n  async destroy(): Promise<void>\n  {\n    this.grabber.detach()\n    this.renderer.destroy()\n    this.recognizer.close(1000, WSMessage.CLOSE_RECOGNIZER)\n    // this.undoRedoManager.reset(model)\n    return Promise.resolve()\n  }\n}\n","import { IBehaviors } from \"../@types/Behaviors\"\nimport { TConfiguration } from \"../@types/Configuration\"\nimport { IModel } from \"../@types/model/Model\"\nimport { RestBehaviors } from \"./RestBehaviors\"\nimport { WSBehaviors } from \"./WSBehaviors\"\n\nexport class BehaviorsManager\n{\n  behaviors!: IBehaviors\n\n  constructor(configuration: TConfiguration, model: IModel, behaviors?: IBehaviors)\n  {\n    this.overrideDefaultBehaviors(configuration, model, behaviors)\n  }\n\n  overrideDefaultBehaviors(configuration: TConfiguration, model: IModel, behaviors?: IBehaviors)\n  {\n    if (this.behaviors) {\n      this.behaviors.destroy(model)\n    }\n    let defaultBehaviors: IBehaviors\n    if (configuration.server.protocol === \"REST\") {\n      defaultBehaviors = new RestBehaviors(configuration, model)\n    } else {\n      defaultBehaviors = new WSBehaviors(configuration, model)\n    }\n\n    this.behaviors = Object.assign(defaultBehaviors, behaviors)\n  }\n\n  init(domElement: HTMLElement): Promise<void | Error>\n  {\n    return this.behaviors.init(domElement)\n  }\n\n}","import { TConfiguration } from \"../@types/Configuration\"\nimport { TGrabberConfiguration } from \"../@types/configuration/GrabberConfiguration\"\nimport { TRenderingConfiguration } from \"../@types/configuration/RenderingConfiguration\"\nimport { TServerConfiguration } from \"../@types/configuration/ServerConfiguration\"\nimport { TRecognitionConfiguration } from \"../@types/configuration/RecognitionConfiguration\"\nimport { TTriggerConfiguration } from \"../@types/configuration/TriggerConfiguration\"\nimport { TEventConfiguration } from \"../@types/configuration/EventConfiguration\"\nimport { TUndoRedoConfiguration } from \"../@types/configuration/UndoRedoConfiguration\"\n\nexport const DefaultServerConfiguration: TServerConfiguration = {\n  protocol: \"WEBSOCKET\",\n  scheme: \"https\",\n  host: \"webdemoapi.myscript.com\",\n  applicationKey: \"\",\n  hmacKey: \"\",\n  useWindowLocation: false,\n  websocket: {\n    pingEnabled: true,\n    pingDelay: 30000,\n    maxPingLostCount: 10,\n    autoReconnect: true,\n    maxRetryCount: 2,\n    fileChunkSize: 300000\n  }\n}\n\nexport const DefaultRecognitionConfiguration: TRecognitionConfiguration = {\n  type: \"TEXT\",\n  alwaysConnected: true,\n  lang: \"en_US\",\n  gesture: {\n    enable: true\n  },\n  export: {\n    \"image-resolution\": 300,\n    jiix: {\n      \"bounding-box\": false,\n      strokes: false,\n      text: {\n        chars: false,\n        words: true\n      }\n    },\n  },\n  renderer: {\n    debug: {\n      \"draw-text-boxes\": false,\n      \"draw-image-boxes\": false\n    }\n  },\n  math: {\n    mimeTypes: [\"application/x-latex\"], // \"application/mathml+xml\", \"application/vnd.myscript.jiix\",\n    solver: {\n      enable: true,\n      \"fractional-part-digits\": 3,\n      \"decimal-separator\": \".\",\n      \"rounding-mode\": \"half up\",\n      \"angle-unit\": \"deg\"\n    },\n    margin: {\n      bottom: 10,\n      left: 15,\n      right: 15,\n      top: 10\n    },\n    eraser: {\n      \"erase-precisely\": false\n    },\n    \"undo-redo\": {\n      mode: \"stroke\"\n    }\n  },\n  text: {\n    guides: {\n      enable: true\n    },\n    mimeTypes: [\"application/vnd.myscript.jiix\"], // \"text/plain\"\n    margin: {\n      top: 20,\n      left: 10,\n      right: 10,\n      bottom: 10\n    },\n    eraser: {\n      \"erase-precisely\": false\n    }\n  },\n  diagram: {\n    mimeTypes: [\"application/vnd.myscript.jiix\"], // \"application/vnd.openxmlformats-officedocument.presentationml.presentation\"\n    eraser: {\n      \"erase-precisely\": false\n    }\n  },\n  \"raw-content\": {\n    recognition: {\n      text: true,\n      shape: false\n    },\n    eraser: {\n      \"erase-precisely\": false\n    }\n  }\n}\n\nexport const DefaultGrabberConfiguration: TGrabberConfiguration = {\n  listenerOptions: {\n    capture: false,\n    passive: true\n  },\n  xyFloatPrecision: 0,\n  timestampFloatPrecision: 0\n}\n\nexport const DefaultRenderingConfiguration: TRenderingConfiguration = {\n  minHeight: 100,\n  minWidth: 100,\n  smartGuide: {\n    enable: true,\n    fadeOut: {\n      enable: true,\n      duration: 5000\n    }\n  }\n}\n\nexport const DefaultTriggerConfiguration: TTriggerConfiguration = {\n  exportContent: \"POINTER_UP\",\n  exportContentDelay: 1000,\n  resizeTriggerDelay: 100\n}\n\nexport const DefaultEventsConfiguration: TEventConfiguration = {\n  processDelay: 10\n}\n\nexport const DefaultUndoRedoConfiguration: TUndoRedoConfiguration = {\n  maxStackSize: 10\n}\n\nexport const DefaultConfiguration: TConfiguration = {\n  server: DefaultServerConfiguration,\n  recognition: DefaultRecognitionConfiguration,\n  grabber: DefaultGrabberConfiguration,\n  rendering: DefaultRenderingConfiguration,\n  triggers: DefaultTriggerConfiguration,\n  events: DefaultEventsConfiguration,\n  \"undo-redo\": DefaultUndoRedoConfiguration\n}\n","\nimport { TConfiguration, TConfigurationClient } from \"../@types/Configuration\"\nimport { TEventConfiguration } from \"../@types/configuration/EventConfiguration\"\nimport { TGrabberConfiguration } from \"../@types/configuration/GrabberConfiguration\"\nimport { TRecognitionConfiguration } from \"../@types/configuration/RecognitionConfiguration\"\nimport { TRenderingConfiguration } from \"../@types/configuration/RenderingConfiguration\"\nimport { TServerConfiguration } from \"../@types/configuration/ServerConfiguration\"\nimport { TTriggerConfiguration } from \"../@types/configuration/TriggerConfiguration\"\nimport { TUndoRedoConfiguration } from \"../@types/configuration/UndoRedoConfiguration\"\nimport { DefaultConfiguration } from \"./DefaultConfiguration\"\n\nexport class Configuration implements TConfiguration\n{\n  events: TEventConfiguration\n  grabber: TGrabberConfiguration\n  recognition: TRecognitionConfiguration\n  rendering: TRenderingConfiguration\n  server: TServerConfiguration\n  triggers: TTriggerConfiguration\n  \"undo-redo\": TUndoRedoConfiguration\n\n  constructor(configuration?: TConfigurationClient)\n  {\n    this.events = JSON.parse(JSON.stringify(DefaultConfiguration.events))\n    this.grabber = JSON.parse(JSON.stringify(DefaultConfiguration.grabber))\n    this.recognition = JSON.parse(JSON.stringify(DefaultConfiguration.recognition))\n    this.rendering = JSON.parse(JSON.stringify(DefaultConfiguration.rendering))\n    this.server = JSON.parse(JSON.stringify(DefaultConfiguration.server))\n    this.triggers = JSON.parse(JSON.stringify(DefaultConfiguration.triggers))\n\n    this.overrideDefaultConfiguration(configuration)\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  mergeDeep(target: any, ...sources: any[]): any\n  {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const isObject = (item: any) =>\n    {\n      return (item && typeof item === \"object\" && !Array.isArray(item))\n    }\n    if (!sources.length) return target\n    const source = sources.shift()\n\n    if (isObject(target) && isObject(source)) {\n      for (const key in source) {\n        if (isObject(source[key])) {\n          if (!target[key]) {\n            Object.assign(target, { [key]: {} })\n          }\n          this.mergeDeep(target[key], source[key])\n        } else {\n          Object.assign(target, { [key]: source[key] })\n        }\n      }\n    }\n\n    return this.mergeDeep(target, ...sources)\n  }\n\n  overrideDefaultConfiguration(configuration?: TConfigurationClient): void\n  {\n    const defaultConf = JSON.parse(JSON.stringify(DefaultConfiguration))\n    this.events = this.mergeDeep({}, defaultConf.events, configuration?.events)\n    this.grabber = this.mergeDeep({}, defaultConf.grabber, configuration?.grabber)\n    this.recognition = this.mergeDeep({}, defaultConf.recognition, configuration?.recognition)\n    this.rendering = this.mergeDeep({}, defaultConf.rendering, configuration?.rendering)\n    this.server = this.mergeDeep({}, defaultConf.server, configuration?.server)\n    this.triggers = this.mergeDeep({}, defaultConf.triggers, configuration?.triggers)\n    this[\"undo-redo\"] = this.mergeDeep({}, defaultConf[\"undo-redo\"], configuration?.[\"undo-redo\"])\n\n    this.recognition.text.mimeTypes = configuration?.recognition?.text?.mimeTypes || defaultConf.recognition.text.mimeTypes\n    this.recognition.math.mimeTypes = configuration?.recognition?.math?.mimeTypes || defaultConf.recognition.math.mimeTypes\n    this.recognition.diagram.mimeTypes = configuration?.recognition?.diagram?.mimeTypes || defaultConf.recognition.diagram.mimeTypes\n\n    if (this.server?.useWindowLocation) {\n      this.server.scheme = window.location.protocol.indexOf(\"s\") > -1 ? \"https\" : \"http\"\n      this.server.host = window.location.host\n    }\n\n    if (\n      this.server.protocol === \"REST\" &&\n      this.triggers.exportContent === \"POINTER_UP\"\n    ) {\n      this.triggers.exportContent = \"QUIET_PERIOD\"\n      this.triggers.exportContentDelay = Math.max(this.triggers.exportContentDelay, 50)\n    }\n\n    if (\n      this.server.protocol === \"WEBSOCKET\" &&\n      this.recognition.type === \"TEXT\"\n    ) {\n      if (\n        this.rendering.smartGuide.enable &&\n        !this.recognition.text.mimeTypes.includes(\"application/vnd.myscript.jiix\")\n      ) {\n        // mimeType required for smartGuide\n        this.recognition.text.mimeTypes.push(\"application/vnd.myscript.jiix\")\n      }\n    } else {\n      // smartGuide enable only on websocket text\n      this.rendering.smartGuide.enable = false\n    }\n  }\n}\n","import { TPenStyle } from \"../@types/style/PenStyle\"\nimport { TStroke } from \"../@types/model/Stroke\"\n\nexport class Stroke implements TStroke\n{\n  type: string\n  pointerId: number\n  pointerType: string\n  elementType?: string\n  x: number[]\n  y: number[]\n  t: number[]\n  p: number[]\n  l: number[]\n  color: string\n  width: number\n  \"-myscript-pen-width\": number\n  \"-myscript-pen-fill-style\": string\n  \"-myscript-pen-fill-color\": string\n\n  constructor(style: TPenStyle, pointerId: number, pointerType = \"pen\")\n  {\n    this.type = \"stroke\"\n    this.pointerId = pointerId\n    this.pointerType = pointerType\n    this.x = []\n    this.y = []\n    this.t = []\n    this.p = []\n    this.l = []\n    this.color = style.color as string\n    this.width = style.width as number\n    this[\"-myscript-pen-width\"] = style[\"-myscript-pen-width\"] as number\n    this[\"-myscript-pen-fill-style\"] = style[\"-myscript-pen-fill-style\"] as string\n    this[\"-myscript-pen-fill-color\"] = style[\"-myscript-pen-fill-color\"] as string\n  }\n}","import { TPenStyle } from \"../@types/style/PenStyle\"\nimport { TPoint } from \"../@types/renderer/Point\"\nimport { TStroke, TStrokeGroup } from \"../@types/model/Stroke\"\nimport { IModel, TExport } from \"../@types/model/Model\"\nimport { TRecognitionPositions } from \"../@types/model/RecognitionPositions\"\nimport { Stroke } from \"./Stroke\"\nimport { TUpdatePatch } from \"../@types/recognizer/WSRecognizer\"\n\nexport class Model implements IModel\n{\n  readonly creationTime: number\n  modificationDate: number\n  currentStroke?: TStroke\n  strokeGroups: TStrokeGroup[]\n  positions: TRecognitionPositions\n  defaultSymbols: TStroke[]\n  rawStrokes: TStroke[]\n  recognizedSymbols?: TUpdatePatch[]\n  exports?: TExport\n  converts?: TExport\n  width: number\n  height: number\n  idle: boolean\n  isEmpty: boolean\n\n  constructor(width: number, height: number, creationDate: number = new Date().getTime())\n  {\n    this.rawStrokes = []\n    this.strokeGroups = []\n    this.positions = {\n      lastSentPosition: -1,\n      lastReceivedPosition: -1,\n      lastRenderedPosition: -1\n    }\n    this.defaultSymbols = []\n    this.creationTime = creationDate\n    this.modificationDate = creationDate\n    this.width = width\n    this.height = height\n    this.idle = true\n    this.isEmpty = true\n  }\n\n  private computeDistance (point1: TPoint, point2: TPoint): number {\n    const distance = Math.sqrt(Math.pow((point1.y - point2.y), 2) + Math.pow((point1.x - point2.x), 2))\n    return isNaN(distance) ? 0 : distance\n  }\n\n  private computeLength (point1: TPoint, point2: TPoint, lastDistance: number): number {\n    const length = lastDistance + this.computeDistance(point1, point2)\n    return isNaN(length) ? 0 : length\n  }\n\n  private computePressure (point1: TPoint, point2: TPoint, lastDistance: number): number {\n    let ratio = 1.0\n    const distance = this.computeDistance(point1, point2)\n    const length = this.computeLength(point1, point2, lastDistance)\n\n    if (length === 0) {\n      ratio = 0.5\n    } else if (distance === length) {\n      ratio = 1.0\n    } else if (distance < 10) {\n      ratio = 0.2 + Math.pow(0.1 * distance, 0.4)\n    } else if (distance > length - 10) {\n      ratio = 0.2 + Math.pow(0.1 * (length - distance), 0.4)\n    }\n    const pressure = ratio * Math.max(0.1, 1.0 - (0.1 * Math.sqrt(distance)))\n    return isNaN(pressure) ? 0.5 : Math.round(pressure * 100) / 100\n  }\n\n  private filterPointByAcquisitionDelta(stroke: TStroke, point: TPoint): boolean\n  {\n    const delta: number = (2 + ((stroke[\"-myscript-pen-width\"] || 0) / 4))\n    return stroke.x.length === 0 || stroke.y.length === 0 ||\n      Math.abs(stroke.x[stroke.x.length - 1] - point.x) >= delta ||\n      Math.abs(stroke.y[stroke.y.length - 1] - point.y) >= delta\n  }\n\n  addPoint(stroke: TStroke, point: TPoint): void\n  {\n    if (this.filterPointByAcquisitionDelta(stroke, point)) {\n      const lastPoint: TPoint = {\n        x: stroke.x[stroke.x.length -1],\n        y: stroke.y[stroke.y.length -1],\n        p: stroke.p[stroke.p.length -1],\n        t: stroke.t[stroke.t.length -1],\n      }\n      const lastDistance: number = stroke.l[stroke.l.length - 1]\n      stroke.x.push(point.x)\n      stroke.y.push(point.y)\n      stroke.t.push(point.t)\n      stroke.p.push(this.computePressure(point, lastPoint, lastDistance))\n      stroke.l.push(this.computeLength(point, lastPoint, lastDistance))\n    }\n  }\n\n  addStroke(stroke: TStroke): void\n  {\n    this.rawStrokes.push(stroke)\n  }\n\n  extractPendingStrokes(position: number = this.positions.lastReceivedPosition + 1): TStroke[]\n  {\n    return this.rawStrokes.slice(position)\n  }\n\n  addStrokeToGroup(stroke: TStroke, strokePenStyle: TPenStyle): void\n  {\n    const lastGroup = this.strokeGroups.length - 1\n\n    const isPenStyleEqual = (ps1: TPenStyle, ps2: TPenStyle) => {\n      return ps1[\"-myscript-pen-fill-color\"] === ps2[\"-myscript-pen-fill-color\"] &&\n        ps1[\"-myscript-pen-fill-style\"] === ps2[\"-myscript-pen-fill-style\"] &&\n        ps1[\"-myscript-pen-width\"] === ps2[\"-myscript-pen-width\"] &&\n        ps1.color === ps2.color &&\n        ps1.width === ps2.width\n    }\n\n    if (this.strokeGroups[lastGroup] && isPenStyleEqual(this.strokeGroups[lastGroup].penStyle, strokePenStyle)) {\n      this.strokeGroups[lastGroup].strokes.push(stroke)\n    } else {\n      const newStrokeGroup: TStrokeGroup = {\n        penStyle: strokePenStyle,\n        strokes: [stroke]\n      }\n      this.strokeGroups.push(newStrokeGroup)\n    }\n    this.isEmpty = false\n  }\n\n  initCurrentStroke(point: TPoint, pointerId: number, pointerType: string, style: TPenStyle, dpi = 96): void\n  {\n    if (style[\"-myscript-pen-width\"]) {\n      const pxWidth = (style[\"-myscript-pen-width\"] * dpi) / 25.4\n      style.width = pxWidth / 2\n    }\n    this.modificationDate = new Date().getTime()\n    this.exports = undefined\n    this.converts = undefined\n    this.currentStroke = new Stroke(style, pointerId, pointerType)\n    this.addPoint(this.currentStroke, point)\n  }\n\n  appendToCurrentStroke(point: TPoint): void\n  {\n    if (this.currentStroke) {\n      this.addPoint(this.currentStroke, point)\n    }\n  }\n\n  endCurrentStroke(point: TPoint, penStyle: TPenStyle): void\n  {\n    if (this.currentStroke) {\n      this.addPoint(this.currentStroke, point)\n      // Mutating pending strokes\n      this.addStroke(this.currentStroke)\n      this.addStrokeToGroup(this.currentStroke, penStyle)\n      // Resetting the current stroke to an undefined one\n      this.currentStroke = undefined\n    }\n  }\n\n  extractPendingRecognizedSymbols (position: number = this.positions.lastRenderedPosition + 1): TUpdatePatch[]\n  {\n    return this.recognizedSymbols ? this.recognizedSymbols.slice(position) : []\n  }\n\n  updatePositionSent(position: number = this.rawStrokes.length - 1): void\n  {\n    this.positions.lastSentPosition = position\n  }\n\n  updatePositionReceived(): void\n  {\n    this.positions.lastReceivedPosition = this.positions.lastSentPosition\n  }\n\n  updatePositionRendered(position: number = this.recognizedSymbols ? this.recognizedSymbols.length - 1 : -1): void\n  {\n    this.positions.lastRenderedPosition = position\n  }\n\n  resetPositionRenderer(): void\n  {\n    this.positions.lastRenderedPosition = -1\n  }\n\n  resetPositions(): void\n  {\n    this.positions.lastSentPosition = -1\n    this.positions.lastReceivedPosition = -1\n  }\n\n  getClone(): IModel\n  {\n    const clonedModel = new Model(this.width, this.height, this.creationTime)\n    clonedModel.modificationDate = JSON.parse(JSON.stringify(this.modificationDate))\n    clonedModel.defaultSymbols = JSON.parse(JSON.stringify(this.defaultSymbols))\n    clonedModel.currentStroke = this.currentStroke ? JSON.parse(JSON.stringify(this.currentStroke)) : undefined\n    clonedModel.rawStrokes = JSON.parse(JSON.stringify(this.rawStrokes))\n    clonedModel.strokeGroups = JSON.parse(JSON.stringify(this.strokeGroups))\n    clonedModel.positions = JSON.parse(JSON.stringify(this.positions))\n    clonedModel.exports = this.exports ? JSON.parse(JSON.stringify(this.exports)) : undefined\n    clonedModel.converts = this.converts ? JSON.parse(JSON.stringify(this.converts)) : undefined\n    clonedModel.recognizedSymbols = this.recognizedSymbols ? JSON.parse(JSON.stringify(this.recognizedSymbols)) : undefined\n    clonedModel.idle = this.idle\n    clonedModel.isEmpty = this.isEmpty\n    return clonedModel\n  }\n\n  clear(): void\n  {\n    this.modificationDate = new Date().getTime()\n    this.currentStroke = undefined\n    this.rawStrokes = []\n    this.strokeGroups = []\n    this.positions.lastSentPosition = -1\n    this.positions.lastReceivedPosition = -1\n    this.positions.lastRenderedPosition = -1\n    this.recognizedSymbols = undefined\n    this.exports = undefined\n    this.converts = undefined\n    this.idle = true\n    this.isEmpty = true\n  }\n}\n","import { TPenStyle } from \"../@types/style/PenStyle\"\n\nexport const DefaultPenStyle: TPenStyle = {}","import { TTheme } from \"../@types/style/Theme\"\n\nexport const DefaultTheme: TTheme = {\n  ink: {\n    color: \"#000000\",\n    width: 1,\n    \"-myscript-pen-width\": 1,\n    \"-myscript-pen-fill-style\": \"none\",\n    \"-myscript-pen-fill-color\": \"#FFFFFF00\"\n  },\n  \".math\": {\n    \"font-family\": \"STIXGeneral\"\n  },\n  \".math-solved\": {\n    \"font-family\": \"STIXGeneral\",\n    color: \"#A8A8A8FF\"\n  },\n  \".text\": {\n    \"font-family\": \"MyScriptInter\",\n    \"font-size\": 10\n  }\n}\n","import { TPenStyle } from \"../@types/style/PenStyle\"\nimport { TTheme } from \"../@types/style/Theme\"\nimport { DefaultPenStyle } from \"./DefaultPenStyle\"\n\nimport { DefaultTheme } from \"./DefaultTheme\"\n\nexport class StyleManager\n{\n  #penStyle!: TPenStyle\n  #theme!: TTheme\n  penStyleClasses: string\n\n  get penStyle(): TPenStyle {\n    return this.#penStyle\n  }\n  get theme(): TTheme {\n    return this.#theme\n  }\n\n  constructor(penStyle?: TPenStyle, theme?: TTheme)\n  {\n    this.penStyleClasses = \"\"\n    this.overrideDefaultPenStyle(penStyle)\n    this.overrideDefaultTheme(theme)\n  }\n\n  overrideDefaultPenStyle(penStyle?: TPenStyle): void\n  {\n    this.#penStyle = Object.assign({}, DefaultPenStyle, penStyle || {}) as TPenStyle\n  }\n\n  overrideDefaultTheme(theme?: TTheme): void\n  {\n    this.#theme = Object.assign({}, DefaultTheme, theme || {}) as TTheme\n  }\n}","import { TMarginConfiguration } from \"../@types/configuration/recognition/MarginConfiguration\"\nimport { TRenderingConfiguration } from \"../@types/configuration/RenderingConfiguration\"\nimport { TJIIXExport, TWordExport } from \"../@types/model/Model\"\nimport { Exports } from \"../Constants\"\nimport { GlobalEvent } from \"../event/GlobalEvent\"\n\nexport class SmartGuide\n{\n  uuid: string\n  #smartGuideElement!: HTMLDivElement\n  #prompterContainerElement!: HTMLDivElement\n  #prompterTextElement!: HTMLDivElement\n  #ellipsisElement!: HTMLDivElement\n  #tagElement!: HTMLDivElement\n  #candidatesElement!: HTMLDivElement\n  #menuElement!: HTMLDivElement\n  #convertElement!: HTMLButtonElement\n  #copyElement!: HTMLButtonElement\n  #deleteElement!: HTMLButtonElement\n  #fadeOutTimout?: ReturnType<typeof setTimeout>\n  #isMenuOpen!: boolean\n  margin: TMarginConfiguration\n  renderingConfiguration!: TRenderingConfiguration\n  jiix?: TJIIXExport\n  lastWord?: TWordExport\n  wordToChange?: TWordExport\n\n  constructor()\n  {\n    this.uuid = Math.random().toString(10).substring(2, 12)\n    this.margin = {\n      bottom: 0,\n      left: 0,\n      right: 0,\n      top: 0\n    }\n    this.#createWrapperElement()\n    this.#createPrompterContainerElement()\n    this.#createPrompterTextElement()\n    this.#createEllipsisElement()\n    this.#createTagElement()\n    this.#createCandidatesElement()\n    this.#createMoreMenuElement()\n    this.#createConvertElement()\n    this.#createCopyElement()\n    this.#createDeleteElement()\n  }\n\n  get globalEvent(): GlobalEvent\n  {\n    return GlobalEvent.getInstance()\n  }\n\n  #createWrapperElement(): void\n  {\n    this.#smartGuideElement = document.createElement(\"div\")\n    this.#smartGuideElement.id = `smartguide-${ this.uuid }`\n    this.#smartGuideElement.classList.add(\"smartguide\")\n  }\n\n  #createPrompterContainerElement(): void\n  {\n    this.#prompterContainerElement = document.createElement(\"div\")\n    this.#prompterContainerElement.id = `prompter-container-${ this.uuid }`\n    this.#prompterContainerElement.classList.add(\"prompter-container\")\n    // this.#prompterContainerElement.appendChild(textElement)\n  }\n\n  #createPrompterTextElement(): void\n  {\n    this.#prompterTextElement = document.createElement(\"div\")\n    this.#prompterTextElement.id = `prompter-text-${ this.uuid }`\n    this.#prompterTextElement.classList.add(\"prompter-text\")\n    this.#prompterTextElement.setAttribute(\"touch-action\", \"none\")\n  }\n\n  #createEllipsisElement(): void\n  {\n    this.#ellipsisElement = document.createElement(\"div\")\n    this.#ellipsisElement.id = `ellipsis-${ this.uuid }`\n    this.#ellipsisElement.classList.add(\"ellipsis\")\n    this.#ellipsisElement.innerHTML = \"...\"\n  }\n\n  #createTagElement(): void\n  {\n    this.#tagElement = document.createElement(\"div\")\n    this.#tagElement.id = `tag-icon-${ this.uuid }`\n    this.#tagElement.classList.add(\"tag-icon\")\n    this.#tagElement.innerHTML = \"&#182;\"\n  }\n\n  #createCandidatesElement(): void\n  {\n    this.#candidatesElement = document.createElement(\"div\")\n    this.#candidatesElement.id = `candidates-${ this.uuid }`\n    this.#candidatesElement.classList.add(\"candidates\")\n  }\n\n  #createMoreMenuElement(): void\n  {\n    this.#menuElement = document.createElement(\"div\")\n    this.#menuElement.id = `more-menu-${ this.uuid }`\n    this.#menuElement.classList.add(\"more-menu\")\n  }\n\n  #createConvertElement(): void\n  {\n    this.#convertElement = document.createElement(\"button\")\n    this.#convertElement.id = `convert-${ this.uuid }`\n    this.#convertElement.classList.add(\"options-label-button\")\n    this.#convertElement.innerHTML = \"Convert\"\n  }\n\n  #createCopyElement(): void\n  {\n    this.#copyElement = document.createElement(\"button\")\n    this.#copyElement.id = `copy-${ this.uuid }`\n    this.#copyElement.classList.add(\"options-label-button\")\n    this.#copyElement.innerHTML = \"Copy\"\n  }\n\n  #createDeleteElement(): void\n  {\n    this.#deleteElement = document.createElement(\"button\")\n    this.#deleteElement.id = `delete-${ this.uuid }`\n    this.#deleteElement.classList.add(\"options-label-button\")\n    this.#deleteElement.innerHTML = \"Delete\"\n  }\n\n  init(domElement: HTMLElement, margin: TMarginConfiguration, renderingConfiguration: TRenderingConfiguration): void\n  {\n    domElement.appendChild(this.#smartGuideElement)\n    this.#smartGuideElement.appendChild(this.#tagElement)\n\n    this.#prompterContainerElement.appendChild(this.#prompterTextElement)\n    this.#smartGuideElement.appendChild(this.#prompterContainerElement)\n\n    this.#smartGuideElement.appendChild(this.#ellipsisElement)\n\n    this.#menuElement.appendChild(this.#convertElement)\n    this.#menuElement.appendChild(this.#copyElement)\n    this.#menuElement.appendChild(this.#deleteElement)\n    this.#smartGuideElement.appendChild(this.#menuElement)\n    this.#menuElement.classList.add(\"close\")\n    this.#isMenuOpen = false\n\n    this.#smartGuideElement.appendChild(this.#candidatesElement)\n    this.#candidatesElement.style.display = \"none\"\n    this.margin = margin\n    this.renderingConfiguration = renderingConfiguration\n    this.#addListeners()\n\n    this.#show()\n    if (this.renderingConfiguration.smartGuide.fadeOut.enable) {\n      this.#initFadeOutObserver(this.renderingConfiguration.smartGuide.fadeOut.duration)\n    }\n\n    this.resize()\n  }\n\n  #initFadeOutObserver(duration = 3000): void\n  {\n    const observer = new MutationObserver((mutations) => {\n      mutations.forEach(() => {\n        clearTimeout(this.#fadeOutTimout)\n        if (this.#candidatesElement.style.display === \"none\" && !this.#isMenuOpen) {\n          this.#fadeOutTimout = setTimeout(() => {\n            this.#hide()\n          }, duration)\n        } else if (!document.contains(this.#candidatesElement) && !document.contains(this.#menuElement)) {\n          this.#fadeOutTimout = setTimeout(() => {\n            this.#hide()\n          }, duration)\n        }\n      })\n    })\n    observer.observe(this.#smartGuideElement, { childList: true, subtree: true, attributes: true })\n  }\n\n  #show(): void\n  {\n    this.#smartGuideElement.classList.remove(\"smartguide-out\")\n    this.#smartGuideElement.classList.add(\"smartguide-in\")\n  }\n  #hide(): void\n  {\n    this.#smartGuideElement.classList.add(\"smartguide-out\")\n    this.#smartGuideElement.classList.remove(\"smartguide-in\")\n  }\n\n  #showCandidates = (target: HTMLElement) => {\n    const wordId = parseInt(target.id.replace(\"word-\", \"\").replace(this.uuid, \"\"))\n    const words = this.jiix?.words as TWordExport[]\n    this.wordToChange = words[wordId]\n    if (this.wordToChange) {\n      this.wordToChange.id = wordId.toString()\n      this.#candidatesElement.innerHTML = \"\"\n      if (this.wordToChange?.candidates) {\n        this.#candidatesElement.style.display = \"flex\"\n        this.wordToChange.candidates.forEach((word, index) => {\n          if (this.wordToChange?.label === word) {\n            this.#candidatesElement.innerHTML += `<span id=\"cdt-${index}${this.uuid}\" class=\"selected-word\">${word}</span>`\n          } else {\n            this.#candidatesElement.innerHTML += `<span id=\"cdt-${index}${this.uuid}\">${word}</span>`\n          }\n        })\n        const top = 48\n        const left = target.getBoundingClientRect().left - 60\n        this.#candidatesElement.style.top = `${top}px`\n        this.#candidatesElement.style.left = `${left}px`\n\n        const parent = target.parentNode?.parentNode?.parentNode\n        if (parent) {\n          parent.insertBefore(this.#candidatesElement, target.parentNode?.parentNode)\n        }\n      }\n    }\n  }\n  #hideCandidates(): void\n  {\n    this.#candidatesElement.style.display = \"none\"\n  }\n\n  #openMenu(): void {\n    this.#menuElement.classList.add(\"open\")\n    this.#menuElement.classList.remove(\"close\")\n    this.#isMenuOpen = true\n  }\n  #closeMenu(): void {\n    this.#menuElement.classList.add(\"close\")\n    this.#menuElement.classList.remove(\"open\")\n    this.#isMenuOpen = false\n  }\n\n  #onClickEllipsis = (evt: Event) =>\n  {\n    evt.preventDefault()\n    evt.stopPropagation()\n    this.#isMenuOpen ? this.#closeMenu() : this.#openMenu()\n    this.#hideCandidates()\n  }\n\n  #onClickConvert = (evt: Event) =>\n  {\n    evt.preventDefault()\n    evt.stopPropagation()\n    this.globalEvent.emitConvert()\n    this.#closeMenu()\n  }\n\n  #onClickCopy = async (evt: Event): Promise<void> =>\n  {\n    evt.preventDefault()\n    evt.stopPropagation()\n    try {\n      this.#closeMenu()\n      let message = \"Nothing to copy\"\n      if (this.#prompterTextElement.innerText) {\n        message = `\"${this.#prompterTextElement.innerText}\" copied to clipboard`\n        await navigator.clipboard.writeText(this.#prompterTextElement.innerText)\n      }\n      this.globalEvent.emitNotif(message)\n    } catch (err) {\n      this.globalEvent.emitError(err as Error)\n    }\n  }\n\n  #onClickDelete = (evt: Event) =>\n  {\n    evt.preventDefault()\n    evt.stopPropagation()\n    this.globalEvent.emitClear()\n    this.#closeMenu()\n  }\n\n  #onClickCandidate = (evt: Event) => {\n    evt.preventDefault()\n    evt.stopPropagation()\n    const target = evt.target as HTMLElement\n    const candidate = target.innerText\n\n    if (this.jiix && candidate !== this.wordToChange?.label && this.wordToChange?.candidates?.includes(candidate)) {\n      this.jiix.words[parseInt(this.wordToChange?.id as string)].label = candidate\n      this.globalEvent.emitImport(this.jiix, Exports.JIIX)\n    }\n    this.#candidatesElement.style.display = \"none\"\n  }\n\n  #onClickPrompter = (evt: Event): void =>\n  {\n    evt.preventDefault()\n    evt.stopPropagation()\n    this.#closeMenu()\n    const target = evt.target as HTMLElement\n    if (target.id !== this.#prompterTextElement.id) {\n      this.#showCandidates(target)\n    } else {\n      this.#hideCandidates()\n    }\n\n  }\n\n  #onClickOutSide = () => {\n    this.#hideCandidates()\n    this.#closeMenu()\n  }\n\n  #addListeners(): void\n  {\n    this.#ellipsisElement.addEventListener(\"pointerdown\", evt => this.#onClickEllipsis(evt))\n    this.#convertElement.addEventListener(\"pointerdown\", evt => this.#onClickConvert(evt))\n    this.#copyElement.addEventListener(\"pointerdown\", evt => this.#onClickCopy(evt))\n    this.#deleteElement.addEventListener(\"pointerdown\", evt => this.#onClickDelete(evt))\n    this.#prompterTextElement.addEventListener(\"pointerdown\", evt => this.#onClickPrompter(evt))\n    this.#candidatesElement.addEventListener(\"pointerdown\", evt => this.#onClickCandidate(evt))\n    document.addEventListener(\"pointerdown\", () => this.#onClickOutSide())\n  }\n\n  resize(): void\n  {\n    const mmToPixels = 3.779527559\n    const marginTop = this.margin.top * mmToPixels\n    const marginLeft = this.margin.left * mmToPixels\n    const marginRight = this.margin.right * mmToPixels\n    // 12 is the space between line in mm\n    const top = marginTop - (12 * mmToPixels)\n\n    this.#smartGuideElement.style.top = `${ top }px`\n    this.#smartGuideElement.style.left = `${ marginLeft }px`\n    this.#smartGuideElement.style.right = `${ marginRight }px`\n\n    let left = this.#tagElement.offsetWidth\n    this.#prompterContainerElement.style.marginLeft = `${ left }px`\n    this.#prompterContainerElement.style.width = `${ this.#smartGuideElement.clientWidth - this.#tagElement.offsetWidth - this.#ellipsisElement.offsetHeight }px`\n\n    left += this.#prompterContainerElement.offsetWidth\n    this.#menuElement.style.left = `${ left - this.#menuElement.offsetWidth + this.#ellipsisElement.offsetWidth }px`\n    this.#menuElement.style.top = `${ this.#ellipsisElement.offsetHeight }px`\n    this.#ellipsisElement.style.left = `${ left }px`\n  }\n\n  update(exports: TJIIXExport): void\n  {\n    this.jiix = exports\n    const createWordSpan = (index: number, word?: TWordExport) => {\n      const span = document.createElement(\"span\")\n      span.id = `word-${index}${this.uuid}`\n      if (word) {\n        span.textContent = word.label\n      } else {\n        span.innerHTML = \"&nbsp;\"\n      }\n      return span\n    }\n\n    const populatePrompter = () => {\n      this.#prompterTextElement.innerHTML = \"\"\n      if (this.jiix?.words) {\n        const words = this.jiix.words as TWordExport[]\n        const myFragment = document.createDocumentFragment()\n        words.forEach((word, index) => {\n          if (word.label === \" \" || word.label.includes(\"\\n\")) {\n            myFragment.appendChild(createWordSpan(index))\n          } else if (index !== words.length - 1) {\n            myFragment.appendChild(createWordSpan(index, word))\n          } else {\n            this.#prompterTextElement.appendChild(myFragment)\n            // this.perfectScrollbar.update()\n            if (this.lastWord) {\n              this.lastWord = word\n            }\n            const span = createWordSpan(index, word)\n            // This is used to scroll to last word if last word is modified\n            if ((this.lastWord?.candidates !== word.candidates) && (this.lastWord?.label !== word.label)) {\n              span.classList.add(\"added-word\")\n              this.#prompterTextElement.appendChild(span)\n              this.#prompterContainerElement.scrollLeft = span.offsetLeft\n              this.lastWord = word\n            } else {\n              this.#prompterTextElement.appendChild(span)\n              this.#prompterContainerElement.scrollLeft = span.offsetLeft\n            }\n          }\n        })\n      }\n    }\n    populatePrompter()\n    if (this.jiix?.words?.length) {\n      this.#show()\n    }\n  }\n\n  clear(): void\n  {\n    this.#prompterTextElement.innerHTML = \"\"\n    this.#candidatesElement.innerHTML = \"\"\n    this.#hide()\n  }\n}\n","import { TEditorOptions } from \"./@types/Editor\"\nimport { TConfiguration, TConfigurationClient } from \"./@types/Configuration\"\nimport { IGrabber } from \"./@types/grabber/Grabber\"\nimport { IModel, TExport, TJIIXExport } from \"./@types/model/Model\"\nimport { TPoint } from \"./@types/renderer/Point\"\nimport { TPenStyle } from \"./@types/style/PenStyle\"\nimport { TTheme } from \"./@types/style/Theme\"\nimport { IBehaviors } from \"./@types/Behaviors\"\nimport { TConverstionState } from \"./@types/configuration/RecognitionConfiguration\"\nimport { TMarginConfiguration } from \"./@types/configuration/recognition/MarginConfiguration\"\n\nimport { EventType } from \"./Constants\"\nimport { BehaviorsManager } from \"./behaviors/BehaviorsManager\"\nimport { Configuration } from \"./configuration/Configuration\"\nimport { GlobalEvent } from \"./event/GlobalEvent\"\nimport { Model } from \"./model/Model\"\nimport { StyleManager } from \"./style/StyleManager\"\nimport { SmartGuide } from \"./smartguide/SmartGuide\"\nimport { DeferredPromise } from \"./utils/DeferredPromise\"\n\nimport \"./iink.css\"\n\nexport enum EditorMode\n{\n  Writing = \"writing\",\n  /**\n   * @remarks Only available on WEBSOCKET\n   */\n  Erasing = \"erasing\"\n}\n\nexport type HTMLEditorElement = HTMLElement &\n{\n  editor: Editor\n}\n\nexport class Editor\n{\n  wrapperHTML: HTMLEditorElement\n  #loaderHTML: HTMLDivElement\n  #messageHTML: HTMLDivElement\n  #configuration: Configuration\n  #behaviorsManager: BehaviorsManager\n  #styleManager: StyleManager\n  #localPenStyle: TPenStyle\n  #smartGuide: SmartGuide\n  #mode: EditorMode\n  #initializationDeferred: DeferredPromise<boolean>\n\n  model: IModel\n  debug = false\n\n  constructor(wrapperHTML: HTMLElement, options?: TEditorOptions)\n  {\n    this.#initializationDeferred = new DeferredPromise<boolean>()\n\n    this.wrapperHTML = wrapperHTML as HTMLEditorElement\n    this.wrapperHTML.classList.add(options?.globalClassCss || \"ms-editor\")\n\n    this.#loaderHTML = document.createElement(\"div\")\n    this.#loaderHTML.classList.add(\"loader\")\n    this.#loaderHTML.style.display = \"initial\"\n    this.wrapperHTML.appendChild(this.#loaderHTML)\n\n    this.#messageHTML = document.createElement(\"div\")\n    this.#messageHTML.classList.add(\"message\")\n    this.#messageHTML.style.display = \"none\"\n    this.wrapperHTML.appendChild(this.#messageHTML)\n\n    this.#mode = EditorMode.Writing\n\n    this.#styleManager = new StyleManager(options?.penStyle, options?.theme)\n    this.#localPenStyle = this.#styleManager.penStyle\n\n    this.#configuration = new Configuration(options?.configuration)\n\n    this.#smartGuide = new SmartGuide()\n\n    const width = Math.max(this.wrapperHTML.clientWidth, this.configuration.rendering.minWidth)\n    const height = Math.max(this.wrapperHTML.clientHeight, this.configuration.rendering.minHeight)\n    this.model = new Model(width, height)\n\n    this.#behaviorsManager = new BehaviorsManager(this.configuration, this.model, options?.behaviors)\n\n    this.#initalizeBehaviors()\n    this.#initializeSmartGuide()\n    this.#addListeners()\n  }\n\n  get initializationPromise(): Promise<boolean>\n  {\n    return this.#initializationDeferred.promise\n  }\n\n  get configuration(): TConfiguration\n  {\n    return this.#configuration\n  }\n\n  set configuration(config: TConfigurationClient)\n  {\n    this.#initializationDeferred = new DeferredPromise<boolean>()\n    this.#configuration.overrideDefaultConfiguration(config)\n\n    this.model.clear()\n    this.model.height = Math.max(this.wrapperHTML.clientHeight, this.#configuration.rendering.minHeight)\n    this.model.width = Math.max(this.wrapperHTML.clientWidth, this.#configuration.rendering.minWidth)\n\n    this.#behaviorsManager.overrideDefaultBehaviors(this.#configuration, this.model)\n    this.#initalizeBehaviors()\n\n    this.#initializeSmartGuide()\n  }\n\n  get mode(): EditorMode\n  {\n    return this.#mode\n  }\n\n  /**\n   * @remarks Only available in WEBSOCKET\n   */\n  set mode(m: EditorMode)\n  {\n    if (this.#configuration.server.protocol === \"WEBSOCKET\") {\n      this.#mode = m\n      if (this.#mode === EditorMode.Erasing) {\n        this.wrapperHTML.classList.add(\"erasing\")\n      } else {\n        document.body.style.cursor = \"initial\"\n        this.wrapperHTML.classList.remove(\"erasing\")\n      }\n    } else {\n      throw new Error(\"set Editor.mode only available in WEBSOCKET\")\n    }\n  }\n\n  get events(): GlobalEvent\n  {\n    return GlobalEvent.getInstance()\n  }\n\n  get #behaviors(): IBehaviors\n  {\n    return this.#behaviorsManager.behaviors\n  }\n\n  get #grabber(): IGrabber\n  {\n    return this.#behaviorsManager.behaviors.grabber\n  }\n\n  get theme(): TTheme\n  {\n    return this.#styleManager.theme\n  }\n\n  set theme(t: TTheme)\n  {\n    this.#styleManager.overrideDefaultTheme(t)\n    if (this.#behaviors.setTheme) {\n      this.#behaviors.setTheme(this.theme)\n    }\n  }\n\n  get penStyleClasses(): string\n  {\n    return this.#styleManager.penStyleClasses\n  }\n\n  set penStyleClasses(psc: string)\n  {\n    this.#styleManager.penStyleClasses = psc\n    this.#localPenStyle = (this.theme[`.${this.penStyleClasses}`]) as TPenStyle\n    if (this.#behaviors.setPenStyleClasses) {\n      this.#behaviors.setPenStyleClasses(psc)\n    }\n  }\n\n  get penStyle(): TPenStyle\n  {\n    return this.#styleManager.penStyle\n  }\n\n  set penStyle(p: TPenStyle)\n  {\n    this.#styleManager.overrideDefaultPenStyle(p)\n    this.#localPenStyle = this.penStyle\n    if (this.#behaviors.setPenStyle) {\n      this.#behaviors.setPenStyle(this.penStyle)\n    }\n  }\n\n  #initializeSmartGuide(): void\n  {\n    if (this.configuration.rendering.smartGuide.enable) {\n      let margin\n      switch (this.configuration.recognition.type) {\n        case \"TEXT\":\n          margin = this.configuration.recognition.text.margin\n          break\n        case \"MATH\":\n          margin = this.configuration.recognition.math.margin\n          break\n        default:\n          margin = {\n            top: 20,\n            left: 10,\n            right: 10,\n            bottom: 10\n          }\n          break\n      }\n      this.#smartGuide.init(this.wrapperHTML, margin as TMarginConfiguration, this.configuration.rendering)\n    } else {\n      this.#smartGuide.clear()\n    }\n  }\n\n  #initalizeBehaviors(): void\n  {\n    this.#behaviorsManager.init(this.wrapperHTML)\n      .then(async () =>\n      {\n        this.#grabber.onPointerDown = (evt: PointerEvent, point: TPoint) => this.#onPointerDown(evt, point)\n        this.#grabber.onPointerMove = (evt: PointerEvent, point: TPoint) => this.#onPointerMove(evt, point)\n        this.#grabber.onPointerUp = (evt: PointerEvent, point: TPoint) => this.#onPointerUp(evt, point)\n\n        if (this.#behaviors.setPenStyle) {\n          this.#behaviors.setPenStyle(this.penStyle)\n        }\n        if (this.#behaviors.setTheme) {\n          this.#behaviors.setTheme(this.theme)\n        }\n        if (this.#behaviors.setPenStyleClasses) {\n          this.#behaviors.setPenStyleClasses(this.penStyleClasses)\n        }\n\n        this.wrapperHTML.editor = this\n        this.#initializationDeferred.resolve(true)\n        this.events.emitLoaded()\n      })\n      .catch((e: Error) =>\n      {\n        this.#initializationDeferred.resolve(false)\n        this.#showError(e)\n        this.events.emitError(e)\n      })\n      .finally(() =>\n      {\n        this.#loaderHTML.style.display = \"none\"\n      })\n  }\n\n  #showError(err: Error)\n  {\n    this.#messageHTML.style.display = \"initial\"\n    this.#messageHTML.classList.add(\"error-msg\")\n    this.#messageHTML.classList.remove(\"info-msg\")\n    this.#messageHTML.innerText = err.message\n    if (this.debug) {\n      const pName = document.createElement(\"p\")\n      pName.innerHTML = err.name\n      this.#messageHTML.prepend(pName)\n\n      const pStack = document.createElement(\"p\")\n      pStack.style.width = \"50vw\"\n      pStack.style.marginLeft = \"calc(-25vw + 100px)\"\n      pStack.innerHTML = err.stack || \"\"\n      this.#messageHTML.appendChild(pStack)\n    }\n  }\n\n  #showNotif(message: string, timeout = 1000)\n  {\n    this.#messageHTML.style.display = \"initial\"\n    this.#messageHTML.classList.add(\"info-msg\")\n    this.#messageHTML.classList.remove(\"error-msg\")\n    this.#messageHTML.innerText = message\n    setTimeout(() => {\n      this.#messageHTML.style.display = \"none\"\n    }, timeout)\n  }\n\n  #addListeners(): void\n  {\n    this.events.addEventListener(EventType.CONVERT, () => this.convert({ conversionState: \"DIGITAL_EDIT\" }))\n    this.events.addEventListener(EventType.CLEAR, () => this.clear())\n    this.events.addEventListener(EventType.ERROR, (evt: Event) => this.#onError(evt))\n    this.events.addEventListener(EventType.IMPORT, (evt: Event) => this.#onImport(evt))\n    this.events.addEventListener(EventType.EXPORTED, (evt: Event) => this.#onExport(evt))\n    this.events.addEventListener(EventType.NOTIF, (evt: Event) => this.#onNotif(evt))\n  }\n\n  #onNotif(evt: Event): void\n  {\n    const payload = (evt as CustomEvent).detail as { message: string, timeout: number }\n    this.#showNotif(payload.message, payload.timeout)\n  }\n\n  #onExport(evt: Event): void\n  {\n    if (this.configuration.rendering.smartGuide.enable) {\n      const exports = (evt as CustomEvent).detail as TExport\n      if (exports[\"application/vnd.myscript.jiix\"]) {\n        const jjix = (exports[\"application/vnd.myscript.jiix\"] as unknown) as string\n        this.#smartGuide.update(JSON.parse(jjix))\n      }\n    }\n  }\n\n  #onImport(evt: Event): void\n  {\n    const customEvent = evt as CustomEvent\n    const jiix: string = customEvent.detail.jiix\n    const mimeType: string = customEvent.detail.mimeType\n    this.import(new Blob([JSON.stringify(jiix)], { type: mimeType }), mimeType)\n  }\n\n  #onError(evt: Event)\n  {\n    const customEvent = evt as CustomEvent\n    const err = customEvent?.detail as Error\n    this.#showError(err)\n  }\n\n  #onPointerDown(evt: PointerEvent, point: TPoint): void\n  {\n    const target: Element = (evt.target as Element)\n    const pointerDownOnEditor = target?.id === this.wrapperHTML.id || target?.classList?.contains(\"ms-canvas\")\n    if (pointerDownOnEditor) {\n      let { pointerType } = evt\n      if (this.#mode === EditorMode.Erasing) {\n        pointerType = \"eraser\"\n      }\n      const style: TPenStyle = Object.assign({}, this.theme?.ink, this.#localPenStyle)\n      this.model.initCurrentStroke(point, evt.pointerId, pointerType, style)\n      this.#behaviors.drawCurrentStroke(this.model)\n    }\n  }\n\n  #onPointerMove(_evt: PointerEvent, point: TPoint): void\n  {\n    this.model.appendToCurrentStroke(point)\n    this.#behaviors.drawCurrentStroke(this.model)\n  }\n\n  #onPointerUp(_evt: PointerEvent, point: TPoint): void\n  {\n    this.model.endCurrentStroke(point, this.penStyle)\n    this.#behaviors.updateModelRendering(this.model)\n      .then(model => this.model = model)\n      .catch(error => this.#showError(error as Error))\n  }\n\n  async undo(): Promise<IModel>\n  {\n    this.model = await this.#behaviors.undo()\n    return this.model\n  }\n\n  async redo(): Promise<IModel>\n  {\n    this.model = await this.#behaviors.redo()\n    return this.model\n  }\n\n  async clear(): Promise<IModel>\n  {\n    this.model = await this.#behaviors.clear(this.model)\n    return this.model\n  }\n\n  async resize(): Promise<IModel>\n  {\n    if (this.configuration.rendering.smartGuide.enable) {\n      this.#smartGuide.resize()\n    }\n    this.model.height = Math.max(this.wrapperHTML.clientHeight, this.configuration.rendering.minHeight)\n    this.model.width = Math.max(this.wrapperHTML.clientWidth, this.configuration.rendering.minWidth)\n    this.model = await this.#behaviors.resize(this.model)\n    return this.model\n  }\n\n  async export(mimeTypes?: string[]): Promise<IModel>\n  {\n    this.model = await this.#behaviors.export(this.model, mimeTypes)\n    return this.model\n  }\n\n  async convert(params?: { conversionState?: TConverstionState, mimeTypes?: string[] }): Promise<IModel | never>\n  {\n    this.model = await this.#behaviors.convert(this.model, params?.conversionState, params?.mimeTypes)\n    this.events.emitConverted(this.model.converts as TExport)\n    return this.model\n  }\n\n  async import(data: Blob, mimeType?: string): Promise<IModel | never>\n  {\n    if (this.#behaviors.import) {\n      this.model = await this.#behaviors.import(this.model, data, mimeType)\n      this.events.emitImported(this.model.exports?.[\"application/vnd.myscript.jiix\"] as TJIIXExport)\n      return this.model\n    }\n    return Promise.reject(\"Import impossible, behaviors has no import function\")\n  }\n}\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import { TConfigurationClient } from \"./@types/Configuration\"\n\nexport async function getAvailableLanguageList(configuration: TConfigurationClient): Promise<Array<Record<string, string>> | never>\n {\n   if (configuration?.server?.scheme && configuration?.server?.host) {\n     const serverConfig = configuration.server\n     const response = await fetch(`${ serverConfig.scheme }://${ serverConfig.host }/api/v4.0/iink/availableLanguageList`)\n     return response.json()\n   } else {\n     return Promise.reject(\"Cannot get languages ! Please check your server configuration!\")\n   }\n }\n"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","adopt","then","apply","__classPrivateFieldGet","receiver","state","kind","f","TypeError","has","call","get","__classPrivateFieldSet","set","Error","WRONG_CREDENTIALS","UNKNOW","ABNORMAL_CLOSURE","CANT_ESTABLISH","GOING_AWAY","PROTOCOL_ERROR","UNSUPPORTED_DATA","INVALID_FRAME_PAULOAD","POLICY_VIOLATION","MESSAGE_TOO_BIG","INTERNAL_ERROR","SERVICE_RESTART","TRY_AGAIN","BAD_GATEWAY","TLS_HANDSHAKE","EventType","CHANGED","CLEAR","CLEARED","CONVERT","CONVERTED","ERROR","EXPORTED","IMPORT","IMPORTED","IDLE","LOADED","NOTIF","RENDERED","WSEventType","WSMessage","Exports","JIIX","TEXT","LATEX","MATHML","SVG","OFFICE_DOCUMENT","Constants","PointerEventGrabber","constructor","configuration","this","prevent","preventDefault","pointerDownHandler","evt","button","buttons","activePointerId","pointerId","onPointerDown","point","extractPoint","pointerMoveHandler","undefined","onPointerMove","pointerUpHandler","stopPropagation","onPointerUp","setConfiguration","roundFloat","oneFloat","requestedFloatPrecision","floatPrecision","Math","pow","round","event","clientX","clientY","changedTouches","rect","domElement","getBoundingClientRect","x","left","clientLeft","xyFloatPrecision","y","top","clientTop","t","Date","now","timestampFloatPrecision","p","pressure","attach","detach","addEventListener","listenerOptions","document","documentElement","_a","removeEventListener","_b","_c","_d","_e","_f","_g","ShapeSymbols","table","shape","recognizedShape","ellipse","line","phi","angle","returnedAngle","PI","drawArrowHead","context2D","headPoint","length","alpha","beta","save","fillStyle","strokeStyle","moveTo","beginPath","lineTo","cos","sin","fill","restore","drawShapeEllipse","shapeEllipse","points","drawEllipseArc","centerPoint","maxRadius","minRadius","orientation","startAngle","sweepAngle","z1","z3","z2","z4","n","floor","abs","boundariesPoints","i","atan2","cosAlpha","sinAlpha","push","stroke","beginDecoration","beginTangentAngle","endDecoration","endTangentAngle","drawLine","p1","p2","drawShapeSymbol","symbol","lineWidth","width","color","elementType","shapeSymbol","candidates","selectedCandidateIndex","lines","forEach","lineSymbol","data","type","drawShapeLine","shapeLine","firstPoint","lastPoint","primitives","primitive","TextSymbols","inputCharacter","char","string","textLine","drawTextLine","drawText","label","font","textHeight","textAlign","justificationType","textBaseline","fillText","topLeftPoint","height","underlineList","underline","drawUnderline","delta","firstCharacter","lastCharacter","computeLinksPoints","radius","computeMiddlePoint","point1","point2","computeAxeAngle","begin","end","CanvasQuadraticStroker","renderArc","context2d","center","arc","renderLine","linkPoints1","linkPoints2","renderFinal","linkPoints","newAngle","renderQuadratic","ctrl","linkPoints3","quadraticCurveTo","getPointByIndex","index","drawStroke","nbquadratics","secondPoint","beginLine","endLine","beginFinal","endFinal","closePath","CanvasRenderer","config","stroker","createCanvas","element","canvas","createElement","id","classList","add","appendChild","resizeContent","pixelRatio","window","devicePixelRatio","context","renderingCanvas","capturingCanvas","parentNode","max","minWidth","clientWidth","minHeight","clientHeight","getContext","scale","style","drawSymbol","pointerType","Object","keys","includes","drawTextSymbol","init","parent","renderingCanvasContext","capturingCanvasContext","drawModel","model","clearRect","symbols","defaultSymbols","rawStrokes","updatePositionRendered","drawPendingStroke","resize","destroy","innerHTML","module","o","exports","r","l","m","c","d","defineProperty","configurable","enumerable","__esModule","default","prototype","hasOwnProperty","s","Symbol","iterator","toJSON","console","error","u","split","trim","indexOf","substring","replace","_trimSemiColon","toCSS","slice","parser","JsonCSS","StyleHelper","themeToCSS","json","themeToJSON","theme","Number","ink","penStyleToCSS","penStyle","css","penStyleToJSON","penStyleString","CryptoJS","create","F","obj","subtype","C","C_lib","lib","Base","extend","overrides","mixIn","$super","arguments","instance","properties","propertyName","toString","clone","WordArray","words","sigBytes","encoder","Hex","stringify","concat","wordArray","thisWords","thatWords","thisSigBytes","thatSigBytes","clamp","thatByte","ceil","random","nBytes","rcache","m_w","m_z","mask","_r","C_enc","enc","hexChars","bite","join","parse","hexStr","hexStrLength","parseInt","substr","Latin1","latin1Chars","String","fromCharCode","latin1Str","latin1StrLength","charCodeAt","Utf8","decodeURIComponent","escape","utf8Str","unescape","encodeURIComponent","BufferedBlockAlgorithm","reset","_data","_nDataBytes","_append","_process","doFlush","dataWords","dataSigBytes","blockSize","nBlocksReady","nWordsReady","_minBufferSize","nBytesReady","min","offset","_doProcessBlock","processedWords","splice","Hasher","cfg","_doReset","update","messageUpdate","finalize","_doFinalize","_createHelper","hasher","message","_createHmacHelper","key","C_algo","HMAC","algo","require$$0","X32WordArray","C_x64","x64","Word","high","low","toX32","x64Words","x64WordsLength","x32Words","x64Word","wordsLength","X64Word","X64WordArray","X64Word_create","K","W","SHA512","_hash","M","H","H0","H1","H2","H3","H4","H5","H6","H7","H0h","H0l","H1h","H1l","H2h","H2l","H3h","H3l","H4h","H4l","H5h","H5l","H6h","H6l","H7h","H7l","ah","al","bh","bl","ch","cl","dh","dl","eh","el","fh","fl","gh","gl","hh","hl","Wi","Wih","Wil","gamma0x","gamma0xh","gamma0xl","gamma0h","gamma0l","gamma1x","gamma1xh","gamma1xl","gamma1h","gamma1l","Wi7","Wi7h","Wi7l","Wi16","Wi16h","Wi16l","t1l","chh","chl","majh","majl","sigma0h","sigma0l","sigma1h","sigma1l","Ki","Kih","Kil","t1h","t2l","nBitsTotal","nBitsLeft","HmacSHA512","_hasher","hasherBlockSize","hasherBlockSizeBytes","oKey","_oKey","iKey","_iKey","oKeyWords","iKeyWords","innerHash","computeHmac","applicationKey","hmacKey","AbstractRecognizer","serverConfig","recognitionConfig","serverConfiguration","recognitionConfiguration","RestRecognizer","super","url","scheme","host","postConfig","lang","diagram","export","math","text","buildData","newStrokes","strokeGroups","group","newGroup","JSON","strokes","map","contentType","charAt","toUpperCase","toLowerCase","xDPI","yDPI","post","mimeType","headers","Headers","append","reqInit","method","body","request","Request","response","fetch","ok","blob","catch","tryFetch","res","err","ErrorConst","code","getMimeTypes","requestedMimeTypes","mimeTypes","convert","conversionState","myModel","getClone","updatePositionSent","dataToConcert","promises","mt","all","converts","assign","updatePositionReceived","exportModel","isEmpty","mimeTypesRequiringExport","filter","DeferredPromise","isFullFilled","isPending","promise","v","GlobalEvent","EventTarget","static","_GlobalEvent_instance","emitLoaded","emitExported","_GlobalEvent_instances","_GlobalEvent_emit","emitChange","undoRedoContext","canUndo","canRedo","canClear","stack","stackIndex","stackLength","emitIdle","emitError","emitNotif","timeout","emitClear","emitCleared","emitConvert","emitConverted","emitImport","jiix","emitImported","WeakSet","dispatchEvent","CustomEvent","bubbles","composed","detail","UndoRedoContext","UndoRedoManager","globalEvent","getInstance","updateCanUndoRedo","getLastModel","getModelFromModificationDate","modificationDate","find","addModelToStack","maxStackSize","shift","updateModelInStack","findIndex","undo","redo","RestBehaviors","_RestBehaviors_triggerConfiguration","_RestBehaviors_resizeTimer","_RestBehaviors_exportTimer","grabber","renderer","rendering","recognizer","server","recognition","undoRedoManager","triggers","initialized","drawCurrentStroke","currentStroke","updateModelRendering","deferred","exportContent","clearTimeout","currentModel","setTimeout","_RestBehaviors_instances","_RestBehaviors__export","exportContentDelay","deferredResize","resizeModel","resizeTriggerDelay","oldModel","modelUpdated","newModel","clear","getTime","WeakMap","WSEvent","_WSEvent_abortController","AbortController","emit","emitInitialized","emitConnected","emitConnectionActive","addConnectionActiveListener","callback","signal","emitDisconnected","addDisconnectedListener","emitPartChange","partChange","addPartChangeListener","emitContentChange","contentChange","addContentChangeListener","emitSVGPatch","patchChange","addSVGPatchListener","addExportListener","addErrorListener","clearListeners","abort","WSRecognizer","pingCount","reconnectionCount","_WSRecognizer_fileImportDeffered","wsEvent","toLocaleLowerCase","infinitePing","websocket","maxPingLostCount","close","socket","readyState","send","pingDelay","openCallback","params","sessionId","iinkSessionId","xDpi","yDpi","viewSizeHeight","viewSizeWidth","closeCallback","currentErrorCode","manageHMACChallengeMessage","websocketMessage","hmacChallengeMessage","hmacChallenge","hmac","manageContentPackageDescriptionMessage","currentPartId","managePartChangeMessage","partChangeMessage","partId","manageContentChangeMessage","contentChangeMessage","manageExportMessage","exportMessage","manageSVGPatchMessage","svgPatchMessage","manageErrorMessage","messageCallback","WebSocket","pingEnabled","onopen","onclose","ev","onmessage","name","canReconnect","autoReconnect","maxRetryCount","addStrokes","extractPendingStrokes","OPEN","reason","CONNECTING","setPenStyle","setPenStyleClasses","penStyleClasses","styleClasses","setTheme","import","chunkSize","fileChunkSize","importFileId","readBlob","fileReader","FileReader","onloadend","target","onerror","readAsText","importFileMessage","size","blobPart","fileChuckMessage","lastChunk","SVGQuadraticStroker","getArcPath","getLinePath","getFinalPath","parts","getQuadraticPath","central","buildSVGPath","STROKE_LENGTH","STROKE_WIDTH","NB_QUADRATICS","beforeLastPoint","svgElement","svgPath","svgStroke","createElementNS","setAttribute","drawErasingStroke","SVGRenderer","fontSize","updateLayer","layerName","_SVGRenderer_instances","_SVGRenderer_replaceElement","_SVGRenderer_removeElement","_SVGRenderer_removeChild","_SVGRenderer_insertBefore","_SVGRenderer_setAttribute","_SVGRenderer_removeAttribute","updatesLayer","updates","clearPendingStroke","pendingStrokeGroup","querySelector","oldStroke","remove","svgList","querySelectorAll","svg","_SVGRenderer_drawStroke","_SVGRenderer_replaceAll","oldLayer","insertAdjacentHTML","layer","pendingStrokesGroup","elementToRemove","_SVGRenderer_appendChild","parentSelector","parentId","refId","selector","removeAttribute","WSBehaviors","_WSBehaviors_triggerConfiguration","_WSBehaviors_exportTimer","_WSBehaviors_resizeTimer","_WSBehaviors_exportDeffered","_WSBehaviors_convertDeffered","_WSBehaviors_addStrokeDeffered","_WSBehaviors_importDeffered","_WSBehaviors_resizeDeffered","_WSBehaviors_undoDeffered","_WSBehaviors_redoDeffered","_WSBehaviors_clearDeffered","onConnectionActive","onContentChange","onSVGPatch","onError","onExport","onDisconnected","_h","_j","_k","_l","_m","_o","_p","_q","myExportConverted","myImportExport","BehaviorsManager","behaviors","overrideDefaultBehaviors","defaultBehaviors","protocol","DefaultServerConfiguration","useWindowLocation","DefaultRecognitionConfiguration","alwaysConnected","gesture","enable","chars","debug","solver","margin","bottom","right","eraser","mode","guides","DefaultGrabberConfiguration","capture","passive","DefaultRenderingConfiguration","smartGuide","fadeOut","duration","DefaultTriggerConfiguration","DefaultEventsConfiguration","processDelay","DefaultUndoRedoConfiguration","DefaultConfiguration","events","Configuration","overrideDefaultConfiguration","mergeDeep","sources","isObject","item","Array","isArray","source","defaultConf","location","Stroke","Model","creationDate","positions","lastSentPosition","lastReceivedPosition","lastRenderedPosition","creationTime","idle","computeDistance","distance","sqrt","isNaN","computeLength","lastDistance","computePressure","ratio","filterPointByAcquisitionDelta","addPoint","addStroke","position","addStrokeToGroup","strokePenStyle","lastGroup","ps1","ps2","newStrokeGroup","initCurrentStroke","dpi","pxWidth","appendToCurrentStroke","endCurrentStroke","extractPendingRecognizedSymbols","recognizedSymbols","resetPositionRenderer","resetPositions","clonedModel","DefaultPenStyle","DefaultTheme","StyleManager","_StyleManager_penStyle","_StyleManager_theme","overrideDefaultPenStyle","overrideDefaultTheme","SmartGuide","_SmartGuide_smartGuideElement","_SmartGuide_prompterContainerElement","_SmartGuide_prompterTextElement","_SmartGuide_ellipsisElement","_SmartGuide_tagElement","_SmartGuide_candidatesElement","_SmartGuide_menuElement","_SmartGuide_convertElement","_SmartGuide_copyElement","_SmartGuide_deleteElement","_SmartGuide_fadeOutTimout","_SmartGuide_isMenuOpen","_SmartGuide_showCandidates","wordId","uuid","wordToChange","display","word","insertBefore","_SmartGuide_onClickEllipsis","_SmartGuide_instances","_SmartGuide_hideCandidates","_SmartGuide_onClickConvert","_SmartGuide_closeMenu","_SmartGuide_onClickCopy","innerText","navigator","clipboard","writeText","_SmartGuide_onClickDelete","_SmartGuide_onClickCandidate","candidate","_SmartGuide_onClickPrompter","_SmartGuide_onClickOutSide","_SmartGuide_createWrapperElement","_SmartGuide_createPrompterContainerElement","_SmartGuide_createPrompterTextElement","_SmartGuide_createEllipsisElement","_SmartGuide_createTagElement","_SmartGuide_createCandidatesElement","_SmartGuide_createMoreMenuElement","_SmartGuide_createConvertElement","_SmartGuide_createCopyElement","_SmartGuide_createDeleteElement","renderingConfiguration","_SmartGuide_addListeners","_SmartGuide_show","_SmartGuide_initFadeOutObserver","mmToPixels","marginTop","marginLeft","marginRight","offsetWidth","offsetHeight","createWordSpan","span","textContent","myFragment","createDocumentFragment","lastWord","scrollLeft","offsetLeft","populatePrompter","_SmartGuide_hide","MutationObserver","mutations","contains","observe","childList","subtree","attributes","_SmartGuide_openMenu","EditorMode","styleInject","ref","insertAt","head","getElementsByTagName","firstChild","styleSheet","cssText","createTextNode","_Editor_behaviorsManager","_Editor_grabber_get","_Editor_initializeSmartGuide","_Editor_smartGuide","wrapperHTML","_Editor_initalizeBehaviors","_Editor_instances","_Editor_behaviors_get","editor","_Editor_initializationDeferred","_Editor_showError","finally","pName","_Editor_messageHTML","prepend","pStack","_Editor_showNotif","_Editor_addListeners","_Editor_onError","_Editor_onImport","_Editor_onExport","_Editor_onNotif","payload","jjix","customEvent","Blob","_Editor_onPointerDown","_Editor_mode","Erasing","_Editor_localPenStyle","_Editor_onPointerMove","_evt","_Editor_onPointerUp","Editor","options","_Editor_loaderHTML","_Editor_configuration","_Editor_styleManager","globalClassCss","Writing","initializationPromise","cursor","psc","getAvailableLanguageList"],"mappings":"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"}